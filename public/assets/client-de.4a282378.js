(()=>{"use strict";var e,t,n,i={981:(e,t,n)=>{var i=n(7774),o=n(1740),r=n(3861),s=n(4321);const a=["g","h","x","m","r","p"];var l=n(8821),c=n(4890),u=n(3894),d=n(6734);const h={showGrid:!1,showPixelNotify:!1,autoZoomIn:!1,isPotato:!1,isLightGrid:!1,compactPalette:!1,paletteOpen:!0,mute:!1,chatNotify:!0,menuOpen:!1,onlineCanvas:!1,style:"default"},f={lastFetch:0,totalPixels:0,dailyTotalPixels:0,ranking:1488,dailyRanking:1488,online:{total:0},totalRanking:[],totalDailyRanking:[],dailyCRanking:[],prevTop:[],onlineStats:[],cHistStats:[],histStats:{users:[],stats:[]},pDailyStats:[],pHourlyStats:[]},v=15e3,p={mute:[],readTs:{},unread:{}},m={id:null,name:null,wait:null,coolDown:null,lastCoolDownEnd:null,messages:[],mailreg:!1,blockDm:!1,priv:!1,isOnMobile:!1,notification:null,userlvl:0};function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const w=class{constructor(e){g(this,"length",void 0),g(this,"rgb",void 0),g(this,"colors",void 0),g(this,"abgr",void 0),g(this,"fl",void 0),this.length=e.length,this.rgb=new Uint8Array(3*this.length),this.colors=new Array(this.length),this.abgr=new Uint32Array(this.length),this.fl=new Array(this.length);let t=0;for(let n=0;n<e.length;n++){const i=e[n][0],o=e[n][1],r=e[n][2];this.rgb[t++]=i,this.rgb[t++]=o,this.rgb[t++]=r,this.colors[n]=`rgb(${i}, ${o}, ${r})`,this.abgr[n]=4278190080|r<<16|o<<8|i,this.fl[n]=[i/256,o/256,r/256]}}isDark(e){return e*=3,.2126*this.rgb[e++]+.7152*this.rgb[e++]+.0722*this.rgb[e]<128}getIndexOfColor(e,t,n){const{rgb:i}=this;let o=i.length/3;for(;o>0;){o-=1;const r=3*o;if(i[r]===e&&i[r+1]===t&&i[r+2]===n)return o}return null}getClosestIndexOfColor(e,t,n){const{rgb:i}=this;let o=i.length/3,r=0,s=null;for(;o>0;){o-=1;const a=3*o;let l=(i[a]-e)**2;l+=(i[a+1]-t)**2,l+=(i[a+2]-n)**2,(null===s||s>l)&&(r=o,s=l)}return r}};var y=n(9665),b=n(6539);function S(e){const{hash:t}=window.location;try{const n=t.substring(1).split(","),i=n[0],o=(0,y.s3)(e,n[0]),r=null===o?e[b.V4]:e[o],s=r.cli||0,{colors:a,sd:l,size:c}=r,u=!!r.v,d=parseInt(n[1],10),h=parseInt(n[2],10),f=parseInt(n[3],10);if(Number.isNaN(d)||Number.isNaN(h)||Number.isNaN(f)&&u)throw new Error("NaN");const v=[d,h,f];let p=f;return p=!p||Number.isNaN(p)?b.A$:2**(p/10),u||null===o||(p=(0,y.uZ)(p,b.I_/c,b.Fv),v.length=2),{canvasId:o,canvasIdent:i,canvasSize:c,historicalCanvasSize:c,is3D:u,canvasStartDate:l,canvasMaxTiledZoom:(0,y.W4)(c),palette:new w(a,0),clrIgnore:s,selectedColor:s,view:v,viewscale:p,scale:p,canvases:e}}catch(t){const n=e[b.V4];return{canvasId:b.V4,canvasIdent:n.ident,canvasSize:n.size,historicalCanvasSize:n.size,is3D:!!n.v,canvasStartDate:null,canvasMaxTiledZoom:(0,y.W4)(n.size),palette:new w(n.colors,0),clrIgnore:n.cli||0,selectedColor:n.cli||0,view:[0,0,0],viewscale:b.A$,scale:b.A$,canvases:e}}}const k={...S(b.n$),isHistoricalView:!1,historicalDate:null,historicalTime:null,showHiddenCanvases:!1,hover:null,prevCanvasCoords:{}},C={channels:{},blocked:[],messages:{}};let E=0;const T={fetchingChunks:0,fetchingChat:!1,fetchingPixel:!1,fetchingApi:!1},x=(e,t)=>e&&e._persist&&e._persist.version===t?(console.log(`Store version: ${t}`),Promise.resolve(e)):(console.log("Newer version run, resetting store."),Promise.resolve({})),I={gui:(0,i.OJ)({key:"gui",storage:d.Z,version:15,migrate:x},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/TGL_GRID":return{...e,showGrid:!e.showGrid};case"s/TGL_PXL_NOTIFY":return{...e,showPixelNotify:!e.showPixelNotify};case"s/TGL_AUTO_ZOOM_IN":return{...e,autoZoomIn:!e.autoZoomIn};case"s/TGL_ONLINE_CANVAS":return{...e,onlineCanvas:!e.onlineCanvas};case"s/TGL_POTATO_MODE":return{...e,isPotato:!e.isPotato};case"s/TGL_LIGHT_GRID":return{...e,isLightGrid:!e.isLightGrid};case"s/TGL_COMPACT_PALETTE":return{...e,compactPalette:!e.compactPalette};case"s/TGL_OPEN_PALETTE":return{...e,paletteOpen:!e.paletteOpen};case"s/TGL_OPEN_MENU":return{...e,menuOpen:!e.menuOpen};case"s/SELECT_STYLE":{const{style:n}=t;return{...e,style:n}}case"SELECT_COLOR":{const{compactPalette:t}=e;let{paletteOpen:n}=e;return(t||window.innerWidth<300)&&(n=!1),{...e,paletteOpen:n}}case"s/TGL_MUTE":return{...e,mute:!e.mute};case"s/TGL_CHAT_NOTIFY":return{...e,chatNotify:!e.chatNotify};default:return e}})),ranks:(0,i.OJ)({key:"ranks",storage:d.Z,version:15,migrate:x},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REC_SET_PXLS":{const{rankedPxlCnt:n}=t;if(!n)return e;let{totalPixels:i,dailyTotalPixels:o}=e;return i+=n,o+=n,{...e,totalPixels:i,dailyTotalPixels:o}}case"REC_ONLINE":{const{online:n}=t;return{...e,online:n}}case"s/REC_ME":case"s/LOGIN":{if(!t.totalPixels)return e;const{totalPixels:n,dailyTotalPixels:i,ranking:o,dailyRanking:r}=t;return{...e,totalPixels:n,dailyTotalPixels:i,ranking:o,dailyRanking:r}}case"REC_STATS":{const{totalRanking:n,totalDailyRanking:i,dailyCRanking:o,prevTop:r,onlineStats:s,cHistStats:a,histStats:l,pDailyStats:c,pHourlyStats:u}=t,d={totalRanking:n,totalDailyRanking:i,dailyCRanking:o,prevTop:r,onlineStats:s,cHistStats:a,histStats:l,pDailyStats:c,pHourlyStats:u},h=Date.now();return{...e,lastFetch:h,...d}}default:return e}})),chatRead:(0,i.OJ)({key:"cr",storage:d.Z,version:15,migrate:x},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/REC_ME":case"s/LOGIN":{const{channels:n}=t,i=Object.keys(n),o={},r={};for(let t=0;t<i.length;t+=1){const s=i[t];e.readTs[s]?o[s]=e.readTs[s]:o[s]=0,r[s]=n[s][2]>o[s]}return{...e,readTs:o,unread:r}}case"s/ADD_CHAT_CHANNEL":{const[n]=Object.keys(t.channel);return{...e,readTs:{...e.readTs,[n]:e.readTs[n]||0},unread:{...e.unread,[n]:!0}}}case"s/REMOVE_CHAT_CHANNEL":{const{cid:n}=t;if(!e.readTs[n])return e;const i={...e.readTs};delete i[n];const o={...e.unread};return delete o[n],{...e,readTs:i,unread:o}}case"s/REC_CHAT_MESSAGE":{const{channel:n,isRead:i}=t,o=i?{...e.readTs,[n]:Date.now()+v}:e.readTs,r=i?e.unread:{...e.unread,[n]:!0};return{...e,readTs:o,unread:r}}case"OPEN_WIN":{const{windowType:n}=t;if("CHAT"!==n)return e;const i=t.args&&t.args.chatChannel||1;return{...e,readTs:{...e.readTs,[i]:Date.now()+v},unread:{...e.unread,[i]:!1}}}case"MARK_CHANNEL_AS_READ":{const{cid:n}=t;return{...e,readTs:{...e.readTs,[n]:Date.now()+v},unread:{...e.unread,[n]:!1}}}case"s/MUTE_CHAT_CHANNEL":{const{cid:n}=t;return{...e,mute:[...e.mute,n]}}case"s/UNMUTE_CHAT_CHANNEL":{const{cid:n}=t,i=e.mute.filter((e=>e!==n));return{...e,mute:i}}default:return e}})),user:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"COOLDOWN_SET":{const{coolDown:n}=t;return{...e,coolDown:n||null}}case"COOLDOWN_END":return{...e,coolDown:null,lastCoolDownEnd:Date.now(),wait:null};case"REC_SET_PXLS":{const{wait:n}=t;return{...e,wait:n?Date.now()+n:e.wait}}case"REC_COOLDOWN":{const{wait:n}=t,i=n?Date.now()+n:null;return{...e,wait:i,coolDown:null}}case"SET_MOBILE":{const{mobile:n}=t;return{...e,isOnMobile:n}}case"s/REC_ME":case"s/LOGIN":{const{id:n,name:i,mailreg:o,blockDm:r,priv:s,userlvl:a}=t,l=t.messages?t.messages:[];return{...e,id:n,name:i,messages:l,mailreg:o,blockDm:r,priv:s,userlvl:a}}case"s/LOGOUT":return{...e,id:null,name:null,messages:[],mailreg:!1,blockDm:!1,priv:!1,userlvl:0};case"s/SET_NAME":{const{name:n}=t;return{...e,name:n}}case"s/SET_BLOCKING_DM":{const{blockDm:n}=t;return{...e,blockDm:n}}case"s/SET_PRIVATE":{const{priv:n}=t;return{...e,priv:n}}case"SET_NOTIFICATION":return{...e,notification:t.notification};case"UNSET_NOTIFICATION":return{...e,notification:null};case"s/REM_FROM_MESSAGES":{const{message:n}=t,i=[...e.messages],o=i.indexOf(n);return o>-1&&i.splice(o),{...e,messages:i}}case"s/SET_MAILREG":{const{mailreg:n}=t;return{...e,mailreg:n}}default:return e}},canvas:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SCALE":{let{view:n,viewscale:i}=e;const{isHistoricalView:o}=e,r=o?e.historicalCanvasSize:e.canvasSize;let[s,a]=n,{scale:l}=t;const{zoompoint:c}=t,u=o?.7:b.I_/r;if(l=(0,y.uZ)(l,u,b.Fv),c){let e=i;i=l>.85&&l<1.2?1:l,e/=i;const[t,n]=c;s=t+(s-t)*e,a=n+(a-n)*e}else i=l;const d=-r/2,h=r/2-1;return n=[s,a].map((e=>(0,y.uZ)(e,d,h))),{...e,view:n,scale:l,viewscale:i}}case"SET_HISTORICAL_TIME":{const{date:n,time:i}=t,{canvasSize:o,canvases:r,canvasId:s}=e,a=(0,y.Ss)(n,o,r[s].historicalSizes);return{...e,historicalCanvasSize:a,historicalDate:n,historicalTime:i}}case"s/TGL_HISTORICAL_VIEW":{const{scale:t,viewscale:n}=e;return{...e,scale:t<1?1:t,viewscale:n<1?1:n,isHistoricalView:!e.is3D&&!e.isHistoricalView}}case"s/TGL_HIDDEN_CANVASES":return{...e,showHiddenCanvases:!e.showHiddenCanvases};case"SET_VIEW_COORDINATES":{const{view:n}=t,i=e.isHistoricalView?e.historicalCanvasSize:e.canvasSize,o=-i/2,r=i/2-1,s=n.map((e=>(0,y.uZ)(e,o,r)));return{...e,view:s}}case"RELOAD_URL":{const{canvases:t}=e,n=S(t);return{...e,...n}}case"SELECT_COLOR":return{...e,selectedColor:t.color};case"SET_HOVER":{const{hover:n}=t;return{...e,hover:n}}case"UNSET_HOVER":return{...e,hover:null};case"s/SELECT_CANVAS":{let{canvasId:n}=t;const{canvases:i,prevCanvasCoords:o,canvasId:r}=e;let s=i[n];s||(n=b.V4,s=i[b.V4]);const a=s.cli||0,{size:l,sd:c,ident:u,colors:d}=s,h=!!s.v;let f=b.A$,v=b.A$,p=[0,0,0],m=a;o[n]&&(p=o[n].view,f=o[n].viewscale,v=o[n].scale,m=o[n].selectedColor);const g=!h&&e.isHistoricalView,S=(0,y.Ss)(e.historicalDate,l,s.historicalSizes),k=new w(d,0);return h||(p.length=2),{...e,canvasId:n,canvasIdent:u,selectedColor:m,canvasSize:l,is3D:h,canvasStartDate:c,palette:k,clrIgnore:a,view:p,viewscale:f,scale:v,isHistoricalView:g,historicalCanvasSize:S,prevCanvasCoords:{...e.prevCanvasCoords,[r]:{view:e.view,scale:e.scale,viewscale:e.viewscale,selectedColor:e.selectedColor}}}}case"s/REC_ME":{const{canvases:n}=t;let{canvasIdent:i,scale:o,view:r}=e,s=(0,y.s3)(n,i);null===s&&(s=b.V4,i=n[b.V4].ident);const a=n[s],l=a.cli||0,c=!!a.v,{size:u,sd:d,colors:h}=a,f=new w(h,0);return c||(o=(0,y.uZ)(o,b.I_/u,b.Fv),r=[r[0],r[1]]),{...e,canvasId:s,canvasIdent:i,canvasSize:u,is3D:c,canvasStartDate:d,palette:f,clrIgnore:l,canvases:n,viewscale:o,scale:o,view:r}}default:return e}},chat:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/REC_ME":case"s/LOGIN":{const n={},i=t.channels,o=Object.keys(i);for(let e=0;e<o.length;e+=1){const t=o[e];n[Number(t)]=i[t]}return{...e,channels:n,blocked:t.blocked}}case"s/LOGOUT":{const t={...e.channels},n={...e.messages},i=Object.keys(t);for(let e=0;e<i.length;e+=1){const o=i[e];0!==t[o][1]&&(delete n[o],delete t[o])}return{...e,channels:t,blocked:[],messages:n}}case"s/BLOCK_USER":{const{userId:n,userName:i}=t,o=[...e.blocked,[n,i]],r={...e.channels},s=Object.keys(r);for(let t=0;t<s.length;t+=1){const i=s[t];if(1===r[i][1]&&r[i][3]===n)return delete r[i],{...e,channels:r,blocked:o}}return{...e,blocked:o}}case"s/UNBLOCK_USER":{const{userId:n}=t,i=e.blocked.filter((e=>e[0]!==n));return{...e,blocked:i}}case"s/ADD_CHAT_CHANNEL":{const{channel:n}=t,i=Number(Object.keys(n)[0]);return e.channels[i]?e:{...e,channels:{...e.channels,...n}}}case"s/REMOVE_CHAT_CHANNEL":{const{cid:n}=t;if(!e.channels[n])return e;const i={...e.channels},o={...e.messages};return delete o[n],delete i[n],{...e,channels:i,messages:o}}case"s/REC_CHAT_MESSAGE":{const{name:n,text:i,country:o,channel:r,user:s}=t;if(!e.messages[r]||!e.channels[r])return e;const a=Math.round(Date.now()/1e3);E+=1;const l={...e.messages,[r]:[...e.messages[r],[n,i,o,s,a,E]]};l[r].length>b.Kb&&l[r].splice(0,2);const c=[...e.channels[r]];return c[2]=Date.now(),{...e,channels:{...e.channels,[r]:c},messages:l}}case"s/REC_CHAT_HISTORY":{const{cid:n,history:i}=t;for(let e=0;e<i.length;e+=1)E+=1,i[e].push(E);return{...e,messages:{...e.messages,[n]:i}}}default:return e}},fetching:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"s/SET_CHAT_FETCHING":{const{fetching:n}=t;return{...e,fetchingChat:n}}case"SET_API_FETCHING":{const{fetching:n}=t;return{...e,fetchingApi:n}}case"REQ_BIG_CHUNK":{const{fetchingChunks:t}=e;return{...e,fetchingChunks:t+1}}case"REC_BIG_CHUNK":case"REC_BIG_CHUNK_FAILURE":{const{fetchingChunks:t}=e;return{...e,fetchingChunks:t-1}}case"SET_PXLS_FETCHING":{const{fetching:n}=t;return{...e,fetchingPixel:n}}default:return e}}},N=30,_=70;function A(e){let t=Math.floor(99999*Math.random())+1;for(;e.args[t];)t+=1;return t}function P(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=window.innerWidth,o=window.innerHeight;n&&(i=Math.floor(.7*i),o=Math.floor(Math.min(.8*o,900)));const r=e||i,s=t||o;return[(0,y.uZ)(r,70,i),(0,y.uZ)(s,50,o)]}function O(e,t,n,i){const o=e||0===e?e:Math.floor((window.innerWidth-n)/2),r=t||0===t?t:Math.floor((window.innerHeight-i)/2);return[(0,y.uZ)(o,_-n,window.innerWidth-_),(0,y.uZ)(r,0,window.innerHeight-N)]}function L(e){const{innerWidth:t,innerHeight:n}=window,{windows:i,positions:o}=e,r=t-_,s=n-N;let a=!1;const l={};for(let e=0;e<i.length;e+=1){const c=i[e].windowId,{xPos:u,yPos:d,width:h,height:f}=o[c],v=_-h;u>r||d>s||u<v||d<0||t>h||n>f?(a=!0,l[c]={xPos:(0,y.uZ)(u,v,r),yPos:(0,y.uZ)(d,0,s),width:Math.min(h,t-N),height:Math.min(f,n-N),z:o[c].z}):l[c]=o[c]}return a?{...e,positions:l}:e}function R(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.zMax>=50||t){const t={...e.positions},n=Object.keys(t),i=n.map((e=>t[e].z)).sort(((e,t)=>!t||e&&e>=t));for(let e=0;e<n.length;e+=1){const o=n[e];t[o]={...t[o],z:i.indexOf(t[o].z)}}e.zMax=i.length-1,e.positions=t}return e}const D={showWindows:window.innerWidth>604,zMax:0,windows:[],positions:{},args:{}},$={open:!1,alertType:null,title:null,message:null,btn:null},M=window.AudioContext||window.webkitAudioContext,z=M&&new M;function H(e){const t=new ArrayBuffer(2),n=new DataView(t);return n.setInt8(0,160),n.setInt8(1,Number(e)),t}var W=n(8953),U=n(980);function G(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const F=new class{constructor(){G(this,"store",null),G(this,"pixelTransferController",null),G(this,"ws",null),G(this,"getRenderer",void 0),console.log("Creating WebSocketClient"),this.channelId=0,this.readyState=WebSocket.CLOSED,this.msgQueue=[],this.reqQueue=[],this.checkHealth=this.checkHealth.bind(this),setInterval(this.checkHealth,2e3)}initialize(e,t,n){return this.store=e,t&&(this.pixelTransferController=t),n&&(this.getRenderer=n),this.connect()}connect(){this.readyState=WebSocket.CONNECTING,this.ws&&console.log("WebSocket already open, not starting"),this.timeLastConnecting=Date.now();const e=`${"https:"===window.location.protocol?"wss:":"ws:"}//${U.uY||window.location.host}/ws`;this.ws=new WebSocket(e),this.ws.binaryType="arraybuffer",this.ws.onopen=this.onOpen.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onclose=this.onClose.bind(this),this.ws.onerror=e=>{console.error("Socket encountered error, closing socket",e)}}checkHealth(){if(this.readyState===WebSocket.OPEN){const e=Date.now();e-3e4>this.timeLastPing&&(console.log("Server is silent, killing websocket"),this.readyState=WebSocket.CLOSING,this.ws.close()),e-23e3>this.timeLastSent&&(this.send(new Uint8Array([176]).buffer),this.timeLastSent=e)}}sendWhenReady(e){this.timeLastSent=Date.now(),this.readyState===WebSocket.OPEN?this.ws.send(e):(console.log("Tried sending message when websocket was closed!"),this.msgQueue.push(e))}send(e){this.readyState===WebSocket.OPEN&&this.ws.send(e)}processMsgQueue(){for(;this.msgQueue.length>0;)this.sendWhenReady(this.msgQueue.shift())}onOpen(){const e=Date.now();this.timeLastPing=e,this.timeLastSent=e,this.store.dispatch((0,W.$s)()),this.readyState=WebSocket.OPEN,this.send(H(this.store.getState().canvas.canvasId));const t=this.getRenderer?.().recChunkIds;t?.length&&(console.log(`Register ${t.length} chunks`),this.send(function(e){const t=new ArrayBuffer(2+2*e.length),n=new Uint16Array(t);n[0]=163;for(let t=0;t<e.length;t+=1)n[t+1]=e[t];return t}(t))),this.processMsgQueue()}setCanvas(e){null!==e&&(console.log(`Notify websocket server that we changed canvas to ${e}`),this.send(H(e)))}registerChunk(e){const t=function(e){const t=new ArrayBuffer(3),n=new DataView(t);return n.setInt8(0,161),n.setInt16(1,e),t}(e);this.readyState===WebSocket.OPEN&&this.send(t)}deRegisterChunks(e){const t=function(e){const t=new ArrayBuffer(2+2*e.length),n=new Uint16Array(t);n[0]=164;for(let t=0;t<e.length;t+=1)n[t+1]=e[t];return t}(e);this.readyState===WebSocket.OPEN&&this.send(t)}sendCaptchaSolution(e,t){return new Promise(((n,i)=>{let o;const r=["cs",e=>{n(e),clearTimeout(o)}];this.reqQueue.push(r),o=setTimeout((()=>{const e=this.reqQueue.indexOf(r);~e&&this.reqQueue.splice(e,1),i(new Error("Timeout"))}),2e4),this.sendWhenReady(`cs,${JSON.stringify([e,t])}`)}))}sendPixelUpdate(e,t,n){return new Promise(((i,o)=>{let r;const s=["pu",e=>{i(e),clearTimeout(r)}];this.reqQueue.push(s),r=setTimeout((()=>{const e=this.reqQueue.indexOf(s);~e&&this.reqQueue.splice(e,1),o(new Error("Timeout"))}),2e4),this.sendWhenReady(function(e,t,n){const i=new ArrayBuffer(3+4*n.length),o=new DataView(i);o.setUint8(0,193),o.setUint8(1,e),o.setUint8(2,t);let r=2,s=n.length;for(;s;){s-=1;const[e,t]=n[s];o.setUint8(r+=1,e>>>16),o.setUint16(r+=1,65535&e),o.setUint8(r+=2,t)}return i}(e,t,n))}))}sendChatMessage(e,t){this.sendWhenReady(`cm,${JSON.stringify([e,t])}`)}onMessage(e){let{data:t}=e;try{"string"==typeof t?this.onTextMessage(t):this.onBinaryMessage(t)}catch(e){console.log(`An error occurred while parsing websocket message ${t}`,e)}}onTextMessage(e){const t=e.indexOf(",");if(-1===t)return;const n=e.slice(0,t),i=JSON.parse(e.slice(t+1));switch(n){case"cm":this.store.dispatch((0,W.pl)(...i));break;case"ac":this.store.dispatch((0,W.dm)(i));break;case"rc":this.store.dispatch((0,W.jg)(i))}}onBinaryMessage(e){if(0===e.byteLength)return;const t=new DataView(e),n=t.getUint8(0);switch(this.timeLastPing=Date.now(),n){case 193:this.pixelTransferController&&this.pixelTransferController.receivePixelUpdate(function(e){const t=e.getUint8(1),n=e.getUint8(2),i=[];let o=e.byteLength;for(;o>3;){const t=e.getUint8(o-=1),n=e.getUint16(o-=2),r=e.getUint8(o-=1)<<16;i.push([r|n,t])}return{i:t,j:n,pixels:i}}(t));break;case 195:{const e=this.reqQueue.findIndex((e=>"pu"===e[0]));~e&&this.reqQueue.splice(e,1)[0][1](function(e){return{retCode:e.getUint8(1),wait:e.getUint32(2),coolDownSeconds:e.getInt16(6),pxlCnt:e.getUint8(8),rankedPxlCnt:e.getUint8(9)}}(t));break}case 167:this.store.dispatch((0,W.Wm)(function(e){const t={};t.total=e.getUint16(1);let n=e.byteLength;for(;n>3;){const i=e.getUint16(n-=2);t[e.getUint8(n-=1)]=i}return t}(t)));break;case 194:this.store.dispatch((0,W.At)(function(e){return e.getUint32(1)}(t)));break;case 166:console.log("Websocket requested api/me reload"),this.store.dispatch((0,s.aM)()),this.reconnect();break;case 198:{const e=this.reqQueue.findIndex((e=>"cs"===e[0]));~e&&this.reqQueue.splice(e,1)[0][1](function(e){return e.getUint8(1)}(t));break}default:console.error(`Unknown op_code ${n} received`)}}onClose(e){this.store.dispatch((0,W.WV)()),this.ws=null,this.readyState=WebSocket.CONNECTING;const t=this.timeLastConnecting<Date.now()-7e3?1e3:5e3;console.warn(`Socket is closed. Reconnect will be attempted in ${t} ms.`,e.reason),setTimeout((()=>this.connect()),t)}reconnect(){this.readyState===WebSocket.OPEN&&(this.readyState=WebSocket.CLOSING,console.log("Restarting WebSocket"),this.ws.onclose=null,this.ws.onmessage=null,this.ws.close(),this.ws=null,this.connect())}};var V=n(1430);const Z=1.2;function K(e,t,n,i){const{width:o,height:r}=t,s=t.getContext("2d");if(!s)return;s.globalAlpha=.5,s.fillStyle=i?"#DDDDDD":"#222222";let[a,l]=(0,y.nK)(e,t,[0,0]),[c,u]=(0,y.Cr)(e,t,[a,l]);for(;c<o;c+=n){const e=a++%10==0?2:1;s.fillRect(c,0,e,r)}for(;u<r;u+=n){const e=l++%10==0?2:1;s.fillRect(0,u,o,e)}s.globalAlpha=1}class B{constructor(e,t,n){this.store=n,this.renderer=e,this.viewport=t,this.onMouseDown=this.onMouseDown.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onAuxClick=this.onAuxClick.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onWheel=this.onWheel.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onViewFinishChangeTimeOut=null,this.clickTapStartView=[0,0],this.clickTapStartTime=0,this.clickTapStartCoords=[0,0],this.tapStartDist=50,this.tapStartScale=this.store.getState().scale,this.isClicking=!1,this.isMultiTab=!1,this.tapTimeout=null,this.holdPainting=0,this.coolDownDelta=!1,document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.onKeyUp,!1),t.addEventListener("auxclick",this.onAuxClick,!1),t.addEventListener("mousedown",this.onMouseDown,!1),t.addEventListener("mousemove",this.onMouseMove,!1),t.addEventListener("mouseup",this.onMouseUp,!1),t.addEventListener("wheel",this.onWheel,!1),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("mouseout",this.onMouseOut,!1),t.addEventListener("touchcancel",this.onMouseOut,!1)}dispose(){document.removeEventListener("keydown",this.onKeyDown,!1),document.removeEventListener("keyup",this.onKeyUp,!1)}gotCoolDownDelta(e){this.coolDownDelta=!0,setTimeout((()=>{this.coolDownDelta=!1}),1e3*e)}onMouseDown(e){if(e.preventDefault(),document.activeElement.blur(),0===e.button){clearTimeout(this.onViewFinishChangeTimeOut),this.isClicking=!0;const{clientX:t,clientY:n}=e;this.clickTapStartTime=Date.now(),this.clickTapStartCoords=[t,n],this.clickTapStartView=this.store.getState().canvas.view;const{viewport:i}=this;setTimeout((()=>{this.isClicking&&(i.style.cursor="move")}),300)}}scheduleOnViewFinishChange(){this.onViewFinishChangeTimeOut&&clearTimeout(this.onViewFinishChangeTimeOut),this.onViewFinishChangeTimeOut=setTimeout((()=>{this.store.dispatch((0,r.a6)())}),500)}onMouseUp(e){e.preventDefault();const{store:t}=this;if(0===e.button){this.isClicking=!1;const{clientX:n,clientY:i}=e,{clickTapStartCoords:o,clickTapStartTime:r}=this,s=[o[0]-n,o[1]-i];if(r>Date.now()-250&&s[0]<2&&s[1]<2){const e=t.getState(),o=(0,y.nK)(e,this.viewport,[n,i]);B.placePixel(t,this.renderer,o)}this.viewport.style.cursor="auto"}this.scheduleOnViewFinishChange()}static getTouchCenter(e){switch(e.touches.length){case 1:{const{pageX:t,pageY:n}=e.touches[0];return[t,n]}case 2:return[Math.floor(.5*(e.touches[0].pageX+e.touches[1].pageX)),Math.floor(.5*(e.touches[0].pageY+e.touches[1].pageY))]}return null}static placePixel(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=e.getState(),{autoZoomIn:s}=o.gui,{clrIgnore:a}=o.canvas,{scale:c,isHistoricalView:u}=o.canvas,d=null===i?o.canvas.selectedColor:i;if(u)return;if(s&&c<8)return e.dispatch((0,r.w5)(n)),void e.dispatch((0,r.ZP)(12));if(c<3)return;const h=t.getColorIndexOfPixel(...n);if(d===h)return;if(d<a){const{palette:e}=o.canvas,{rgb:t}=e;let n=3*d;const i=t[n++],r=t[n++],s=t[n];if(e.getIndexOfColor(i,r,s)===h)return}const{canvasSize:f}=o.canvas,[v,p]=n;if(v>5275&&p>-8713&&v<5398&&p<-8614&&"0"===o.canvas.canvasId)return void(window.location.href="https://files.catbox.moe/gh2wtr.mp4");const m=f/2;if(v<-m||v>=m||p<-m||p>=m)return;const[g,w]=(0,y.sG)(f,v,p),b=(0,y.NK)(f,v,p);l.Z.tryPlacePixel(g,w,b,d,h)}static getMultiTouchDistance(e){if(e.touches.length<2)return 1;const t=e.touches[0],n=e.touches[1];return Math.sqrt((n.pageX-t.pageX)**2+(n.pageY-t.pageY)**2)}onTouchStart(e){e.preventDefault(),e.stopPropagation(),document.activeElement.blur(),clearTimeout(this.onViewFinishChangeTimeOut),this.clickTapStartTime=Date.now(),this.clickTapStartCoords=B.getTouchCenter(e);const t=this.store.getState();this.clickTapStartView=t.canvas.view,e.touches.length>1?(this.tapStartScale=t.canvas.scale,this.tapStartDist=B.getMultiTouchDistance(e),this.isMultiTab=!0,this.clearTabTimeout()):(this.isClicking=!0,this.isMultiTab=!1,this.tapTimeout=setTimeout((()=>{B.selectColor(this.store,this.viewport,this.renderer,this.clickTapStartCoords)}),600))}onTouchEnd(e){e.preventDefault(),e.stopPropagation();const{store:t}=this;if(0===e.touches.length&&this.isClicking){const{pageX:n,pageY:i}=e.changedTouches[0],{clickTapStartCoords:o,clickTapStartTime:s}=this,a=[o[0]-n,o[1]-i];if(s>Date.now()-580&&a[0]<2&&a[1]<2){const{viewport:e}=this,o=t.getState(),s=(0,y.nK)(o,e,[n,i]);B.placePixel(t,this.renderer,s),setTimeout((()=>{t.dispatch((0,r.BH)())}),500)}}this.scheduleOnViewFinishChange(),this.clearTabTimeout()}onTouchMove(e){e.preventDefault(),e.stopPropagation();const t=e.touches.length>1,[n,i]=B.getTouchCenter(e),{store:o}=this,s=o.getState();if(this.isMultiTab!==t)this.isMultiTab=t,this.clickTapStartCoords=[n,i],this.clickTapStartView=s.canvas.view,this.tapStartDist=B.getMultiTouchDistance(e),this.tapStartScale=s.canvas.scale;else{const{clickTapStartView:a,clickTapStartCoords:l}=this,[c,u]=a,d=n-l[0],h=i-l[1];(d>2||h>2)&&this.clearTabTimeout();const{scale:f}=s.canvas;if(o.dispatch((0,r.w5)([c-d/f,u-h/f])),t){this.clearTabTimeout();const t=e.touches[0],n=e.touches[1],{tapStartDist:i,tapStartScale:s}=this,a=Math.sqrt((n.pageX-t.pageX)**2+(n.pageY-t.pageY)**2)/i;o.dispatch((0,r.ZP)(s*a))}}}clearTabTimeout(){this.isClicking=!1,this.tapTimeout&&(clearTimeout(this.tapTimeout),this.tapTimeout=null)}onWheel(e){e.preventDefault(),document.activeElement.blur();const{deltaY:t}=e,{store:n}=this,i=n.getState(),{hover:o}=i.canvas;let s=null;o&&(s=o),t<0&&n.dispatch((0,r.kr)(s)),t>0&&n.dispatch((0,r.vG)(s)),this.scheduleOnViewFinishChange()}onMouseMove(e){e.preventDefault();const{clientX:t,clientY:n}=e,{store:i,isClicking:o}=this,s=i.getState();if(o){if(Date.now()<this.clickTapStartTime+100)return;const{clickTapStartView:e,clickTapStartCoords:o}=this,[a,l]=e,c=t-o[0],u=n-o[1],{scale:d}=s.canvas;i.dispatch((0,r.w5)([a-c/d,l-u/d]))}else{const{hover:e}=s.canvas,o=(0,y.nK)(s,this.viewport,[t,n]),[a,l]=o,{canvasSize:c}=s.canvas,u=c/2;if(a<-u||a>=u||l<-u||l>=u)return void(e&&i.dispatch((0,r.BH)()));if(!(e&&e[0]===a&&e[1]===l||(i.dispatch((0,r.GZ)(o)),this.coolDownDelta)))switch(this.holdPainting){case 1:B.placePixel(i,this.renderer,o);break;case 2:{const e=this.renderer.getColorIndexOfPixel(a,l,!0);null!==e&&B.placePixel(i,this.renderer,o,e);break}}}}onMouseOut(){const{store:e,viewport:t}=this;t.style.cursor="auto",e.dispatch((0,r.BH)()),this.holdPainting=0,this.clearTabTimeout()}static selectColor(e,t,n,i){const o=e.getState();if(o.canvas.scale<3)return;const s=(0,y.nK)(o,t,i),a=n.getColorIndexOfPixel(...s);null!==a&&e.dispatch((0,r.Oh)(a))}onAuxClick(e){const{which:t,clientX:n,clientY:i}=e;2===t&&(e.preventDefault(),B.selectColor(this.store,this.viewport,this.renderer,[n,i]))}onKeyUp(e){switch(e.key){case"Shift":case"CapsLock":this.holdPainting=0}}onKeyDown(e){if("INPUT"===e.target.nodeName||"TEXTAREA"===e.target.nodeName)return;const{store:t}=this;switch(e.code){case"ArrowUp":case"KeyW":return void t.dispatch((0,r.hg)());case"ArrowLeft":case"KeyA":return void t.dispatch((0,r.wh)());case"ArrowDown":case"KeyS":return void t.dispatch((0,r.dv)());case"ArrowRight":case"KeyD":return void t.dispatch((0,r.L4)());case"KeyE":return void t.dispatch((0,r.kr)());case"KeyQ":return void t.dispatch((0,r.vG)())}switch(e.key){case"+":t.dispatch((0,r.kr)());break;case"-":t.dispatch((0,r.vG)());break;case"Control":case"Shift":{const n=t.getState(),{hover:i}=n.canvas;if(i){if("Control"===e.key){const e=this.renderer.getColorIndexOfPixel(...i);return void t.dispatch((0,r.Oh)(e))}if(e.location===KeyboardEvent.DOM_KEY_LOCATION_LEFT)return this.holdPainting=1,void B.placePixel(t,this.renderer,i);if(e.location===KeyboardEvent.DOM_KEY_LOCATION_RIGHT){this.holdPainting=2;const e=this.renderer.getColorIndexOfPixel(...i,!0);null!==e&&B.placePixel(t,this.renderer,i,e)}}break}}}}const j=B;var q=n(3968),Y=n(9483);function X(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Q extends Y.Z{constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0),X(this,"image",void 0),X(this,"ready",void 0),X(this,"isEmpty",void 0),X(this,"palette",void 0),this.palette=e,this.image=document.createElement("canvas"),this.image.width=b.I_,this.image.height=b.I_,this.ready=!1,this.isEmpty=!1}fromBuffer(e){this.recUpdates=!0;const t=new ImageData(b.I_,b.I_),n=new Uint32Array(t.data.buffer),{abgr:i}=this.palette;let o=e.byteLength;for(let t=0;t<o;t+=1)n[t]=i[63&e[t]];const r=b.I_**2,s=this.palette.abgr[0];for(;o<r;)n[o]=s,o+=1;this.image.getContext("2d").putImageData(t,0,0),this.ready=!0}preLoad(e,t,n,i){if(this.ready)return;this.ready=!0;const o=this.image.getContext("2d");o.save(),o.msImageSmoothingEnabled=!1,o.webkitImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,o.scale(t,t);const r=b.I_/t;o.drawImage(e,n,i,r,r,0,0,r,r),o.restore()}fromImage(e){this.ready=!0,this.image.getContext("2d").drawImage(e,0,0)}empty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.ready=!0,this.isEmpty=!0,!e){const{image:e,palette:t}=this,n=e.getContext("2d");n.fillStyle=t.colors[0],n.fillRect(0,0,b.I_,b.I_)}}static getIndexFromCell(e){let[t,n]=e;return t+b.I_*n}getColorIndex(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const[n,i]=e,o=this.image.getContext("2d").getImageData(n,i,1,1).data;return t?this.palette.getClosestIndexOfColor(o[0],o[1],o[2]):this.palette.getIndexOfColor(o[0],o[1],o[2])}hasColorIn(e,t){const n=Q.getIndexFromCell(e),i=this.image.getContext("2d").getImageData(0,0,b.I_,b.I_);return new Uint32Array(i.data.buffer)[n]===this.palette.abgr[t]}setColor(e,t){const[n,i]=e,o=this.image.getContext("2d");return o.fillStyle=this.palette.colors[t],o.fillRect(n,i,1,1),!0}}const J=Q;const ee=/^([\w]+:)?\/\//;function te(e){return new Promise(((t,n)=>{const i=new Image;i.addEventListener("load",(()=>t(i))),i.addEventListener("error",(()=>{n(new Error(`Failed to load image's URL: ${e}`))})),function(e){return ee&&e.replace(ee,"").indexOf(window.location.host)}(e)&&(i.crossOrigin="anonymous"),i.src=e}))}const ne=new class{constructor(){var e,t,n;e=this,n=void 0,(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t="tiles"))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,this.tiles={},this.loadLoadingTile(0)}getTile(e){return void 0===this.tiles[e]&&this.loadLoadingTile(e),this.tiles[e]||this.tiles[0]||null}async loadLoadingTile(e){null!==this.tiles[e]&&(this.tiles[e]=null,this.tiles[e]=await te(`./loading${e}.png`))}};function ie(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oe extends q.Z{constructor(e,t,n,i,o){super(e,t),ie(this,"canvasMaxTiledZoom",void 0),ie(this,"historicalMaxTiledZooms",void 0),ie(this,"palette",void 0),ie(this,"canvasSize",void 0),this.palette=n,this.canvasSize=i,this.canvasMaxTiledZoom=(0,y.W4)(i),this.historicalMaxTiledZooms=o?o.map((e=>{const[t,n]=e;return[t,(0,y.W4)(n)]})):[]}getPixelUpdate(e,t,n,i){const o=this.cget(`${this.canvasMaxTiledZoom}:${e}:${t}`);if(o){const e=n%b.I_,t=Math.floor(n/b.I_);o.setColor([e,t],i)}}getColorIndexOfPixel(e,t){const{canvasSize:n}=this,[i,o]=(0,y.sG)(n,e,t),r=`${this.canvasMaxTiledZoom}:${i}:${o}`,s=this.cget(r);return s?s.getColorIndex((0,y.D0)(n,[e,t])):0}getHistoricalIndexOfPixel(e,t,n,i,o){if(!n)return null;const[r,s]=(0,y.sG)(o,e,t),a=(0,y.D0)(o,[e,t]),l=Date.now();if(i&&"0000"!==i){const e=`${n}${i}:${r}:${s}`,t=this.cget(e);if(t){const e=t.getColorIndex(a,!1);if(t.timestamp=l,null!==e)return e}}const c=`${n}:${r}:${s}`,u=this.cget(c);return u?(u.timestamp=l,u.getColorIndex(a)):null}preLoadChunk(e,t,n,i){if(e<=0)return null;try{let o=e-1,r=b.p7,[s,a]=[t,n].map((e=>Math.floor(e/r))),l=this.getChunk(o,s,a,!1,!1,!0);if(l||(o>0&&(o-=1),r=b.p7**(e-o),[s,a]=[t,n].map((e=>Math.floor(e/r))),l=this.getChunk(o,s,a,!0,!1,!0)),l){const e=t%r*b.I_/r,o=n%r*b.I_/r;return i.preLoad(l,r,e,o),i.image}}catch(i){return console.warn(`Error occurred while preloading for ${e}:${t}:${n}`,i),null}return null}getChunk(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const s=`${e}:${t}:${n}`;let a=this.cget(s);if(a){if(a.ready)return a.image}else i&&(a=new J(this.palette,e,t,n),this.cset(s,a),this.canvasMaxTiledZoom===e?this.fetchBaseChunk(t,n,a):this.fetchTile(e,t,n,a));if(r&&a){const i=this.preLoadChunk(e,t,n,a);if(i)return i}return o?ne.getTile(this.canvasId):null}getHistoricalChunk(e,t,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=o?`${i}${o}`:i;r+=`:${e}:${t}`;const s=this.cget(r),{canvasId:a}=this;if(s)return s.ready?s.image:o?null:ne.getTile(a);if(n){const n=(0,y.Ss)(i,this.canvasMaxTiledZoom,this.historicalMaxTiledZooms),s=new J(this.palette,n,e,t);this.cset(r,s),this.fetchHistoricalChunk(e,t,i,o,s)}return o?null:ne.getTile(a)}async fetchHistoricalChunk(e,t,n,i,o){const{canvasId:r}=this;let s=`${window.ssv.backupurl}/${n.slice(0,4)}/${n.slice(4,6)}/${n.slice(6)}/`;s+=i?`${r}/${i}/${e}/${t}.png`:`${r}/tiles/${e}/${t}.png`,this.bcReqChunk(o);try{const e=await te(s);o.fromImage(e),this.bcRecChunk(o)}catch(e){this.bcReqChunkFail(o,e),i?o.empty(!0):o.empty()}}async fetchBaseChunk(e,t,n){this.bcReqChunk(n);try{const i=`${U.Fx}/chunks/${this.canvasId}/${e}/${t}.bmp`,o=await fetch(i);if(!o.ok)throw new Error("Network response was not ok.");{const e=await o.arrayBuffer();if(!e.byteLength)throw new Error("Chunk response was invalid");{const t=new Uint8Array(e);n.fromBuffer(t)}this.bcRecChunk(n)}}catch(e){n.empty(),n.recUpdates=!0,this.bcReqChunkFail(n,e)}}async fetchTile(e,t,n,i){this.bcReqChunk(i);try{const o=`/tiles/${this.canvasId}/${e}/${t}/${n}.webp`,r=await te(o);i.fromImage(r),this.bcRecChunk(i)}catch(e){i.empty(),this.bcReqChunkFail(i,e)}}}const re=oe;function se(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ae{constructor(){se(this,"scale",void 0),se(this,"notifcircle",void 0),se(this,"notificationRadius",void 0),se(this,"pixelList",void 0),this.pixelList=[],this.notificationRadius=150,this.notifcircle=document.createElement("canvas"),this.notifcircle.width=200,this.notifcircle.height=200;const e=this.notifcircle.getContext("2d");e&&(e.fillStyle="#FF000055",e.beginPath(),e.arc(100,100,100,0,2*Math.PI),e.closePath(),e.fill())}addPixel(e,t){this.pixelList.length<300&&this.pixelList.unshift([Date.now(),e,t])}doRender(){return 0!==this.pixelList.length}updateScale(e){this.scale=e,this.notificationRadius=(0,y.uZ)(10*this.scale,20,400)}render(e,t){const n=t.getContext("2d");if(!n)return;const i=Date.now();let o=this.pixelList.length;for(;o>0;){o--;const[r,s,a]=this.pixelList[o],l=i-r;if(l>ae.NOTIFICATION_TIME){this.pixelList.pop();continue}const[c,u]=(0,y.Cr)(e,t,[s,a]).map((e=>e+this.scale/2)),d=l/ae.NOTIFICATION_TIME*this.notificationRadius/100;n.save(),n.scale(d,d),n.drawImage(this.notifcircle,c/d-100,u/d-100),n.restore()}}}se(ae,"NOTIFICATION_TIME",1100);const le=new ae;function ce(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ue extends V.Z{constructor(e){super(e),ce(this,"is3D",!1),ce(this,"canvasId",null),ce(this,"centerChunk",void 0),ce(this,"tiledScale",void 0),ce(this,"tiledZoom",void 0),ce(this,"hover",void 0),ce(this,"viewport",null),ce(this,"forceNextRender",void 0),ce(this,"forceNextSubrender",void 0),ce(this,"canvas",void 0),ce(this,"lastFetch",void 0),ce(this,"oldHistoricalTime",void 0),this.centerChunk=[null,null],this.tiledScale=0,this.tiledZoom=4,this.canvasMaxTiledZoom=0,this.historicalCanvasMaxTiledZoom=0,this.hover=!1,this.scaleThreshold=1,this.forceNextRender=!0,this.forceNextSubrender=!0,this.lastFetch=0,this.oldHistoricalTime=null;const t=document.createElement("canvas");t.className="viewport",this.viewport=t,this.canvas=document.createElement("canvas"),this.onWindowResize(),document.body.appendChild(this.viewport),this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize);const n=this.canvas.getContext("2d");n.fillStyle="#000000",n.fillRect(0,0,this.canvas.width,this.canvas.height);const i=e.getState();this.updateCanvasData(i),this.updateScale(i),this.controls=new j(this,this.viewport,e)}destructor(){this.controls.dispose(),window.removeEventListener("resize",this.onWindowResize),this.viewport.remove(),super.destructor()}getViewport(){return this.viewport}onWindowResize(){this.viewport.width=window.innerWidth,this.viewport.height=window.innerHeight;const e=2*Math.ceil(window.screen.width/2)+b.p7*b.I_,t=2*Math.ceil(window.screen.height/2)+b.p7*b.I_;this.canvas.width===e&&this.canvas.height===t||(console.log(`Noticed screen: ${e} / ${t}`),this.canvas.width=e,this.canvas.height=t,this.scaleThreshold=Math.min(e/b.I_/3,t/b.I_/3)),this.forceNextRender=!0}updateCanvasData(e){const{canvasId:t}=e.canvas;if(t!==this.canvasId&&(this.canvasId=t,null!==t)){const{palette:n,canvasSize:i,canvases:o}=e.canvas;this.canvasMaxTiledZoom=(0,y.W4)(i),this.historicalCanvasMaxTiledZoom=this.canvasMaxTiledZoom,this.chunkLoader=new re(this.store,t,n,i,o[t].historicalSizes)}this.updateScale(e)}updateOldHistoricalTime(e,t){this.oldHistoricalTime="0000"===t?null:t}updateHistoricalTime(e,t,n){this.historicalCanvasMaxTiledZoom=(0,y.W4)(n),this.forceNextRender=!0,this.updateScale(this.store.getState())}getColorIndexOfPixel(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){const n=this.store.getState(),{historicalDate:i,historicalTime:o,historicalCanvasSize:r}=n.canvas;return this.chunkLoader.getHistoricalIndexOfPixel(e,t,i,o,r)}return this.chunkLoader.getColorIndexOfPixel(e,t)}updateScale(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{viewscale:n,isHistoricalView:i}=e.canvas;le.updateScale(n);let o=n>.5?0:Math.round(2*Math.log2(n)/b.p7);o=b.p7**o;const r=(i?this.historicalCanvasMaxTiledZoom:this.canvasMaxTiledZoom)+2*Math.log2(o)/b.p7,s=n/o;this.tiledScale=o,this.tiledZoom=r,this.relScale=s,this.updateView(e),null===t||n<this.scaleThreshold||t<this.scaleThreshold?this.forceNextRender=!0:this.forceNextSubrender=!0}updateView(e){const{view:t}=e.canvas,n=e.canvas.isHistoricalView?e.canvas.historicalCanvasSize:e.canvas.canvasSize,[i,o]=t;let[r,s]=this.centerChunk;const[a,l]=(0,y.HD)(this.tiledScale,[i,o],n);r!==a||s!==l?(r=a,s=l,this.centerChunk=[r,s],this.forceNextRender=!0):this.forceNextSubrender=!0}renderPixel(e,t,n,i,o){const r=this.store.getState(),{canvasSize:s,palette:a,scale:l,isHistoricalView:c}=r.canvas;if(this.chunkLoader.getPixelUpdate(e,t,n,i),l<.8||c)return;const u=l>this.scaleThreshold?1:l,d=this.canvas.getContext("2d");if(!d)return;const[h,f]=(0,y._O)(e,t,n,s),[v,p]=this.centerChunk.map((e=>(e+.5)*b.I_-s/2)),{width:m,height:g}=this.canvas,w=(h-v)*u+m/2,S=(f-p)*u+g/2;w<0||w>=m||S<0||S>=g||(d.fillStyle=a.colors[i],d.fillRect(w,S,u,u),o&&le.addPixel(h,f),this.forceNextSubrender=!0)}isChunkInView(e,t,n){const{tiledZoom:i}=this;if(e>i+1)return!1;let[o,r]=this.centerChunk,{relScale:s}=this;if(e!==i){const t=b.p7**(e-i);o=Math.floor(o*t),r=Math.floor(r*t),s*=t}const{width:a,height:l}=this.viewport,c=Math.ceil(a/b.I_/2/s),u=Math.ceil(l/b.I_/2/s);return Math.abs(t-o)<=c&&Math.abs(n-r)<=u}renderChunks(e){const t=this.canvas.getContext("2d");if(!t)return;const{centerChunk:n,tiledScale:i,tiledZoom:o,viewport:r}=this,{viewscale:s,canvasSize:a}=e.canvas;let{relScale:l}=this;s>=1?(t.msImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1):(t.msImageSmoothingEnabled=!0,t.webkitImageSmoothingEnabled=!0,t.imageSmoothingEnabled=!0);const{width:c,height:u}=r,d=Math.ceil(c/b.I_/2/l),h=Math.ceil(u/b.I_/2/l);s>this.scaleThreshold&&(l=1),t.save(),t.fillStyle="#C4C4C4",t.scale(l,l);const f=Date.now();let v=!1;f>this.lastFetch+150&&(this.lastFetch=f,v=!0);const p=this.canvas.width/2/l-b.I_/2,m=this.canvas.height/2/l-b.I_/2,[g,w]=n;let y;for(let e=-d;e<=d;e+=1)for(let n=-h;n<=h;n+=1){const r=g+e,s=w+n,l=p+e*b.I_,c=m+n*b.I_,u=a/b.I_;r<0||r>=u*i||s<0||s>=u*i?t.fillRect(l,c,b.I_,b.I_):(y=this.chunkLoader.getChunk(o,r,s),y?(t.drawImage(y,l,c),v&&(y.timestamp=f)):t.fillRect(l,c,b.I_,b.I_))}t.restore()}render(){if(!this.chunkLoader)return;const e=this.store.getState();e.canvas.isHistoricalView?this.renderHistorical(e):this.renderMain(e)}renderMain(e){const{viewport:t}=this,{showGrid:n,showPixelNotify:i,isPotato:o,isLightGrid:r}=e.gui,{fetchingPixel:s}=e.fetching,{view:a,viewscale:l,canvasSize:c,hover:u}=e.canvas,[d,h]=a,[f,v]=this.centerChunk,p=l>=.5&&i&&le.doRender(),m=l>=3&&!s&&(u||this.hover)&&!o,g=l>=3&&!s&&(u!==this.hover||this.forceNextRender||this.forceNextSubrender||p)&&o;if(!(this.forceNextRender||m||g||p||this.forceNextSubrender))return;this.hover=u,this.forceNextRender&&this.renderChunks(e),this.forceNextRender=!1,this.forceNextSubrender=!1;const{width:w,height:S}=t,k=t.getContext("2d");if(!k)return;k.msImageSmoothingEnabled=!1,k.webkitImageSmoothingEnabled=!1,k.imageSmoothingEnabled=!1;const C=c/2;l>this.scaleThreshold?(k.save(),k.scale(l,l),k.drawImage(this.canvas,w/2/l-this.canvas.width/2+((f+.5)*b.I_-C-d),S/2/l-this.canvas.height/2+((v+.5)*b.I_-C-h)),k.restore()):k.drawImage(this.canvas,Math.floor(w/2-this.canvas.width/2+((f+.5)*b.I_/this.tiledScale-C-d)*l),Math.floor(S/2-this.canvas.height/2+((v+.5)*b.I_/this.tiledScale-C-h)*l)),n&&l>=8&&K(e,t,l,r),p&&le.render(e,t),u&&m&&function(e,t,n){const i=t.getContext("2d"),{hover:o}=e.canvas,{palette:r,selectedColor:s}=e.canvas,[a,l]=(0,y.Cr)(e,t,o);i.save(),i.translate(a+n/2,l+n/2);const c=Math.sin(Date.now()/250)/4;i.rotate(c),i.fillStyle="#000",i.fillRect(-.6*n-1,-.6*n-1,n*Z+2,n*Z+2),i.fillStyle=r.colors[s],i.fillRect(.6*-n,.6*-n,n*Z,n*Z),i.restore()}(e,t,l),u&&g&&function(e,t,n){const i=t.getContext("2d"),{hover:o}=e.canvas,{palette:r,selectedColor:s}=e.canvas,[a,l]=(0,y.Cr)(e,t,o);i.save(),i.fillStyle="#000",i.fillRect(a-1,l-1,4,n+2),i.fillRect(a-1,l-1,n+2,4),i.fillRect(a+n-2,l-1,4,n+2),i.fillRect(a-1,l+n-2,n+1,4),i.fillStyle=r.colors[s],i.fillRect(a,l,2,n),i.fillRect(a,l,n,2),i.fillRect(a+n-1,l,2,n),i.fillRect(a,l+n-1,n,2),i.restore()}(e,t,l)}renderHistoricalChunks(e){const t=this.canvas.getContext("2d");if(!t)return;const{centerChunk:n,viewport:i,oldHistoricalTime:o}=this,{viewscale:r,historicalDate:s,historicalTime:a,historicalCanvasSize:l}=e.canvas;r>=1?(t.msImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1):(t.msImageSmoothingEnabled=!0,t.webkitImageSmoothingEnabled=!0,t.imageSmoothingEnabled=!0);const c=r>this.scaleThreshold?1:r,{width:u,height:d}=i,h=Math.ceil(u/b.I_/2/c),f=Math.ceil(d/b.I_/2/c);if(t.save(),t.fillStyle="#C4C4C4",!s||!a)return t.fillRect(0,0,this.canvas.width,this.canvas.height),void t.restore();t.scale(c,c);const v=Date.now();let p=!1;v>this.lastFetch+150&&(this.lastFetch=v,p=!0);const m=this.canvas.width/2/c-b.I_/2,g=this.canvas.height/2/c-b.I_/2,[w,y]=n;let S;for(let e=-h;e<=h;e+=1)for(let n=-f;n<=f;n+=1){const i=w+e,r=y+n,c=m+e*b.I_,u=g+n*b.I_,d=l/b.I_;if(i<0||i>=d||r<0||r>=d)t.fillRect(c,u,b.I_,b.I_);else{if(S=this.chunkLoader.getHistoricalChunk(i,r,!0,s),S?(t.drawImage(S,c,u),p&&(S.timestamp=v)):t.fillRect(c,u,b.I_,b.I_),"0000"===a)continue;S=this.chunkLoader.getHistoricalChunk(i,r,!0,s,a),S?S.isEmpty||(t.drawImage(S,c,u),p&&(S.timestamp=v)):o&&(S=this.chunkLoader.getHistoricalChunk(i,r,!1,s,o),S&&!S.isEmpty&&(t.drawImage(S,c,u),p&&(S.timestamp=v)))}}t.restore()}renderHistorical(e){const{viewport:t}=this,{showGrid:n,isLightGrid:i}=e.gui,{view:o,viewscale:r,historicalCanvasSize:s}=e.canvas,[a,l]=o,[c,u]=this.centerChunk;if(!this.forceNextRender&&!this.forceNextSubrender)return;this.forceNextRender&&this.renderHistoricalChunks(e),this.forceNextRender=!1,this.forceNextSubrender=!1;const{width:d,height:h}=t,f=t.getContext("2d");if(!f)return;f.msImageSmoothingEnabled=!1,f.webkitImageSmoothingEnabled=!1,f.imageSmoothingEnabled=!1;const v=s/2;r>this.scaleThreshold?(f.save(),f.scale(r,r),f.drawImage(this.canvas,d/2/r-this.canvas.width/2+((c+.5)*b.I_-v-a),h/2/r-this.canvas.height/2+((u+.5)*b.I_-v-l)),f.restore()):f.drawImage(this.canvas,Math.floor(d/2-this.canvas.width/2+((c+.5)*b.I_-v-a)*r),Math.floor(h/2-this.canvas.height/2+((u+.5)*b.I_-v-l)*r)),n&&r>=8&&K(e,t,r,i)}}const de=ue,he=new V.Z;let fe=he;async function ve(e,t){if(fe.destructor(),t)if((0,y.b3)()){const t=(await Promise.all([n.e(841),n.e(882)]).then(n.bind(n,5418))).default;fe=new t(e)}else e.dispatch((0,r.UI)("Leinwand Fehler","Kann die 3D Leinwand nicht laden. Ist WebGL2 im Browser deaktiviert?","error","OK")),fe=he;else fe=new de(e);return fe}function pe(){return fe}!function e(){fe.render(),window.requestAnimationFrame(e)}();const me="PixelPlanet.fun";let ge=null;const we=new class{constructor(){this.wins=[],this.origin=window.location.origin,window.addEventListener("beforeunload",(()=>{this.dispatch((0,r.Rz)())}))}add(e){-1===this.wins.indexOf(e)&&this.wins.push(e)}remove(e){const t=this.wins.indexOf(e);~t&&this.wins.splice(t,1)}dispatch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{wins:n}=this;try{for(let i=0;i<n.length;i+=1){const o=n[i];o.closed?(n.splice(i,1),i-=1):o!==t&&o.postMessage(e,this.origin)}}catch{return!1}return!0}closeAll(){for(;this.wins.length;)this.wins.pop().close()}};var ye=n(7187);const be=new(n.n(ye)());window.pixelPlanetEvents=be;const Se=(0,i.OJ)({key:"wind",storage:d.Z,version:15,migrate:x},(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_WIN":{const{windowType:n,title:i,cloneable:o,args:r,xPos:s,yPos:a,width:l,height:c}=t,[u,d]=P(l,c,!0),[h,f]=O(s,a,u,d),v=!e.showWindows||t.fullscreen;if(e.windows.length>=100)return e;const p=A(e),m=e.zMax+1;return R({...e,zMax:m,windows:[...e.windows,{windowId:p,windowType:n,open:!0,hidden:!1,fullscreen:v,title:i,cloneable:o}],args:{...e.args,[p]:{...r}},positions:{...e.positions,[p]:{width:u,height:d,xPos:h,yPos:f,z:m}}})}case"REMOVE_WIN":{const{windowId:n}=t,i={...e.args},o={...e.positions};return delete i[n],delete o[n],{...e,windows:e.windows.filter((e=>e.windowId!==n)),args:i,positions:o}}case"CLOSE_WIN":{const{windowId:n}=t,i=e.windows.map((e=>e.windowId!==n?e:{...e,open:!1}));return{...e,windows:i}}case"CLOSE_ALL_WIN_TYPE":{const{windowType:n}=t,i=e.windows.map((e=>e.windowType!==n?e:{...e,open:!1}));return{...e,windows:i}}case"HIDE_ALL_WIN_TYPE":{const{windowType:n,hide:i}=t,o=e.windows.map((e=>e.windowType!==n?e:{...e,hidden:i}));return{...e,windows:o}}case"CLONE_WIN":{const{windowId:n}=t,i=e.windows.find((e=>e.windowId===n)),o=e.positions[n],r=A(e),s=e.zMax+1,{innerWidth:a,innerHeight:l}=window;return R({...e,zMax:s,windows:[...e.windows,{...i,windowId:r}],args:{...e.args,[r]:{...e.args[n]}},positions:{...e.positions,[r]:{...o,xPos:Math.min(o.xPos+15,a-_),yPos:Math.min(o.yPos+15,l-N),z:s}}})}case"CHANGE_WIN_TYPE":{const{windowId:n,windowType:i,title:o}=t,r={...e.args,[n]:{...t.args}},s=e.windows.map((e=>e.windowId!==n?e:{...e,windowType:i,title:o}));return{...e,args:r,windows:s}}case"FOCUS_WIN":{const{windowId:n}=t,{zMax:i}=e,{z:o}=e.positions[n];return o===i?e:R({...e,zMax:i+1,positions:{...e.positions,[n]:{...e.positions[n],z:i+1}}})}case"TGL_MAXIMIZE_WIN":{const{windowId:n}=t,i=e.windows.map((e=>e.windowId!==n?e:{...e,fullscreen:!e.fullscreen,open:!0,hidden:!1}));return{...e,windows:i}}case"CLOSE_FULLSCREEN_WINS":{const t=e.windows.map((e=>e.fullscreen?{...e,open:!1}:e));return{...e,windows:t}}case"MOVE_WIN":{const{windowId:n,xDiff:i,yDiff:o}=t;let{xPos:r,yPos:s}=e.positions[n];const{width:a,height:l}=e.positions[n];return[r,s]=O(r+i,s+o,a,l),{...e,positions:{...e.positions,[n]:{...e.positions[n],xPos:r,yPos:s}}}}case"RESIZE_WIN":{const{windowId:n,xDiff:i,yDiff:o}=t;let{width:r,height:s}=e.positions[n];return[r,s]=P(r+i,s+o,!1),{...e,positions:{...e.positions,[n]:{...e.positions[n],width:r,height:s}}}}case"persist/REHYDRATE":{const{showWindows:n}=e;if(!n||"wind"!==t.key)return e;const i={...e,...t.payload},o={...i.args},r={...i.positions},s=i.windows.filter((e=>!(!e.open||!e.fullscreen&&!n)||(console.log(`Cleaning up window from previous session: ${e.windowId}`),delete o[e.windowId],delete r[e.windowId],!1)));return R(L({...i,windows:s,args:o,positions:r}))}case"WIN_RESIZE":{const t=window.innerWidth>604;return t?L(t===e.showWindows?e:{...e,showWindows:t}):{...e,showWindows:t}}case"SET_WIN_TITLE":{const{windowId:n,title:i}=t,o=e.windows.map((e=>e.windowId!==n?e:{...e,title:i}));return{...e,windows:o}}case"SET_WIN_ARGS":{const{windowId:n,args:i}=t;return{...e,args:{...e.args,[n]:{...e.args[n],...i}}}}default:return e}})),ke=(0,c.UY)({...I,windows:Se,alert:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ALERT":{const{title:n,message:i,alertType:o,btn:r}=t;return{...e,open:!0,title:n,message:i,alertType:o,btn:r}}case"CLOSE_ALERT":return{...e,open:!1};default:return e}}}),Ce=(0,c.MT)(ke,(0,c.md)(u.Z,(()=>e=>t=>Array.isArray(t)?t.map(e):e(t)),(e=>t=>n=>{if(n instanceof MessageEvent){if(n.origin!==window.location.origin||!n.data.type)return null;if("t/UNLOAD"===n.data.type)console.log("popup closed"),we.remove(n.source);else if("t/LOAD"===n.data.type){const t=e.getState();n.source.postMessage((0,r.GY)(t),window.location.origin),we.add(n.source),console.log("popup added")}else n.data.type.startsWith("s/")&&we.dispatch(n.data,n.source);return t(n.data)}return we.wins.length&&n.type&&n.type.startsWith("s/")&&we.dispatch(n),t(n)}),(e=>t=>n=>{const i=e.getState(),{mute:o,chatNotify:r}=i.gui;if(!o&&z)switch(n.type){case"SELECT_COLOR":{const e=z.createOscillator(),t=z.createGain(),{currentTime:n}=z;e.type="sine",e.detune.value=-600,e.frequency.setValueAtTime(600,n),e.frequency.setValueAtTime(700,n+.1),t.gain.setValueAtTime(.3,n),t.gain.exponentialRampToValueAtTime(.2,n+.1),e.connect(t),t.connect(z.destination),e.start(),e.stop(n+.2);break}case"SET_NOTIFICATION":{const{notification:e}=n;if("string"!=typeof e)break;const t=z.createOscillator(),i=z.createGain(),{currentTime:o}=z;t.type="sine",t.detune.value=-1200,t.frequency.setValueAtTime(500,o),t.frequency.setValueAtTime(600,o+.1),i.gain.setValueAtTime(.3,o),i.gain.exponentialRampToValueAtTime(.2,o+.1),t.connect(i),i.connect(z.destination),t.start(),t.stop(o+.2);break}case"ALERT":{const e=z.createOscillator(),t=z.createGain(),{currentTime:i}=z;if("captcha"===n.alertType)e.type="sine",e.detune.value=-600,e.start(i),e.frequency.setValueAtTime(1479.98,i),e.frequency.exponentialRampToValueAtTime(493.88,i+.01),e.stop(i+.1),t.gain.setValueAtTime(.5,i),t.gain.setTargetAtTime(0,i,.1),e.connect(t),t.connect(z.destination);else{e.type="sine",e.detune.value=-900,e.start(i),e.frequency.setValueAtTime(600,i),e.frequency.setValueAtTime(1400,i+.025),e.frequency.setValueAtTime(1200,i+.05),e.frequency.setValueAtTime(900,i+.075),e.stop(i+.3);const n=z.createOscillator();n.type="sine",n.start(i),n.frequency.setValueAtTime(2,i),n.stop(i+.3),n.connect(t),t.gain.setValueAtTime(1,i),t.gain.setTargetAtTime(0,i,3),e.connect(t),t.connect(z.destination)}break}case"REC_SET_PXLS":switch(n.retCode){case 0:{const{palette:e,selectedColor:t}=i.canvas,n=e.colors.length,o=100+300*Math.log(t/n+1),r=z.createOscillator(),s=z.createGain(),{currentTime:a}=z;r.type="sine",r.start(a),r.frequency.setValueAtTime(o,a),r.frequency.exponentialRampToValueAtTime(1400,a+.2),r.stop(a+.1),s.gain.setValueAtTime(.5,a),s.gain.setTargetAtTime(0,a,.1),r.connect(s),s.connect(z.destination);break}case 9:{const e=z.createOscillator(),t=z.createGain(),{currentTime:n}=z;e.type="sine",e.start(n),e.frequency.setValueAtTime(1479.98,n),e.frequency.exponentialRampToValueAtTime(493.88,n+.01),e.stop(n+.1),t.gain.setValueAtTime(.5,n),t.gain.setTargetAtTime(0,n,.1),e.connect(t),t.connect(z.destination);break}}break;case"COOLDOWN_END":{const{lastCoolDownEnd:e}=i.user;if(e&&e+5e3>Date.now())break;const t=z.createOscillator(),n=z.createGain(),{currentTime:o}=z;t.type="sine",t.frequency.setValueAtTime(349.23,o),t.frequency.setValueAtTime(523.25,o+.1),t.frequency.setValueAtTime(698.46,o+.2),n.gain.setValueAtTime(.5,o),n.gain.exponentialRampToValueAtTime(.2,o+.15),t.connect(n),n.connect(z.destination),t.start(),t.stop(o+.3);break}case"s/REC_CHAT_MESSAGE":{if(r)break;const{isPing:e,channel:t}=n,{mute:o,chatChannel:s}=i.chatRead;if(o.includes(t)||o.includes(`${t}`))break;const{channels:a}=i.chat,l=z.createOscillator(),c=z.createGain(),{currentTime:u}=z;l.type="sine",l.frequency.setValueAtTime(310,u);const d=e||a[t]&&1===a[t][1]&&t!=s?540:355;l.frequency.exponentialRampToValueAtTime(d,u+.025),c.gain.setValueAtTime(.1,u),c.gain.exponentialRampToValueAtTime(.1,u+.1),l.connect(c),c.connect(z.destination),l.start(),l.stop(u+.075);break}}return t(n)}),(e=>t=>n=>{try{if(!document.hasFocus())switch(n.type){case"s/REC_ME":window.Notification&&"granted"!==Notification.permission&&"denied"!==Notification.permission&&Notification.requestPermission();break;case"COOLDOWN_END":{const t=e.getState(),{lastCoolDownEnd:n}=t.user;if(n&&n+15e3>Date.now())break;window.Notification&&"granted"===Notification.permission&&new Notification("Your next pixels are ready",{icon:"/tile.png",silent:!1,vibrate:[200,100],body:"You can now place more on pixelplanet.fun :)"});break}case"s/REC_CHAT_MESSAGE":{const t=e.getState(),{chatNotify:i}=t.gui;if(!i)break;const{isPing:o}=n;if(!o)break;const{name:r}=n;window.Notification&&"granted"===Notification.permission&&new Notification(`${r} mentioned you`,{icon:"/tile.png",silent:!1,vibrate:[200,100],body:"You have new messages in chat"});break}}}catch(e){console.error(e)}return t(n)}),(e=>t=>n=>{const i=t(n);switch(n.type){case"COOLDOWN_SET":{const{coolDown:t}=e.getState().user,n=`${(0,y.VL)(t,!0)} | ${me}`;if(ge===n)break;ge=n,document.title=n;break}case"COOLDOWN_END":document.title=me;break;case"s/SELECT_CANVAS":case"s/REC_ME":case"RELOAD_URL":case"ON_VIEW_FINISH_CHANGE":{const t=e.getState(),{view:i,viewscale:o,canvasIdent:r,is3D:s}=t.canvas;if("ON_VIEW_FINISH_CHANGE"!==n.type){const[e,n,i]=t.canvas.palette.rgb;!function(e,t,n){const i=document.querySelector("meta[name=theme-color]");i&&i.setAttribute("content",`rgb(${e}, ${t}, ${n})`)}(e,n,i)}let a=`#${r},${i.map((e=>Math.round(e))).join(",")}`;s||(a+=`,${Math.round(10*Math.log2(o))}`),window.history.replaceState(void 0,void 0,a);break}}return i}),(e=>t=>n=>{switch(n.type){case"REC_BIG_CHUNK":case"REC_BIG_CHUNK_FAILURE":{const{chunk:e}=n;e.recUpdates&&F.registerChunk(n.chunk.id);break}case"REMOVE_CHUNKS":{const{chunks:e}=n,t=e.filter((e=>e.recUpdates)).map((e=>e.id));t.length&&F.deRegisterChunks(t);break}case"s/SET_NAME":case"s/LOGIN":case"s/LOGOUT":F.reconnect();break;case"s/REQ_CHAT_MESSAGE":{const{text:e,channel:t}=n;F.sendChatMessage(e,t);break}case"RELOAD_URL":case"s/SELECT_CANVAS":case"s/REC_ME":{const i=e.getState(),o=t(n),r=e.getState(),{canvasId:s}=r.canvas;return i.canvas.canvasId!==s&&F.setCanvas(s),o}}return t(n)}),(e=>t=>n=>{const{type:i}=n;let o=null;switch(i){case"SET_SCALE":o=e.getState().canvas.viewscale;break;case"SET_HISTORICAL_TIME":{const t=e.getState(),n=pe(),{historicalDate:i,historicalTime:o}=t.canvas;n.updateOldHistoricalTime(i,o);break}}const r=t(n),s=e.getState();switch(i){case"RELOAD_URL":case"s/SELECT_CANVAS":case"s/REC_ME":{const t=pe(),{is3D:n}=s.canvas;n===t.is3D?t.updateCanvasData(s):ve(e,n);break}case"s/TGL_HIDDEN_CANVASES":{const t=pe(),{is3D:n}=s.canvas;n&&ve(e,!t.is3D);break}case"SET_HISTORICAL_TIME":{const{historicalDate:e,historicalTime:t,historicalCanvasSize:n}=s.canvas;pe().updateHistoricalTime(e,t,n);break}case"REQ_BIG_CHUNK":case"PRE_LOADED_BIG_CHUNK":case"REC_BIG_CHUNK":case"REC_BIG_CHUNK_FAILURE":pe().forceNextRender=!0;break;case"s/TGL_GRID":case"ALLOW_SETTING_PXL":pe().forceNextSubrender=!0;break;case"s/TGL_HISTORICAL_VIEW":case"SET_SCALE":pe().updateScale(s,o);break;case"SET_VIEW_COORDINATES":pe().updateView(s);break;case"REC_SET_PXLS":{const e=pe();e.forceNextSubrender=!0;const{coolDownSeconds:t}=n;t<0&&e&&e.controls&&e.controls.gotCoolDownDelta&&e.controls.gotCoolDownDelta(-1*t);break}}return r}),(()=>e=>t=>{switch(t.type){case"s/SELECT_CANVAS":be.emit("selectcanvas",t.canvasId);break;case"SET_VIEW_COORDINATES":be.emit("setviewcoordinates",t.view);break;case"SET_HOVER":be.emit("sethover",t.hover);break;case"SET_SCALE":{const{scale:e,zoompoint:n}=t;be.emit("setscale",e,n);break}case"REC_BIG_CHUNK":be.emit("receivechunk",t.chunk)}return e(t)}))),Ee=Ce;var Te,xe=n(7294),Ie=n(743),Ne=n(745),_e=n(7479);function Ae(e,t,n,i){Te||(Te="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Te,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Pe(){let e=(0,Ie.v9)((e=>e.gui.style));if(!window.ssv.availableStyles)return null;const t=new Date,n=t.getMonth()+1,i=t.getDate();(31===i&&10===n||1===i&&11===n)&&(e="dark-spooky");const o=window.ssv.availableStyles[e];return"default"!==e&&o?Ae("link",{rel:"stylesheet",type:"text/css",href:o}):null}const Oe=xe.memo(Pe);var Le;function Re(e,t,n,i){Le||(Le="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Le,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const De=()=>{const e=(0,Ie.v9)((e=>e.canvas.view)),t=(0,Ie.v9)((e=>e.canvas.hover)),n=(0,Ie.I0)();return Re("div",{className:"coorbox",onClick:()=>{(0,o.Z)(window.location.hash),n((0,s.h4)("Kopiert!"))},role:"button",title:"Kopiere in die Zwischenablage",tabIndex:"0"},void 0,`(${(t||e.map(Math.round)).join(", ")})`)},$e=xe.memo(De);var Me=n(9583);const ze={USERAREA:["activeTab"],CHAT:["chatChannel"]},He=["HELP","SETTINGS","USERAREA","CHAT","CANVAS_SELECTION","ARCHIVE","REGISTER","FORGOT_PASSWORD"];function We(){const e=window.location.pathname.split("/")[1];return e&&He.includes(e.toUpperCase())}function Ue(e,t){const n={...t};let i=`/${e.toLowerCase()}`;const o=ze[e];if(o)for(let e=0;e<o.length;e+=1){const t=o[e];n[t]&&(i+=`/${encodeURIComponent(n[t])}`,delete n[t])}let r=new URLSearchParams;const s=Object.keys(n);for(let e=0;e<s.length;e+=1){const t=s[e];r.append(t,n[t])}return r=r.toString(),r&&(i+=`?${r}`),i}const Ge=He;function Fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return{type:"OPEN_WIN",windowType:e,title:t,args:n,fullscreen:i,cloneable:o,xPos:r,yPos:s,width:a,height:l}}function Ve(e,t){return{type:"HIDE_ALL_WIN_TYPE",windowType:e,hide:t}}const Ze=(0,xe.createContext)();function Ke(e,t,n,i,o,r){!function(e,t,n,i,o){let r,s;try{if(window.innerWidth<=604?(i=window.innerWidth,o=window.innerHeight,r=window.top.screenX,s=window.top.screenY):(r=Math.round(window.top.screenX+t),s=Math.round(window.top.screenY+n)),Number.isNaN(r)||Number.isNaN(s))throw new Error("NaN")}catch{r=0,s=0}try{window.open(e,e,`popup=yes,width=${i},height=${o},left=${r},top=${s},toolbar=no,status=no,directories=no,menubar=no`)}catch{return null}}(Ue(e,t),n,i,o,r)}const Be=function(){const e=(0,Ie.I0)(),t=(0,xe.useContext)(Ze);return(0,xe.useCallback)((function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{xPos:o=null,yPos:r=null,width:s=null,height:a=null,args:l=null}=i;if("popup"===i.target)return void Ke(n,l,o,r,s,a);const{title:c=""}=i,u=!We();if("blank"===i.target&&u){const{cloneable:t=!0}=i;e(Fe(n.toUpperCase(),c,l,!1,t,o,r,s,a))}else if("fullscreen"===i.target&&u){const{cloneable:t=!0}=i;e(Fe(n.toUpperCase(),c,l,!0,t,o,r,s,a))}else t?t.changeType(n,c,l):window.location.href=Ue(n,l)}),[t])};var je,qe;function Ye(e,t,n,i){qe||(qe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:qe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xe=()=>{const e=Be();return Ye("div",{id:"canvasbutton",className:"actionbuttons",onClick:()=>e("CANVAS_SELECTION",{target:"fullscreen"}),role:"button",title:"Leinwand auswahl",tabIndex:-1},void 0,je||(je=Ye(Me.n6C,{})))},Qe=xe.memo(Xe);var Je,et,tt,nt,it;function ot(e,t,n,i){it||(it="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:it,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rt=()=>{const[e,t,n,i,o]=(0,Ie.v9)((e=>[e.ranks.online,e.ranks.totalPixels,e.user.name,e.gui.onlineCanvas,e.canvas.canvasId]),Ie.wU),s=(0,Ie.I0)();return ot("div",{className:"onlinebox",role:"button",tabIndex:"0",onClick:()=>s((0,r._)())},void 0,i?ot("span",{title:"Spieler auf dieser Leinwand"},void 0,e[o]||0,Je||(Je=ot(Me.Xws,{})),et||(et=ot(Me.n6C,{}))):ot("span",{title:"Spieler insgesamt"},void 0,e.total,tt||(tt=ot(Me.Xws,{})))," ",null!=n&&ot("span",{title:"Pixels gesetzt"},void 0,(0,y.D$)(t)," ",nt||(nt=ot(Me._TT,{}))))},st=xe.memo(rt);var at,lt,ct=n(5434);function ut(e,t,n,i){lt||(lt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:lt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dt=e=>[e.windows.windows.some((t=>"CHAT"===t.windowType&&!1===t.hidden&&(e.windows.showWindows||t.fullscreen))),e.windows.windows.some((e=>"CHAT"===e.windowType&&!0===e.hidden))&&e.windows.showWindows],ht=()=>{const[e,t]=(0,xe.useState)(!1),n=(0,Ie.I0)(),[i,o]=(0,Ie.v9)(dt,Ie.wU),r=(0,Ie.v9)((e=>e.gui.chatNotify)),s=(0,Ie.v9)((e=>e.chat.channels)),[a,l]=(0,Ie.v9)((e=>[e.chatRead.unread,e.chatRead.mute]),Ie.wU);return(0,xe.useEffect)((()=>{if(!r||i)return void t(!1);const e=Object.keys(s);let n=0;for(;n<e.length;){const i=e[n];if(0!==s[i][1]&&a[i]&&!l.includes(i)){t(!0);break}n+=1}n===e.length&&t(!1)})),ut("div",{id:"chatbutton",className:"actionbuttons",onClick:()=>{n(i?Ve("CHAT",!0):o?Ve("CHAT",!1):Fe("CHAT","",null,!1,!0,window.innerWidth-350-62,window.innerHeight-350-64,350,350))},role:"button",title:i?"Schließe Chat":"Öffne Chat",tabIndex:0},void 0,e&&ut("div",{style:{position:"fixed",bottom:27,right:62,top:"unset"},className:"chnunread"},void 0,"⦿"),at||(at=ut(ct.Rlc,{})))},ft=xe.memo(ht);var vt,pt;function mt(e,t,n,i){pt||(pt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:pt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gt=()=>{const e=Be();return mt("div",{id:"helpbutton",className:"actionbuttons",onClick:()=>e("HELP",{target:"fullscreen"}),role:"button",title:"Hilfe",tabIndex:-1},void 0,vt||(vt=mt(Me.g_g,{})))},wt=xe.memo(gt);var yt,bt;function St(e,t,n,i){bt||(bt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:bt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kt=()=>{const e=Be();return St("div",{id:"settingsbutton",className:"actionbuttons",onClick:()=>e("SETTINGS",{target:"fullscreen"}),role:"button",title:"Einstellungen",tabIndex:-1},void 0,yt||(yt=St(Me.p4t,{})))},Ct=xe.memo(kt);var Et,Tt;function xt(e,t,n,i){Tt||(Tt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Tt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const It=()=>{const e=Be();return xt("div",{id:"loginbutton",className:"actionbuttons",onClick:()=>e("USERAREA",{target:"fullscreen"}),role:"button",title:"Spielerbereich",tabIndex:-1},void 0,Et||(Et=xt(ct.Vyx,{})))},Nt=xe.memo(It);var _t,At,Pt=n(5823),Ot=n.n(Pt);function Lt(e,t,n,i){At||(At="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:At,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Rt=()=>{const e=(0,Ie.v9)((e=>e.canvas.view));return Lt("div",{id:"downloadbutton",className:"actionbuttons",role:"button",title:"Erstelle eine Bildschirmaufnahme",tabIndex:0,onClick:()=>function(e){const t=pe().getViewport();if(!t)return;const[n,i]=e.map(Math.round),o=`pixelplanet-${n}-${i}.png`;t.toBlob((e=>Ot()(e,o)))}(e)},void 0,_t||(_t=Lt(ct.tEr,{})))},Dt=xe.memo(Rt);var $t,Mt,zt,Ht,Wt;function Ut(e,t,n,i){Wt||(Wt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Wt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Gt=()=>{const[e,t]=(0,xe.useState)(!1),n=(0,Ie.v9)((e=>e.gui.menuOpen));return(0,xe.useEffect)((()=>{n&&setTimeout((()=>t(!0)),10)}),[n]),(e||n)&&Ut("div",{className:n&&e?"menu show":"menu",onTransitionEnd:()=>{n||t(!1)}},void 0,$t||($t=Ut(Ct,{})),Mt||(Mt=Ut(Nt,{})),zt||(zt=Ut(Dt,{})),Ht||(Ht=Ut(wt,{})))},Ft=xe.memo(Gt);var Vt;function Zt(e,t,n,i){Vt||(Vt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Vt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Kt=()=>{const e=(0,Ie.v9)((e=>e.user.coolDown));return Zt("div",{className:e&&e>=300?"cooldownbox show":"cooldownbox"},void 0,e&&(0,y.VL)(e,!0))},Bt=xe.memo(Kt);var jt;function qt(e,t,n,i){jt||(jt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:jt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Yt=()=>{const[e,t]=(0,xe.useState)("notifybox"),n=(0,Ie.v9)((e=>e.user.notification));return(0,xe.useEffect)((()=>{if(n){let i="notifybox";n&&"string"!=typeof n&&(i+=n>0?" green":" red"),i!==e&&t(i)}}),[n]),qt("div",{className:n?`${e} show`:e},void 0,n)},Xt=xe.memo(Yt);var Qt,Jt;function en(e,t,n,i){Jt||(Jt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Jt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tn=()=>{const[e,t,n,i]=(0,Ie.v9)((e=>[e.canvas.canvasId,e.canvas.canvasIdent,e.canvas.canvasSize,e.canvas.view]),Ie.wU);return en("div",{role:"button",tabIndex:-1,id:"globebutton",title:"Globus Ansicht",className:"actionbuttons",onClick:()=>function(e,t,n,i){const[o,r]=i.map(Math.round);window.location.href=`globe#${t},${e},${n},${o},${r}`}(e,t,n,i)},void 0,Qt||(Qt=en(ct.gb5,{})))},nn=xe.memo(tn);var on,rn;function sn(e,t,n,i){rn||(rn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:rn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const an=()=>{const e=(0,Ie.v9)((e=>e.gui.paletteOpen)),[t,n]=(0,Ie.v9)((e=>[e.canvas.palette,e.canvas.selectedColor]),Ie.wU),i=(0,Ie.I0)();return sn("div",{id:"palselbutton",className:"actionbuttons "+(e?"":"pressed"),style:{color:t.isDark(n)?"white":"black",backgroundColor:t.colors[n]},role:"button",title:e?"Schließe Palette":"Öffne Palette",tabIndex:0,onClick:()=>i((0,r.KB)())},void 0,on||(on=sn(ct.Zox,{})))},ln=xe.memo(an);var cn;function un(e,t,n,i){cn||(cn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:cn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dn=()=>{const[e,t]=(0,xe.useState)(!1),[n,i,o,s,a,l]=(0,Ie.v9)((e=>[e.gui.paletteOpen,e.gui.compactPalette,e.canvas.palette.colors,e.canvas.clrIgnore,e.canvas.selectedColor,e.user.userlvl]),Ie.wU),c=(0,Ie.I0)();(0,xe.useEffect)((()=>{window.setTimeout((()=>{n&&t(!0)}),10)}),[n]);const u=0===l?s:0,[d,h]=function(e,t,n,i,o){const{width:r,height:s}=t,a=n.length-i;let l,c,u;r<=300||s<=432?(c=24,u=5,l="row"):a>30||o?(c=28,u=5,l="row"):(c=24,u=s<801?2:1,l="column");const d=Math.ceil(a/u)*c,h=c*u;return e?[{display:"flex",flexWrap:"wrap",textAlign:"center",lineHeight:0,height:d,width:h,flexDirection:l,visibility:"visible"},{display:"block",width:c,height:c,margin:0,padding:0,cursor:"pointer",visibility:"visible"}]:[{display:"flex",flexWrap:"wrap",textAlign:"center",lineHeight:0,height:0,width:h,flexDirection:l,visibility:"hidden"},{display:"block",height:0,width:c,margin:0,padding:0,visibility:"hidden"}]}(e&&n,function(){const[e,t]=(0,xe.useState)({width:window.innerWidth,height:window.innerHeight});return(0,xe.useEffect)((()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}(),o,u,i);return(e||n)&&un("div",{id:"palettebox",style:d,onTransitionEnd:()=>{n||t(!1)}},void 0,o.slice(u).map(((e,t)=>un("span",{style:{backgroundColor:e,...h},role:"button",tabIndex:0,"aria-label":`color ${t+u}`,className:a===t+u?"selected":"unselected",color:e,onClick:()=>c((0,r.Oh)(t+u))},`${e}-${t+u}`))))},hn=xe.memo(dn);var fn,vn,pn=n(155);function mn(e,t,n,i){vn||(vn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:vn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gn={width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},wn=e=>{let{autoload:t,width:n,setLegit:i}=e;const[o,r]=(0,xe.useState)({}),[s,a]=(0,xe.useState)([]),[l,c]=(0,xe.useState)(!1),u=async()=>{l&&c(!1);const e=await async function(){const e=`${U.Fx}/captcha.svg`,t=await fetch(e,{cache:"no-cache"});if(t.ok){const e=t.headers.get("captcha-id"),n=await t.blob();return[URL.createObjectURL(n),e]}return null}();if(!e)return void a(["Konnte Captcha nicht laden"]);const[t,n]=e;r({url:t,id:n})};(0,xe.useEffect)((()=>{t&&u()}),[]);const d=n||100;return xe.createElement(xe.Fragment,null,mn("p",{},void 0,"Gebe die Zeichen aus dem folgenden Bild ein:"," ",mn("span",{style:{fontSize:11}},void 0,"(","Tipp: Groß- und Kleinschreibung wird nicht berücksichtigt; l und I sind dasselbe",")")),s.map((e=>mn("p",{className:"errormessage"},e,mn("span",{},void 0,"Fehler"),": ",e))),mn("div",{style:{width:`${d}%`,paddingTop:`${Math.floor(.6*d)}%`,position:"relative",display:"inline-block",backgroundColor:"#e0e0e0"}},void 0,o.url?mn("img",{style:{...gn,opacity:l?1:0,transition:"100ms"},src:o.url,alt:"CAPTCHA",onLoad:()=>{a([]),c(!0)},onError:()=>{a(["Konnte Captcha nicht laden"])}}):mn("span",{style:gn,role:"button",tabIndex:0,title:"Lade Captcha",className:"modallink",onClick:u,onKeyPress:u},void 0,"Klicke um Captcha zu laden")),mn("p",{},void 0,"Unlesbar? Hier neu laden:"," ",mn("span",{role:"button",tabIndex:-1,title:"Neu laden",className:"modallink",style:{fontSize:28},onClick:u},void 0,fn||(fn=mn(pn.q9I,{})))),mn("input",{name:"captcha",placeholder:"Zeichen eingeben",type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onChange:()=>i&&i(!0),autoFocus:t,style:{width:"6em",fontSize:21,margin:5}}),mn("input",{type:"hidden",name:"captchaid",value:o.id||"0"}))},yn=xe.memo(wn);var bn;function Sn(e,t,n,i){bn||(bn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:bn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kn=e=>{let{close:t}=e;const[n,i]=(0,xe.useState)(null),[o,r]=(0,xe.useState)(!1),[s,a]=(0,xe.useState)(!1),[l,c]=(0,xe.useState)(Date.now());return Sn("form",{onSubmit:async e=>{e.preventDefault();const n=e.target.captcha.value.slice(0,6);if(o||!n)return;s||await(0,U.jK)(2);const a=e.target.captchaid.value;let l;try{switch(r(!0),await F.sendCaptchaSolution(n,a)){case 0:return void t();case 1:l="You took too long, try again.";break;case 2:l="You failed your captcha";break;case 3:l="No or invalid captcha text";break;case 4:l="No captcha id given";break;default:l="Unknown Captcha Error"}}catch(e){l=`${e.message}`}r(!1),c(Date.now()),i(l)}},void 0,n&&Sn("p",{className:"errormessage"},n,Sn("span",{},void 0,"Fehler"),": ",n),Sn(yn,{autoload:!0,setLegit:a},l),Sn("p",{},void 0,Sn("button",{type:"button",onClick:t},void 0,"Abbrechen")," ",Sn("button",{type:"submit"},void 0,o?"...":"Senden")))},Cn=xe.memo(kn);var En,Tn=n(2354);function xn(e,t,n,i){En||(En="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:En,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const In=e=>{let{close:t}=e;const[n,i]=(0,xe.useState)([]),[o,r]=(0,xe.useState)(null),[s,a]=(0,xe.useState)(null),[l,c]=(0,xe.useState)(0),[u,d]=(0,xe.useState)(null),[h,f]=(0,xe.useState)(!1),v=Be(),p=async()=>{if(h)return;f(!0),i([]);const e=await(0,U.Es)();if(f(!1),e.errors)return void i(e.errors);const{sleft:t,mod:n,reason:o}=e;if(t){const e=new Date(Date.now()+1e3*t);c(t),d(e.toLocaleString())}a(n),r(o)};return(0,Tn.Z)((()=>{l>0&&(c(l-1),1===l&&p())}),1e3),xn("div",{style:{userSelect:"text"}},void 0,xn("p",{},void 0,"Du bist verbannt. Wenn du glaubst, dass dies ein Irrtum war, sehe in die ",xn("span",{role:"button",tabIndex:0,className:"modallink",onClick:()=>{v("HELP",{target:"fullscreen"}),t()}},void 0,"Hilfe")," um zu erfahren, wie du Einspruch einlegen kannst."),n.map((e=>xn("p",{className:"errormessage"},e,xn("span",{},void 0,"Fehler"),": ",e))),o&&xn(xe.Fragment,{},"rea",xn("h3",{},void 0,"Grund",":"),xn("p",{},void 0,o)),s&&xn(xe.Fragment,{},"mod",xn("h3",{},void 0,"Vom Moderator",":"),xn("p",{},void 0,s)),l>0&&xn(xe.Fragment,{},"exp",xn("h3",{},void 0,"Dauer",":"),xn("p",{},void 0,"Dein ban dauert bis ",xn("span",{style:{fontWeight:"bold"}},void 0,u)," was noch so lange dauert: ",xn("span",{style:{fontWeight:"bold"}},void 0,(0,y.gx)(l)))),l<0&&xn(xe.Fragment,{},"nb",xn("h3",{},void 0,"Wieder erlaubt",":"),xn("p",{},void 0,"Nun da du diese Nachricht gelesen hast, darfst du wieder spielen.")),xn("p",{},void 0,!o&&xn(xe.Fragment,{},"btnr",xn("button",{type:"button",style:{fontWeight:"bold",animation:"glowing 1300ms infinite"},onClick:p},void 0,h?"...":"Wieso?")," "),xn("button",{type:"submit",onClick:t},void 0,"OK")))},Nn=xe.memo(In);var _n;function An(e,t,n,i){_n||(_n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:_n,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pn=e=>{let{show:t,onClick:n,z:i}=e;const[o,r]=(0,xe.useState)(!1);return(0,xe.useEffect)((()=>{t&&window.setTimeout((()=>{r(!0)}),10)}),[t]),o||t?An("div",{className:t&&o?"overlay show":"overlay",style:i?{zIndex:i}:{},onTransitionEnd:()=>{t||r(!1)},tabIndex:-1,onClick:n}):null},On=xe.memo(Pn);var Ln;function Rn(e,t,n,i){Ln||(Ln="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Ln,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Dn=()=>{const[e,t]=(0,xe.useState)(!1),{open:n,alertType:i,title:o,message:s,btn:a}=(0,Ie.v9)((e=>e.alert)),l=(0,Ie.I0)(),c=(0,xe.useCallback)((()=>{l((0,r.M6)())}),[l]);(0,xe.useEffect)((()=>{n&&window.setTimeout((()=>{t(!0)}),10)}),[n]);let u=null;switch(i){case"captcha":u=Cn;break;case"ban":u=Nn}if(!e&&!n)return null;const d=n&&e;return xe.createElement(xe.Fragment,null,Rn(On,{z:6,show:d,onClick:c}),Rn("div",{className:d?"Alert show":"Alert",onTransitionEnd:()=>{n||t(!1)}},void 0,Rn("h2",{},void 0,o),s&&Rn("p",{},void 0,s),u?Rn(u,{close:c}):Rn("button",{type:"button",onClick:c},void 0,a)),")")},$n=xe.memo(Dn);var Mn;function zn(e,t,n,i){Mn||(Mn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Mn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Hn(e){return e?`${e.substring(0,2)}:${e.substring(2)}`:""}const Wn=()=>{const e=(0,xe.useRef)(null),[t,n]=(0,xe.useState)(!1),[i,o]=(0,xe.useState)([]),[s]=(0,xe.useState)((0,y.x2)()),[a,l,c,u]=(0,Ie.v9)((e=>[e.canvas.canvasId,e.canvas.canvasStartDate,e.canvas.historicalDate,e.canvas.historicalTime]),Ie.wU),d=(0,Ie.I0)(),h=(0,xe.useCallback)(((e,t)=>{const n=t.substring(0,2)+t.substring(3,5),i=(0,y.UW)(e);d((0,r.on)(i,n))}),[d]),f=(0,xe.useCallback)((async e=>{if(t)return;n(!0);const i=e.target.value,r=await(0,U.No)(i,a);r&&r.length&&(o(r),h(i,r[0])),n(!1)}),[t,i]),v=(0,xe.useCallback)((async t=>{if(!(i.length&&e&&e.current&&e.current.value))return;let r=i,s=i.indexOf(Hn(u))+t,l=e.current.value;if(s>=i.length||s<0){if(n(!0),s<0?e.current.stepDown(1):e.current.stepUp(1),l=e.current.value,r=await(0,U.No)(l,a),n(!1),!r||!r.length)return;s=s<0?r.length-1:0}o(r),h(l,r[s])}),[u,i,t]),p=(m=c)?`${m.substring(0,4)}-${m.substring(4,6)}-${m.substring(6)}`:"";var m;const g=Hn(u);return zn("div",{id:"historyselect"},void 0,xe.createElement("input",{type:"date",pattern:"\\d{4}-\\d{2}-\\d{2}",key:"dateinput",value:p,min:l,max:s,ref:e,onChange:f}),zn("div",{},"timeselcon",!!i.length&&u&&!t&&zn("div",{},"timesel",zn("button",{type:"button",className:"hsar",onClick:()=>v(-1)},void 0,"←"),zn("select",{value:g,onChange:e=>h(p,e.target.value)},void 0,i.map((e=>zn("option",{value:e},e,e)))),zn("button",{type:"button",className:"hsar",onClick:()=>v(1)},void 0,"→")),t&&zn("p",{},void 0,"Lade......"),!i.length&&!t&&zn("p",{},void 0,"Datum auswählen")))},Un=xe.memo(Wn);var Gn;function Fn(e,t,n,i){Gn||(Gn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Gn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vn={fontSize:34};function Zn(e,t){const n=pe();switch(e){case"FORWARD":n.controls.moveForward=t;break;case"BACKWARD":n.controls.moveBackward=t;break;case"LEFT":n.controls.moveLeft=t;break;case"RIGHT":n.controls.moveRight=t;break;case"UP":n.controls.moveUp=t;break;case"DOWN":n.controls.moveDown=t}}function Kn(){const e=pe();e.controls.moveForward=!1,e.controls.moveBackward=!1,e.controls.moveLeft=!1,e.controls.moveRight=!1,e.controls.moveUp=!1,e.controls.moveDown=!1}const Bn=()=>Fn("div",{},void 0,Fn("div",{className:"actionbuttons",role:"button",tabIndex:0,style:{...Vn,left:57,bottom:139},onMouseDown:()=>{Zn("FORWARD",!0)},onMouseUp:()=>{Zn("FORWARD",!1)},onTouchStart:()=>{Zn("FORWARD",!0)},onTouchEnd:()=>{Zn("FORWARD",!1)},onTouchCancel:Kn,onMouseLeave:Kn},void 0,"↑"),Fn("div",{className:"actionbuttons",role:"button",tabIndex:0,style:{...Vn,left:57,bottom:98},onMouseDown:()=>{Zn("BACKWARD",!0)},onMouseUp:()=>{Zn("BACKWARD",!1)},onTouchStart:()=>{Zn("BACKWARD",!0)},onTouchEnd:()=>{Zn("BACKWARD",!1)},onTouchCancel:Kn,onMouseLeave:Kn},void 0,"↓"),Fn("div",{className:"actionbuttons",role:"button",tabIndex:0,style:{...Vn,left:16,bottom:98},onMouseDown:()=>{Zn("LEFT",!0)},onMouseUp:()=>{Zn("LEFT",!1)},onTouchStart:()=>{Zn("LEFT",!0)},onTouchEnd:()=>{Zn("LEFT",!1)},onTouchCancel:Kn,onMouseLeave:Kn},void 0,"←"),Fn("div",{className:"actionbuttons",role:"button",tabIndex:0,style:{...Vn,left:98,bottom:98},onMouseDown:()=>{Zn("RIGHT",!0)},onMouseUp:()=>{Zn("RIGHT",!1)},onTouchStart:()=>{Zn("RIGHT",!0)},onTouchEnd:()=>{Zn("RIGHT",!1)},onTouchCancel:Kn,onMouseLeave:Kn},void 0,"→"),Fn("div",{className:"actionbuttons",role:"button",tabIndex:0,style:{...Vn,left:16,bottom:139},onMouseDown:()=>{Zn("UP",!0)},onMouseUp:()=>{Zn("UP",!1)},onTouchStart:()=>{Zn("UP",!0)},onTouchEnd:()=>{Zn("UP",!1)},onTouchCancel:Kn,onMouseLeave:Kn},void 0,"↖"),Fn("div",{className:"actionbuttons",role:"button",tabIndex:0,style:{...Vn,left:98,bottom:139},onMouseDown:()=>{Zn("DOWN",!0)},onMouseUp:()=>{Zn("DOWN",!1)},onTouchStart:()=>{Zn("DOWN",!0)},onTouchEnd:()=>{Zn("DOWN",!1)},onTouchCancel:Kn,onMouseLeave:Kn},void 0,"↘"));var jn,qn,Yn,Xn,Qn,Jn,ei,ti,ni;function ii(e,t,n,i){ni||(ni="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:ni,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oi=()=>{const[e,t,n]=(0,Ie.v9)((e=>[e.canvas.isHistoricalView,e.canvas.is3D,e.user.isOnMobile]),Ie.wU);return xe.createElement(xe.Fragment,null,jn||(jn=ii($n,{})),e?qn||(qn=ii(Un,{})):xe.createElement(xe.Fragment,null,Yn||(Yn=ii(ln,{})),Xn||(Xn=ii(hn,{})),!t&&(Qn||(Qn=ii(nn,{}))),t&&n&&(Jn||(Jn=ii(Bn,{}))),ei||(ei=ii(Bt,{}))),ti||(ti=ii(Xt,{})))},ri=xe.memo(oi);var si,ai,li;function ci(e,t,n,i){li||(li="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:li,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ui=()=>{const e=(0,Ie.v9)((e=>e.gui.menuOpen)),t=(0,Ie.I0)();return ci("div",{id:"menubutton",className:"actionbuttons",role:"button",title:e?"Schließe Menü":"Öffne Menü",tabIndex:-1,onClick:()=>t((0,r.vN)())},void 0,e?si||(si=ci(ct.Faw,{})):ai||(ai=ci(ct.Yc6,{})))},di=xe.memo(ui);var hi=n(7516),fi=n(573);const vi=e=>e.windows.windows,pi=e=>e.windows.showWindows,mi=(0,fi.P1)(vi,pi,((e,t)=>[e.some((e=>e.fullscreen&&!e.hidden))||t,e.some((e=>e.fullscreen&&e.open&&!e.hidden))])),gi=(0,fi.P1)(vi,pi,((e,t)=>(t||(e=e.filter((e=>e.fullscreen))),e.map((e=>e.windowId))))),wi=function(e,t,n){const i=(0,xe.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),t&&t();let{clientX:i,clientY:o}=e.touches?e.touches[0]:e;const r=e=>{e.preventDefault(),e.stopPropagation();const{clientX:t,clientY:r}=e.touches?e.touches[0]:e;n(t-i,r-o),i=t,o=r};document.addEventListener("mousemove",r),document.addEventListener("touchmove",r);const s=e=>{e.preventDefault(),e.stopPropagation(),document.removeEventListener("mousemove",r),document.removeEventListener("touchmove",r),document.removeEventListener("mouseup",s),document.removeEventListener("touchcancel",s),document.removeEventListener("touchend",s)};document.addEventListener("mouseup",s),document.addEventListener("touchcancel",s),document.addEventListener("touchend",s)}),[t,n]);(0,xe.useEffect)((()=>{const t=e.current;if(t)return t.addEventListener("mousedown",i,{passive:!1}),t.addEventListener("touchstart",i,{passive:!1}),()=>{t.removeEventListener("mousedown",i),t.removeEventListener("touchstart",i)}}),[e,i])};var yi,bi=n(2585);function Si(e,t,n,i){yi||(yi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:yi,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ki=()=>{const[e,t]=(0,xe.useState)(""),[n,i]=(0,xe.useState)(!1),r=(0,Ie.I0)();return Si("p",{},void 0,Si("input",{style:{display:"inline-block",width:"100%",maxWidth:"18em"},readOnly:!0,value:e}),e?Si("button",{type:"button",onClick:()=>{(0,o.Z)(e),r((0,s.h4)("Kopiert!"))}},"cobtn","Kopiere"):Si("button",{type:"button",onClick:async()=>{i(!0);const e=await(0,U.JL)();e.iid&&t(e.iid),i(!1)}},"subtn",n?"...":"Gib IID"))},Ci=xe.memo(ki);var Ei,Ti,xi,Ii,Ni,_i,Ai,Pi,Oi,Li,Ri,Di,$i,Mi,zi,Hi,Wi,Ui,Gi,Fi,Vi,Zi,Ki,Bi,ji,qi,Yi,Xi,Qi,Ji,eo,to,no,io,oo,ro,so,ao,lo,co,uo,ho,fo;function vo(e,t,n,i){fo||(fo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:fo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var po,mo,go=n(888);function wo(e,t,n,i){mo||(mo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:mo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yo=xe.memo((e=>{let{title:t,keyBind:n,value:i,onToggle:o,children:r,deactivated:s}=e;return wo("div",{className:"setitem"},void 0,wo("div",{className:"setrow"},void 0,wo("h3",{className:"settitle"},void 0,t," ",n&&wo("kbd",{},void 0,n)),wo(go.Z,{checked:i,onChange:o,disabled:s})),wo("div",{className:"modaldesc"},void 0,r),po||(po=wo("div",{className:"modaldivider"})))}),((e,t)=>e.value===t.value));var bo;function So(e,t,n,i){bo||(bo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:bo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ko=function(){const{lang:e,langs:t}=window.ssv,[n,i]=(0,xe.useState)(e),[o,r]=(0,xe.useState)("xx");return(0,xe.useEffect)((()=>{for(let e=0;e<t.length;e+=1){const[i,o]=t[e];if(i===n)return void r(o)}}),[n]),navigator.cookieEnabled?So("div",{style:{textAlign:"right"}},void 0,So("span",{},void 0,So("select",{value:n,onChange:e=>{const t=e.target;i(t.options[t.selectedIndex].value)}},void 0,t.map((e=>{let[t]=e;return So("option",{value:t},t,t.toUpperCase())})))),"  ",So("span",{},void 0,So("img",{style:{height:"1em",imageRendering:"crisp-edges"},alt:"",src:`/cf/${o}.gif`})),So("button",{type:"submit",style:{display:"block",margin:5},onClick:()=>{const e=new Date;e.setTime(e.getTime()+24*b.vc);let{host:t}=window.location;t=t.lastIndexOf(".")!==t.indexOf(".")?t.slice(t.indexOf(".")):`.${t}`,document.cookie=`plang=${n};expires=${e.toUTCString()};path=/;domain=${t}`,window.location.reload()}},void 0,"Speichern")):null};var Co,Eo,To;function xo(e,t,n,i){To||(To="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:To,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Io=e=>{let{title:t,values:n,selected:i,onSelect:o,icon:r,children:s}=e;return xo("div",{className:"setitem"},void 0,xo("div",{className:"setrow"},void 0,xo("h3",{className:"settitle"},void 0,t),r&&xo("img",{alt:"",src:r}),xo("select",{value:i,onChange:e=>{const t=e.target;o(t.options[t.selectedIndex].value)}},void 0,n.map((e=>xo("option",{value:e},e,e))))),xo("div",{className:"modaldesc"},void 0,s),Co||(Co=xo("div",{className:"modaldivider"})))};function No(){const[e,t,n,i,o,s,a,l,c,u]=(0,Ie.v9)((e=>[e.gui.showGrid,e.gui.showPixelNotify,e.gui.autoZoomIn,e.gui.compactPalette,e.gui.isPotato,e.gui.isLightGrid,e.gui.style,e.gui.mute,e.gui.chatNotify,e.canvas.isHistoricalView]),Ie.wU),d=(0,Ie.I0)(),h=window.AudioContext||window.webkitAudioContext;return xo("div",{className:"content"},void 0,xo(yo,{title:"Zeige Raster",keyBind:"G",value:e,onToggle:()=>d((0,r.xK)())},void 0,"Aktiviere das Raster um  Pixelgrenzen zu sehen."),xo(yo,{title:"Zeige Pixelaktivität",keyBind:"X",value:t,onToggle:()=>d((0,r.Xb)())},void 0,"Zeige Kreise wo Pixel von Spielern gesetzt werden."),xo(yo,{title:"Deaktiviere Spiel Ton",keyBind:"M",deactivated:!h,value:!h||l,onToggle:()=>d((0,r.$t)())},void 0,["Alle Toneffekte werden ausgeschaltet.",!h&&xo("p",{className:"warn"},void 0,"Dein Browser erlaubt uns nicht, mit AudioContext Töne abzuspielen. Werden wir von Privatsphäreneinstellungen blockiert?")]),xo(yo,{title:"Aktiviere Chat Benachrichtigungen",value:c,onToggle:()=>d((0,r.c7)())},void 0,"Spiele ein Geräusch wenn eine neue Chat Nachricht eintrifft"),xo(yo,{title:"Automaticher Zoom",value:n,onToggle:()=>d((0,r.o7)())},void 0,"Zoome rein anstatt ein Pixel zu setzen wenn auf kleineren Zoomlevel geklickt wird."),xo(yo,{title:"Kompakte Palette",value:i,onToggle:()=>d((0,r.Cd)())},void 0,"Zeige die Palette in einer kleineren Form an, welche weniger Platz benötigt."),xo(yo,{title:"Erdapfel Modus",value:o,onToggle:()=>d((0,r.RL)())},void 0,"Wenn du auf einer Kartoffel spielst."),xo(yo,{title:"Helles Raster",value:s,onToggle:()=>d((0,r.ts)())},void 0,"Zeige das Raster in weiß anstatt schwarz."),window.ssv&&window.ssv.backupurl&&xo(yo,{title:"Historische Ansicht",value:u,keyBind:"H",onToggle:()=>d((0,r.FI)())},void 0,"Siehe vergangene Versionen der Leinwand."),window.ssv&&window.ssv.availableStyles&&xo(Io,{title:"Themen",values:Object.keys(window.ssv.availableStyles),selected:a,onSelect:e=>d((0,r.MM)(e))},void 0,"Wähle aus wie pixelplanet aussehen soll."),window.ssv&&navigator.cookieEnabled&&window.ssv.langs&&xo("div",{className:"setitem"},void 0,xo("div",{className:"setrow"},void 0,xo("h3",{className:"settitle"},void 0,"Sprache Auswählen"),Eo||(Eo=xo(ko,{})))))}const _o=xe.memo(No),Ao=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-*\.?[a-zA-Z0-9])*\.[a-zA-Z](-?[a-zA-Z0-9])+$/;function Po(e){return e?e.length<5?"Email sollte zumindest 5 Zeichen lang sein.":e.length>40?"Email kann nicht länger als 40 Zeichen sein.":-1===e.indexOf(".")?"Email sollte zumindest einen Punkt beinhalten":1!==e.split("").filter((e=>"@"===e)).length?"Email sollte ein @ beinhalten":!Ao.test(e)&&"Your Email looks shady":"Email Feld kann nicht leer sein."}function Oo(e){return e?e.length<2?"Name muss mindestens 4 Zeichen lang sein":e.length>26?"Name muss kleiner als 26 Zeichen sein":(-1!==e.indexOf("@")||-1!==e.indexOf("/")||-1!==e.indexOf("\\")||-1!==e.indexOf(">")||-1!==e.indexOf("<")||-1!==e.indexOf("#"))&&"Ungültige Zeichen im Namen wie @,/.\\ oder #":"Email Feld kann nicht leer sein."}function Lo(e){return e?e.length<6?"Passwort muss mindestens 6 Zeichen lang sein.":e.length>60&&"Passwort muss kleiner als 60 Zeichen sein.":"Kein Passwort eingegeben."}var Ro,Do;function $o(e,t,n,i){Do||(Do="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Do,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mo={display:"inline-block",width:"75%",maxWidth:"35em"},zo=()=>{const[e,t]=(0,xe.useState)(""),[n,i]=(0,xe.useState)(""),[o,s]=(0,xe.useState)(!1),[a,l]=(0,xe.useState)([]),c=(0,Ie.I0)();return $o("form",{onSubmit:async t=>{if(t.preventDefault(),o)return;const i=function(e,t){const n=[],i=-1!==e.indexOf("@")?Po(e):Oo(e);i&&n.push(i);const o=Lo(t);return o&&n.push(o),n}(e,n);if(i.length>0)return void l(i);s(!0);const{errors:a,me:u}=await(0,U.Pw)(e,n);s(!1),a?l(a):c((0,r.pH)(u))}},void 0,a.map((e=>$o("p",{},e,$o("span",{},void 0,"Fehler"),": ",e))),$o("input",{value:e,style:Mo,onChange:e=>t(e.target.value),type:"text",placeholder:"Name oder Email"}),Ro||(Ro=$o("br",{})),$o("input",{value:n,style:Mo,onChange:e=>i(e.target.value),type:"password",placeholder:"Passwort"}),$o("p",{},void 0,$o("button",{type:"submit"},void 0,o?"...":"Einloggen")))},Ho=xe.memo(zo);var Wo,Uo,Go,Fo,Vo,Zo,Ko,Bo;function jo(e,t,n,i){Bo||(Bo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Bo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const qo={marginRight:5},Yo=()=>{const e=Be();return jo("div",{style:{textAlign:"center"}},void 0,jo("p",{},void 0,"Melde dich and um mehr Funktionen und Statistikan zu sehen."),Wo||(Wo=jo("br",{})),jo("h2",{},void 0,"Mit Name oder Mail anmelden:"),Uo||(Uo=jo(Ho,{})),jo("p",{className:"modallink",onClick:()=>e("FORGOT_PASSWORD"),role:"presentation"},void 0,"Ich habe mein Passwort vergessen."),jo("h2",{},void 0,"oder melde dich an mit:"),Go||(Go=jo("a",{href:"/api/auth/discord"},void 0,jo("img",{style:qo,width:32,src:"/discordlogo.svg",alt:"Discord"}))),Fo||(Fo=jo("a",{href:"/api/auth/google"},void 0,jo("img",{style:qo,width:32,src:"/googlelogo.svg",alt:"Google"}))),Vo||(Vo=jo("a",{href:"/api/auth/facebook"},void 0,jo("img",{style:qo,width:32,src:"/facebooklogo.svg",alt:"Facebook"}))),Zo||(Zo=jo("a",{href:"/api/auth/vk"},void 0,jo("img",{style:qo,width:32,src:"/vklogo.svg",alt:"VK"}))),Ko||(Ko=jo("a",{href:"/api/auth/reddit"},void 0,jo("img",{style:qo,width:32,src:"/redditlogo.svg",alt:"Reddit"}))),jo("h2",{},void 0,"oder registriere dich hier:"),jo("button",{type:"button",onClick:()=>e("REGISTER")},void 0,"Registrieren"))},Xo=xe.memo(Yo);var Qo;function Jo(e,t,n,i){Qo||(Qo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Qo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const er=e=>{let{onClick:t,active:n,label:i}=e,o="tab-list-item";return n&&(o+=" active"),Jo("li",{role:"presentation",className:o,onClick:()=>t(i)},void 0,i)};var tr;function nr(e,t,n,i){tr||(tr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:tr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ir=e=>{let{children:t,activeTab:n,setActiveTab:i}=e;return nr("div",{className:"tabs"},void 0,nr("ol",{className:"tab-list"},void 0,t.map((e=>{if(!e.props)return;const{label:t}=e.props;return nr(er,{active:n===t,label:t,onClick:e=>i(e)},t)}))),nr("div",{className:"tab-content"},void 0,t.map((e=>{if(e.props&&e.props.label===n)return e.props.children}))))};var or;function rr(e,t,n,i){or||(or="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:or,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const sr=()=>{const[e,t]=(0,xe.useState)(!1),[n,i]=(0,xe.useState)(null),o=(0,Ie.v9)((e=>e.user.messages));return o?rr("div",{style:{paddingLeft:"5%",paddingRight:"5%"}},void 0,o.includes("not_verified")&&rr("p",{className:"usermessages"},void 0,"Bitte bestätige deine E-Mail Adresse oder dein Konto könnte nach einigen Tagen gelöscht werden.",n?rr("span",{className:"modallink"},void 0,n):rr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:async()=>{if(e)return;t(!0);const{errors:n}=await(0,U.ft)(),o=n?n[0]:"Eine neue Bestätigungsmail wurde gesendet.";i(o)}},void 0,"Klicke hier um eine neue Bestätigungsmail zu beantragen.")),o.map((e=>"not_verified"===e?null:rr("p",{className:"usermessages"},e,e)))):null},ar=xe.memo(sr);var lr,cr,ur,dr;function hr(e,t,n,i){dr||(dr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:dr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fr=e=>{let{done:t}=e;const[n,i]=(0,xe.useState)(""),[o,s]=(0,xe.useState)(""),[a,l]=(0,xe.useState)(""),[c,u]=(0,xe.useState)(!1),[d,h]=(0,xe.useState)(!1),[f,v]=(0,xe.useState)([]),p=(0,Ie.v9)((e=>e.user.mailreg)),m=(0,Ie.I0)();return c?hr("div",{className:"inarea"},void 0,hr("p",{className:"modalmessage"},void 0,"Passwort erfolgreich geändert."),hr("button",{type:"button",onClick:t},void 0,"Close")):hr("div",{className:"inarea"},void 0,hr("form",{onSubmit:async e=>{if(e.preventDefault(),d)return;const t=function(e,t,n,i){const o=[];if(e){const e=Lo(t);e&&o.push(e)}if(n!==i)return o.push("Passwörter stimmen nicht überein."),o;const r=Lo(n);return r&&o.push(r),o}(p,n,o,a);if(v(t),t.length)return;h(!0);const{errors:i}=await(0,U.Oh)(o,n);if(i)return v(i),void h(!1);m((0,r.Y2)(!0)),u(!0)}},void 0,f.map((e=>hr("p",{className:"errormessage"},e,hr("span",{},void 0,"Fehler"),": ",e))),p&&hr("input",{value:n,onChange:e=>i(e.target.value),type:"password",placeholder:"Altes Passwort"}),lr||(lr=hr("br",{})),hr("input",{value:o,onChange:e=>s(e.target.value),type:"password",placeholder:"Neues Passwort"}),cr||(cr=hr("br",{})),hr("input",{value:a,onChange:e=>l(e.target.value),type:"password",placeholder:"Neues Passwort bestätigen"}),ur||(ur=hr("br",{})),hr("button",{type:"submit"},void 0,d?"...":"Speichern"),hr("button",{type:"button",onClick:t},void 0,"Abbrechen")))},vr=xe.memo(fr);var pr,mr;function gr(e,t,n,i){mr||(mr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:mr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wr=e=>{let{done:t}=e;const[n,i]=(0,xe.useState)(""),[o,s]=(0,xe.useState)(!1),[a,l]=(0,xe.useState)([]),c=(0,Ie.I0)();return gr("div",{className:"inarea"},void 0,gr("form",{onSubmit:async e=>{if(e.preventDefault(),o)return;const i=function(e){const t=[],n=Oo(e);return n&&t.push(n),t}(n);if(i.length>0)return void l(i);s(!0);const{errors:a}=await(0,U.Wt)(n);s(!1),a?l(a):(c((0,r.qC)(n)),t())}},void 0,a.map((e=>gr("p",{className:"errormessage"},e,gr("span",{},void 0,"Fehler"),": ",e))),gr("input",{value:n,onChange:e=>i(e.target.value),type:"text",placeholder:"Neuer Name"}),pr||(pr=gr("br",{})),gr("button",{type:"submit"},void 0,o?"...":"Speichern"),gr("button",{type:"button",onClick:t},void 0,"Abbrechen")))};var yr,br,Sr;function kr(e,t,n,i){Sr||(Sr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Sr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Cr=e=>{let{done:t}=e;const[n,i]=(0,xe.useState)(""),[o,r]=(0,xe.useState)(""),[s,a]=(0,xe.useState)(!1),[l,c]=(0,xe.useState)(!1),[u,d]=(0,xe.useState)([]);return l?kr("div",{className:"inarea"},void 0,kr("p",{className:"modalmessage"},void 0,"Erfolgreich änderte Mail Adresse. Wir haben dir eine neue Bestätigungsmail gesendet."),kr("button",{type:"button",onClick:t},void 0,"Close")):kr("div",{className:"inarea"},void 0,kr("form",{onSubmit:async e=>{if(e.preventDefault(),s)return;const t=function(e,t){const n=[],i=Lo(t);i&&n.push(i);const o=Po(e);return o&&n.push(o),n}(o,n);if(t.length>0)return void d(t);a(!0);const{errors:i}=await(0,U.fF)(o,n);a(!1),i?d(i):c(!0)}},void 0,u.map((e=>kr("p",{className:"errormessage"},e,kr("span",{},void 0,"Fehler"),": ",e))),kr("input",{value:n,onChange:e=>i(e.target.value),type:"password",placeholder:"Passwort"}),yr||(yr=kr("br",{})),kr("input",{value:o,onChange:e=>r(e.target.value),type:"text",placeholder:"Neue Mail"}),br||(br=kr("br",{})),kr("button",{type:"submit"},void 0,s?"...":"Speichern"),kr("button",{type:"button",onClick:t},void 0,"Abbrechen")))};var Er,Tr;function xr(e,t,n,i){Tr||(Tr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Tr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ir=e=>{let{done:t}=e;const[n,i]=(0,xe.useState)(""),[o,s]=(0,xe.useState)(!1),[a,l]=(0,xe.useState)([]),c=(0,Ie.I0)();return xr("div",{className:"inarea",style:{backgroundColor:"#ff6666"}},void 0,xr("form",{onSubmit:async e=>{if(e.preventDefault(),o)return;const t=function(e){const t=[],n=Lo(e);return n&&t.push(n),t}(n);if(t.length>0)return void l(t);s(!0);const{errors:i}=await(0,U.s$)(n);s(!1),i?l(i):c((0,r.TX)())}},void 0,a.map((e=>xr("p",{className:"errormessage"},e,xr("span",{},void 0,"Fehler"),": ",e))),xr("input",{value:n,onChange:e=>i(e.target.value),type:"password",placeholder:"Passwort"}),Er||(Er=xr("br",{})),xr("button",{type:"submit"},void 0,o?"...":"Ja, löche mein Konto!"),xr("button",{type:"button",onClick:t},void 0,"Abbrechen")))};var Nr,_r;function Ar(e,t,n,i){_r||(_r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:_r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pr=e=>[e.chat.blocked,e.user.blockDm,e.user.priv,e.fetching.fetchingApi],Or=e=>{let{done:t}=e;const[n,i,o,r]=(0,Ie.v9)(Pr,Ie.wU),a=(0,Ie.I0)();return Ar("div",{className:"inarea"},void 0,Ar(yo,{title:"Block DMs",value:i,onToggle:()=>{r||a((0,s.R0)(!i))}},void 0,"Blockiere alle Privaten Nachrichten"),Ar(yo,{title:"Private",value:o,onToggle:()=>{r||a((0,s.eg)(!o))}},void 0,"Don't show me in global stats"),Ar("h3",{style:{textAlign:"left",marginLeft:10}},void 0,"Entblocke Spieler"),n.length?Ar("span",{className:"unblocklist"},void 0,n.map((e=>Ar("div",{role:"button",tabIndex:0,onClick:()=>{r||a((0,s.Ox)(e[0],e[1],!1))}},e[0],`⦸ ${e[1]}`)))):Ar("p",{},void 0,"Du hast keinen Spieler geblockt"),Nr||(Nr=Ar("div",{className:"modaldivider"})),Ar("button",{type:"button",onClick:t,style:{margin:10}},void 0,"Done"))};var Lr,Rr,Dr,$r,Mr,zr,Hr;function Wr(e,t,n,i){Hr||(Hr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Hr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ur={CHANGE_NAME:xe.memo(wr),CHANGE_MAIL:xe.memo(Cr),CHANGE_PASSWORD:vr,DELETE_ACCOUNT:xe.memo(Ir),SOCIAL_SETTINGS:xe.memo(Or)},Gr=e=>{let{text:t,value:n,rank:i}=e;return Wr("p",{},void 0,Wr("span",{className:"stattext"},void 0,i?`${t}: #`:`${t}: `)," ",Wr("span",{className:"statvalue"},void 0,(0,y.D$)(n)))},Fr=()=>{const[e,t]=(0,xe.useState)("NONE"),n=(0,Ie.I0)(),i=(0,xe.useCallback)((async()=>{await(0,U.e9)()&&n((0,r.TX)())}),[n]),o=(0,Ie.v9)((e=>e.user.mailreg)),s=(0,Ie.v9)((e=>e.user.name)),a=(0,Ie.v9)((e=>({totalPixels:e.ranks.totalPixels,dailyTotalPixels:e.ranks.dailyTotalPixels,ranking:e.ranks.ranking,dailyRanking:e.ranks.dailyRanking})),Ie.wU),l=Ur[e];return Wr("div",{className:"content"},void 0,Lr||(Lr=Wr(ar,{})),Wr(Gr,{text:"Heutige Pixel",value:a.dailyTotalPixels}),Wr(Gr,{text:"Tägliche Rangliste",value:a.dailyRanking,rank:!0}),Wr(Gr,{text:"Plazierte Pixel",value:a.totalPixels}),Wr(Gr,{text:"Gesamt Rang",value:a.ranking,rank:!0}),Wr("div",{},void 0,Wr("p",{},void 0,`Dein Name ist: ${s}`),"(",Wr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:i},void 0," ","Abmelden"),Rr||(Rr=Wr("span",{className:"hdivider"})),Wr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("CHANGE_NAME")},void 0," ","Ändere Namen"),Dr||(Dr=Wr("span",{className:"hdivider"})),o&&Wr(xe.Fragment,{},"mc",Wr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("CHANGE_MAIL")},void 0," ","Ändere Mail"),$r||($r=Wr("span",{className:"hdivider"}))),Wr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("CHANGE_PASSWORD")},void 0," ","Passwort ändern"),Mr||(Mr=Wr("span",{className:"hdivider"})),Wr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("DELETE_ACCOUNT")},void 0," ","Lösche Konto")," )",zr||(zr=Wr("br",{})),"(",Wr("span",{role:"button",tabIndex:-1,className:"modallink",onClick:()=>t("SOCIAL_SETTINGS")},void 0," ","Soziale Einstellungen")," )"),l&&Wr(l,{done:()=>t(null)}))},Vr=xe.memo(Fr);var Zr,Kr,Br,jr,qr,Yr,Xr,Qr,Jr;function es(e,t,n,i){Jr||(Jr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Jr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ts=xe.lazy((()=>n.e(784).then(n.bind(n,7356)))),ns=xe.lazy((()=>n.e(545).then(n.bind(n,1305)))),is=xe.lazy((()=>n.e(189).then(n.bind(n,4384)))),os=()=>{const e=(0,Ie.v9)((e=>e.user.name)),t=(0,Ie.v9)((e=>e.user.userlvl)),n=(0,Ie.v9)((e=>e.ranks.lastFetch)),{args:i,setArgs:o,setTitle:r}=(0,xe.useContext)(Ze),{activeTab:a="Profil"}=i,l=(0,Ie.I0)(),c=(0,xe.useCallback)((e=>{o({activeTab:e}),r(e)}),[o]);return(0,Tn.Z)((()=>{Date.now()-3e5>n&&l((0,s.mP)())}),3e5),es("div",{style:{textAlign:"center"}},void 0,es(ir,{activeTab:a,setActiveTab:c},void 0,es("div",{label:"Profil"},void 0,e?Zr||(Zr=es(Vr,{})):Kr||(Kr=es(Xo,{}))),es("div",{label:"Statistics"},void 0,Br||(Br=es(xe.Suspense,{fallback:es("div",{},void 0,"Loading...")},void 0,es(ts,{})))),es("div",{label:"Konverter"},void 0,jr||(jr=es(xe.Suspense,{fallback:es("div",{},void 0,"Loading...")},void 0,es(ns,{})))),t&&es("div",{label:"Mod Werkzeuge"},void 0,es(xe.Suspense,{fallback:es("div",{},void 0,"Lade...")},void 0,qr||(qr=es(is,{}))))),Yr||(Yr=es("br",{})),"Triff uns und andere Spieler auf guilded:"," ",Xr||(Xr=es("a",{href:"./guilded",target:"_blank"},void 0,"pixelplanet.fun/guilded")),Qr||(Qr=es("br",{})))},rs=xe.memo(os);var ss;function as(e,t,n,i){ss||(ss="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:ss,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ls=()=>{const[e,t]=(0,xe.useState)(""),[n,i]=(0,xe.useState)([]),[o,s]=(0,xe.useState)(Date.now()),a=(0,Ie.I0)(),l=Be();return as("div",{className:"content"},void 0,as("form",{style:{paddingLeft:"5%",paddingRight:"5%"},onSubmit:async n=>{if(n.preventDefault(),e)return;const o=n.target.name.value,c=n.target.email.value,u=n.target.password.value,d=n.target.confirmpassword.value,h=n.target.captcha.value,f=n.target.captchaid.value,v=function(e,t,n,i){const o=[],r=Po(t);r&&o.push(r);const s=Oo(e);s&&o.push(s);const a=Lo(n);return a&&o.push(a),n!==i&&o.push("Passwords do not match"),o}(o,c,u,d);if(v.length>0)return void i(v);t(!0);const{errors:p,me:m}=await(0,U.yx)(o,c,u,h,f);if(t(!1),p)return s(Date.now()),void i(p);a((0,r.pH)(m)),l("USERAREA")}},void 0,as("p",{},void 0,"Registriere ein neues Konto hier"),n.map((e=>as("p",{className:"errormessage"},e,as("span",{},void 0,"Fehler"),": ",e))),as("h3",{},void 0,"Name",":"),as("input",{name:"name",className:"reginput",autoComplete:"username",type:"text",placeholder:"Name"}),as("h3",{},void 0,"Email",":"),as("input",{name:"email",className:"reginput",autoComplete:"email",type:"text",placeholder:"Email"}),as("h3",{},void 0,"Passwort",":"),as("input",{name:"password",className:"reginput",autoComplete:"new-password",type:"password",placeholder:"Passwort"}),as("h3",{},void 0,"Passwort bestätigen",":"),as("input",{name:"confirmpassword",className:"reginput",autoComplete:"new-password",type:"password",placeholder:"Passwort bestätigen"}),as("h3",{},void 0,"Captcha",":"),as(yn,{autoload:!1,width:60},o),as("button",{type:"submit"},void 0,e?"...":"Absenden"),as("button",{type:"button",onClick:()=>l("USERAREA")},void 0,"Abbrechen")))},cs=xe.memo(ls);var us,ds,hs,fs,vs,ps,ms,gs,ws,ys;function bs(e,t,n,i){ys||(ys="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:ys,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ss=e=>{let{canvasId:t,canvas:n,selCanvas:i,online:o}=e;return bs("div",{className:"cvbtn",onClick:()=>i(t),role:"button",tabIndex:0},void 0,bs("img",{className:"cvimg",alt:"preview",src:`/preview${t}.png`}),bs("div",{className:"modalcvtext"},void 0,bs("h4",{},void 0,n.title),o&&bs(xe.Fragment,{},"online","Spieler online",": ",bs("span",{className:"modalinfo"},void 0,o),us||(us=bs("br",{}))),bs("span",{className:"modalinfo"},void 0,n.desc),ds||(ds=bs("br",{})),"Abklingzeit",": ",bs("span",{className:"modalinfo"},void 0,n.pcd&&n.bcd!==n.pcd?bs("span",{},"cdf"," ",n.bcd/1e3,"s / ",n.pcd/1e3,"s"):bs("span",{},"cd"," ",n.bcd/1e3,"s")),hs||(hs=bs("br",{})),"Gesamtzeit",": ",bs("span",{className:"modalinfo"},void 0," ",n.cds/1e3,"s"),fs||(fs=bs("br",{})),"Gewertet",": ",bs("span",{className:"modalinfo"},void 0,n.ranked?"Ja":"Nein"),vs||(vs=bs("br",{})),void 0!==n.req&&bs(xe.Fragment,{},"req",bs("span",{},void 0,"Vorraussetzungen",":",ps||(ps=bs("br",{})),bs("span",{className:"modalinfo"},void 0,"number"==typeof n.req?bs("span",{},void 0,"Konto"," "):null,n.req>0?bs("span",{},void 0," ",`und ${n.req} gesetzte Pixel`," "):null,"top"===n.req&&bs("span",{},void 0,"Top 10 Platzierung am Vortag"))),ms||(ms=bs("br",{}))),"Dimensionen",": ",bs("span",{className:"modalinfo"},void 0," ",n.size," x ",n.size,n.v?gs||(gs=bs("span",{},"voxsize"," x ",b.Tj," Voxels")):ws||(ws=bs("span",{},"pxlsize"," Pixels")))))},ks=xe.memo(Ss);var Cs;function Es(e,t,n,i){Cs||(Cs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Cs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ts=()=>{const[e,t,n]=(0,Ie.v9)((e=>[e.canvas.canvases,e.canvas.showHiddenCanvases,e.ranks.online]),Ie.wU),i=(0,Ie.I0)(),o=(0,xe.useCallback)((e=>i((0,r.SC)(e))),[i]),s=Be();return Es("div",{className:"content"},void 0,Es("p",{},void 0,"Wähle die Leinwand aus welche du benutzen willst. Jede Leinwand ist einzigartig und hat unterschiedliche Parletten, Abklingzeiten und Vorraussetzungen. Archiv von vergangenen Leinwänden kann hier gesehen werden:"," ",Es("span",{role:"button",tabIndex:0,className:"modallink",onClick:()=>s("ARCHIVE")},void 0,"Archiv"),")"),Object.keys(e).map((i=>(!e[i].hid||t)&&Es(ks,{online:n[i],canvasId:i,canvas:e[i],selCanvas:o},i))))},xs=xe.memo(Ts);var Is,Ns,_s,As,Ps;function Os(e,t,n,i){Ps||(Ps="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Ps,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ls={maxWidth:"20%",padding:2,display:"inline-block",verticalAlign:"middle"};var Rs,Ds=n(9210),$s=n(3935);function Ms(e,t,n,i){Rs||(Rs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Rs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zs=e=>{let{args:t,close:n}=e;const i=(0,Ie.v9)((e=>e.chat.channels)),o=(0,Ie.v9)((e=>e.fetching.fetchingApi)),r=(0,Ie.I0)(),{name:a,uid:l,setChannel:c,addToInput:u}=t;return xe.createElement(xe.Fragment,null,Ms("div",{role:"button",tabIndex:0,onClick:()=>{const e=`@[${(0,y.lg)(a)}](${l})`;u(e),n()},style:{borderTop:"none"}},"ping","Erwähnen"),Ms("div",{role:"button",tabIndex:0,onClick:()=>{const e=Object.keys(i);for(let t=0;t<e.length;t+=1){const o=e[t];if(4===i[o].length&&i[o][3]===l)return c(o),void n()}o||r((0,s.YB)({userId:l},c)),n()}},"dm","DM"),Ms("div",{role:"button",tabIndex:-1,onClick:()=>{r((0,s.Ox)(l,a,!0)),n()}},"block","Blocke"))};var Hs;function Ws(e,t,n,i){Hs||(Hs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Hs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Us=e=>{let{args:t,close:n}=e;const i=(0,Ie.v9)((e=>e.chat.channels)),o=(0,Ie.v9)((e=>e.chatRead.mute)),{cid:a}=t,l=(0,Ie.I0)(),c=o.includes(a);return xe.createElement(xe.Fragment,null,Ws("div",{role:"button",onClick:()=>{l(c?(0,r.wC)(a):(0,r.nb)(a))},tabIndex:0,style:{borderTop:"none"}},"mute",(c?"✔":"✘")+" Stummschalten"),0!==i[a][1]&&Ws("div",{role:"button",onClick:()=>{l((0,s.K6)(a)),n()},tabIndex:0},"leave","Schließen"))};var Gs;function Fs(e,t,n,i){Gs||(Gs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Gs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vs={USER:xe.memo(zs),CHANNEL:xe.memo(Us)},Zs=e=>{let{type:t,x:n,y:i,args:o,close:r,align:s}=e;const a=(0,xe.useRef)(null);var l,c;if(l=[a],c=r,(0,xe.useEffect)((()=>{const e=l.some((e=>e.current))?l.map((e=>e.current)):null;if(null===e)return;const t=t=>{e.every((e=>!e||!e.contains(t.target)))&&c()},n=()=>{c()};return document.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("resize",n),()=>{document.removeEventListener("mousedown",t,{capture:!0}),window.removeEventListener("resize",n)}}),[l,c]),!t)return null;const u={};switch(s){case"tr":u.right=window.innerWidth-n,u.top=i;break;case"br":u.right=window.innerWidth-n,u.bottom=window.innerHeight-i;break;case"bl":u.left=n,u.bottom=window.innerHeight-i;break;default:u.left=n,u.top=i}const d=Vs[t];return $s.createPortal(xe.createElement("div",{ref:a,className:`contextmenu ${t}`,style:u},Fs(d,{close:r,args:o})),document.getElementById("app"))},Ks=xe.memo(Zs);var Bs,js,qs=n(3854);function Ys(e,t,n,i){js||(js="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:js,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xs=e=>{let{url:t}=e;const[n,i]=(0,xe.useState)(null);return(0,xe.useEffect)((()=>{!async function(){const e=`${window.location.protocol}//www.tiktok.com/oembed?url=${encodeURIComponent(t)}`,n=await fetch(e),o=await n.json();o.html&&i(o.html)}()}),[]),n?Ys("iframe",{style:{width:"100%",height:756},srcDoc:n,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded tiktok"}):Bs||(Bs=Ys("div",{},void 0,"LOADING"))},Qs=[xe.memo(Xs),e=>e.includes("/video/"),e=>function(e){let t=e.indexOf("/@");if(-1===t)return e;t+=1;let n=e.indexOf("/",t);return-1===n&&(n=e.length),e.substring(t,n)}(e),"/embico/tiktok.png"];var Js;function ea(e,t,n,i){Js||(Js="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Js,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ta(e){let t,n=-1;if(e.includes("youtube")&&(n=e.indexOf("v=")),e.includes("youtu.be")&&(n=e.indexOf("e/")),-1===n)return null;for(n+=2,t=n;t<e.length&&!["&","?","/"].includes(e[t]);t+=1);return e.substring(n,t)}const na=e=>{let{url:t}=e;const n=ta(t);return n?ea("div",{className:"vemb",style:{paddingBottom:"56.25%"}},void 0,ea("iframe",{className:"vembc",src:`https://www.youtube.com/embed/${n}`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded youtube"})):null},ia=[xe.memo(na),ta,e=>ta(e),"/embico/youtube.png"];var oa;function ra(e,t,n,i){oa||(oa="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:oa,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const sa=e=>{let{url:t}=e;const n=t.substring(0,t.indexOf("?type="));return t.includes("?type=video")?ra("div",{className:"vemb"},void 0,ra("video",{className:"vembc",controls:!0,autoPlay:!0,src:n})):ra("img",{alt:`Matrix ${n}`,src:n,style:{maxWidth:"100%"}})},aa=[xe.memo(sa),e=>e.includes("?type=video")||e.includes("?type=image"),null,"/embico/matrix.png"],la=function(e,t){const n=(0,xe.useRef)();(0,xe.useEffect)((()=>{n.current=t}),[t]),(0,xe.useEffect)((()=>{function t(t){t.source===e.current.contentWindow&&n.current(t.data)}return window.addEventListener("message",t,!1),()=>window.removeEventListener("message",t)}),[])},ca="t.me/",ua=e=>{let{url:t}=e;const[n,i]=(0,xe.useState)(200),o=(0,xe.useRef)(null);la(o,(e=>{try{const t=JSON.parse(e);"resize"===t.event&&t.height&&i(t.height)}catch{console.error(`Could not read postMessage from frame: ${e}`)}}));let r=(0,y._N)(t);r=r.substring(r.indexOf(ca)+ca.length);const s=r.indexOf("/",r.indexOf("/")+1);return-1!==s&&(r=r.substring(0,s)),xe.createElement("iframe",{ref:o,style:{width:"100%",height:n},src:`https://t.me/${r}?embed=1`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded telegram"})},da=[xe.memo(ua),e=>{let t=e.indexOf(ca);return!(-1===t||t+ca.length+1>=e.length||(t=e.indexOf("/",t+ca.length+1),-1===t||t+2>=e.length))},e=>{let t=e.substring(e.indexOf(ca)+ca.length);return t=t.substring(0,t.indexOf("/")),t},"/embico/telegram.png"],ha="/status/",fa=e=>{let{url:t}=e;const[n,i]=(0,xe.useState)(200),o=(0,xe.useRef)(null);la(o,(e=>{try{e["twttr.embed"]&&"twttr.private.resize"===e["twttr.embed"].method&&e["twttr.embed"].params.length&&e["twttr.embed"].params[0].height&&i(e["twttr.embed"].params[0].height)}catch{console.error(`Could not read postMessage from frame: ${e}`)}}));let r=(0,y._N)(t);return r=r.substring(r.indexOf(ha)+ha.length),-1!==r.indexOf("/")&&(r=r.substring(r.indexOf("/"))),xe.createElement("iframe",{ref:o,style:{width:"100%",height:n},src:`https://platform.twitter.com/embed/Tweet.html?dnt=true&embedId=twitter-widget-&frame=false&hideCard=false&hideThread=true&id=${r}&theme=light&width=550px`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",allowFullScreen:!0,title:"Embedded twitter"})},va=[xe.memo(fa),e=>{const t=e.indexOf(ha);return!(-1===t||t+ha.length+1>=e.length)},e=>{let t=e.substring(0,e.indexOf(ha));return t=t.substring(t.lastIndexOf("/")+1),t},"/embico/twitter.png"];var pa;function ma(e,t,n,i){pa||(pa="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:pa,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ga(e){const t=e.lastIndexOf(":");return-1!==t?e.substring(0,t):e}const wa="/@",ya=e=>{let t,{url:n}=e,i=n.indexOf(wa);return-1!==i?t=n.substring(n.indexOf("/",i+wa.length)+1):(i=n.indexOf("//"),-1===i&&(i=0),t=n.substring(n.indexOf("/",i+2)+1)),t=ga((0,y._N)(t)),ma("div",{className:"vemb",style:{paddingBottom:"56.25%"}},void 0,ma("iframe",{className:"vembc",src:`https://odysee.com/$/embed/${t}`,frameBorder:"0",referrerPolicy:"no-referrer",allow:"autoplay; picture-in-picture",scrolling:"no",sandbox:"allow-scripts allow-modals allow-forms allow-popups allow-same-origin allow-presentation",allowFullScreen:!0,title:"Embedded odysee"}))},ba=[xe.memo(ya),e=>{const t=(0,y._N)(e);let n=t.indexOf(wa);return-1!==n?!(-1===n||n+4>=t.length||(n=t.indexOf("/",n+wa.length),-1===n||n+2>=t.length)):(n=t.indexOf("//"),-1===n&&(n=0),n=t.indexOf("/",n+2),!(-1===n||n+2>=t.length))},e=>{let t=(0,y._N)(e),n=t.indexOf(wa);if(-1!==n){t=t.substring(n+wa.length);let e=t.substring(0,t.indexOf("/"));return t=ga(t.substring(e.length+1)),e=ga(e),`${e} | ${t}`}return n=t.indexOf("//"),-1===n&&(n=0),t=t.substring(t.indexOf("/",n+2)+1),t=ga((0,y._N)(t)),t},"/embico/odysee.png"];var Sa;function ka(e,t,n,i){Sa||(Sa="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Sa,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ca=["webm","mp4"],Ea=["jpg","jpeg","png","webp","gif"],Ta=e=>{let{url:t}=e;const n=(0,y.r6)(t);return Ca.includes(n)?ka("div",{className:"vemb"},void 0,ka("video",{className:"vembc",controls:!0,autoPlay:!0,src:t,referrerPolicy:"no-referrer"})):ka("img",{alt:`Matrix ${t}`,src:t,style:{maxWidth:"100%"},referrerPolicy:"no-referrer"})},xa=[xe.memo(Ta),e=>{const t=(0,y.r6)(e);return Ca.includes(t)||Ea.includes(t)},null,"/embico/direct.png"],Ia={tiktok:Qs,youtube:ia,"youtu.be":ia,"matrix.pixelplanet.fun":aa,"i.4cdn.org":xa,"i.imgur":xa,"litter.catbox.moe":xa,"files.catbox.moe":xa,"i.redd.it":xa,"media.discordapp.net":xa,"media.consumeproduct.win":xa,"cdn.discord.com":xa,"t.me":da,twitter:va,"nitter.net":va,odysee:ba};var Na,_a,Aa;function Pa(e,t,n,i){Aa||(Aa="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Aa,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Oa=["odysee","twitter","matrix.pixelplanet.fun","youtube","youtu.be","t.me"],La=e=>{let{href:t,title:n,refEmbed:i}=e;const[o,r]=(0,xe.useState)(!1),s=(0,y.IU)(t);if(s===window.location.hostname&&t.includes("/#")){const e=t.substring(t.indexOf("/#")+1);return We()&&window.opener&&!window.opener.closed?Pa("a",{href:`/${e}`,target:"main"},void 0,n||e):Pa("a",{href:`/${e}`},void 0,n||e)}const a=Ia[s],l=a&&a[1](t),c=a&&a[0];let u;return u=n&&Oa.includes(s)?n:l&&a[2]?a[2](t):t,xe.createElement(xe.Fragment,null,Pa("a",{href:t,target:"_blank",rel:"noopener noreferrer"},void 0,u),l&&xe.createElement(xe.Fragment,null," ",a[3]&&Pa("img",{style:{width:"1em",height:"1em",verticalAlign:"middle"},src:a[3],alt:`${s}-icon`}),Pa("span",{style:{cursor:"pointer"},onClick:()=>r(!o)},void 0,o?Na||(Na=Pa(qs.TQH,{className:"ebcl"})):_a||(_a=Pa(qs.uwt,{className:"ebex"})))),o&&l&&(i&&i.current?$s.createPortal(Pa(c,{url:t}),i.current):Pa(c,{url:t})))},Ra=xe.memo(La);var Da;function $a(e,t,n,i){Da||(Da="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Da,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ma=e=>{let{name:t,uid:n}=e;const i=n&&n.trim(),o=(0,Ie.v9)((e=>-1!==e.gui.style.indexOf("dark")));return $a("span",{className:i==(0,Ie.v9)((e=>e.user.id))?"ping":"mention",style:{color:(0,y.TP)((0,y.Z)(t),o)}},void 0,`@${t}`)},za=xe.memo(Ma);var Ha;function Wa(e,t,n,i){Ha||(Ha="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Ha,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ua=xe.memo((e=>{let{pArray:t,refEmbed:n}=e;return t.map((e=>{if(!Array.isArray(e))return e;const t=e[0];switch(t){case"c":return Wa("code",{},void 0,e[1]);case"*":return Wa("strong",{},void 0,Wa(Ua,{pArray:e[1]}));case"~":return Wa("s",{},void 0,Wa(Ua,{pArray:e[1]}));case"+":return Wa("em",{},void 0,Wa(Ua,{pArray:e[1]}));case"_":return Wa("u",{},void 0,Wa(Ua,{pArray:e[1]}));case"img":case"l":return Wa(Ra,{refEmbed:n,href:e[2],title:e[1]});case"@":return Wa(za,{uid:e[2],name:e[1]});default:return t}}))}));var Ga=n(8634);class Fa{constructor(e,t){this.txt=e,this.iter=t||0}done(){return this.iter>=this.txt.length}moveForward(){return this.iter+=1,this.iter<this.txt.length}setIter(e){this.iter=e}getChar(){return this.txt[this.iter]}slice(e,t){return this.txt.slice(e,t||this.iter)}has(e){return this.txt.startsWith(e,this.iter)}move(e){return this.iter+=e,this.iter<this.txt.length}skipSpaces(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(;this.iter<this.txt.length;this.iter+=1){const t=this.txt[this.iter];if(" "!==t&&"\t"!==t&&(!e||"\n"!==t))break}}countRepeatingCharacters(){const e=this.getChar();let t=this.iter+1;for(;t<this.txt.length&&this.txt[t]===e;t+=1);return t-this.iter}moveToNextLine(){const e=this.txt.indexOf("\n",this.iter);this.iter=-1===e?this.txt.length:e+1}getLine(){const e=this.iter;return this.moveToNextLine(),this.txt.slice(e,this.iter)}getIndent(e){let t=0;for(;this.iter<this.txt.length;){const n=this.getChar();if("\t"===n)t+=e;else{if(" "!==n)break;t+=1}this.iter+=1}return t}goToCharInLine(e){let{iter:t}=this;for(;t<this.txt.length&&"\n"!==this.txt[t]&&this.txt[t]!==e;t+=1);return this.txt[t]===e&&(this.iter=t,t)}static isWhiteSpace(e){return" "===e||"\t"===e||"\n"===e}checkIfEnclosure(e){let t=this.iter+1,n=t;const i=[];for(;"]"!==this.txt[n];){const e=this.txt[n];if("\\"!==e){if(n>=this.txt.length||"\n"===e)return null;n+=1}else i.push(n),n+=2}let o=n+1;if("("!==this.txt[o])return null;o+=1;let r=o,s=null;for(;")"!==this.txt[r];){const t=this.txt[r];if(r>=this.txt.length||"\n"===t||"["===t||"("===t)return null;if(e&&":"===t){const e=this.iter;if(this.iter=r,s=this.checkIfLink(!0),r=this.iter,this.iter=e,null===s)return null}else r+=1}if(r<o+1||!s&&e)return null;e||(s=this.txt.slice(o,r));let a="";for(let e=0;e<i.length;e+=1){const n=i[e];a+=this.txt.slice(t,n),t=n+1}return t<n&&(a+=this.txt.slice(t,n)),this.iter=r,[a,s]}checkIfLink(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.iter;if(!this.txt.startsWith("://",t)||t<3)return null;let n=t-1;for(;n>=0&&!Fa.isWhiteSpace(this.txt[n])&&"("!==this.txt[n];n-=1);for(n+=1,t+=3;t<this.txt.length&&!Fa.isWhiteSpace(this.txt[t])&&(!e||")"!==this.txt[t]);t+=1);if(t<this.iter+4)return null;let i=this.txt.slice(n,t);const o=i.indexOf("http");return-1!==o&&0!==o&&(n+=o,i=this.txt.slice(n,t)),this.iter=t,i}checkIfCoords(){let e=this.iter+1;for(;e<this.txt.length;){const t=this.txt[e];if(","===t)break;if(Fa.isWhiteSpace(t)||!Number.isNaN(Number(t)))return null;e+=1}if(e>=this.txt.length||e-this.iter>12||e===this.iter)return null;e+=1;const t=this.txt[e];if("-"!==t&&Number.isNaN(t))return null;e+=1;let n=1;for(;e<this.txt.length&&!Fa.isWhiteSpace(this.txt[e]);){const t=this.txt[e];if(","===t)n+=1;else if("-"!==t&&Number.isNaN(Number(t)))return null;e+=1}if(n<2||n>3||","===this.txt[e-1])return null;const i=this.txt.slice(this.iter,e);return this.iter=e,i}}let Va=()=>{};const Za=["*","~","+","_"];function Ka(e,t,n){const i=[];let o=e.iter,r=null;for(;!e.done()&&(r=e.getChar(),r!==n);){if("\n"===r){e.moveForward();break}if("\\"===r)o!==e.iter&&i.push(e.slice(o)),o=e.iter+1,e.moveForward();else if("#"===r){const t=e.iter,n=e.checkIfCoords();n&&(o!==t&&i.push(e.slice(o,t)),i.push(["l",null,`${window.location.origin}/${n}`]),o=e.iter)}else if(Za.includes(r)){const n=e.iter;e.moveForward();const s=Ka(e,t,r);e.getChar()===r?(o!==n&&i.push(e.slice(o,n)),i.push([r,s]),o=e.iter+1):e.setIter(n)}else if("`"===r){const t=e.iter;e.moveForward(),e.goToCharInLine("`")&&(o!==t&&i.push(e.slice(o,t)),i.push(["c",e.slice(t+1)]),o=e.iter+1)}else if(":"===r){const t=e.checkIfLink();if(null!==t){const n=e.iter-t.length;o<n&&i.push(e.slice(o,n)),i.push(["l",null,t]),o=e.iter;continue}}else if("["===r){let t=e.iter,n=null;e.iter>0&&(e.move(-1),n=e.getChar(),e.setIter(t));let r="l",s=!0;"!"===n?(r="img",t-=1):"@"===n&&(s=!1,r="@",t-=1);const a=e.checkIfEnclosure(s);null!==a&&(o<t&&i.push(e.slice(o,t)),i.push([r,a[0],a[1]]),o=e.iter+1)}e.moveForward()}return o!==e.iter&&i.push(e.slice(o)),i}function Ba(e){e.skipSpaces(!1),"\n"===e.getChar()&&e.moveForward();const t=e.iter;for(;!e.done();){if(e.skipSpaces(!0),e.has("```")){const n=["cb",e.slice(t)];return e.move(3),n}e.moveToNextLine()}const n=e.slice(t);return e.move(3),["cb",n]}function ja(e,t){const n=e.getChar();let i="";for(;e.getChar()===n&&e.moveForward();)i+=e.getLine();const o=new Fa(i);return[n,Va(o,t,0)]}function qa(e,t,n,i){const o=[];let r=[],s=0;for(;!e.done();){const a=e.iter;s+=1;const l=e.getIndent(t.tabWidth);if(l<i&&s>1){e.setIter(a);break}const c=e.getChar();if(!i&&"#"===c)break;let u=!1,d=!1;if("-"===c&&(u=!0,e.moveForward()),!Number.isNaN(parseInt(c,10))){let t=e.iter+1;for(;!Number.isNaN(parseInt(e.txt[t],10));t+=1);const n=e.txt[t];"."!==n&&")"!==n||(d=!0,e.setIter(t+1))}let h=!1,f=null;if(u||d){let i;r.length&&(o.push(["p",r]),r=[]),i=qa(e,t,n,l+1),i=["-",i];const s=u?"ul":"ol";o.length&&o[o.length-1][0]===s?o[o.length-1][1].push(i):o.push([s,[i]])}else if(">"===c||"<"===c)h=!0,f=ja(e,t);else if(e.has("```"))h=!0,e.move(3),f=Ba(e);else{if(i||"\n"!==c){const n=Ka(e,t);n&&(r=r.concat(n));continue}if(e.moveForward(),e.skipSpaces(!1),"\n"===e.getChar()){if(n&&t.newlineBreaksArticles)break;e.moveForward()}h=!0}h&&r.length&&(o.push(["p",r]),r=[]),f&&o.push(f)}return r.length&&o.push(["p",r]),o}var Ya;function Xa(e,t,n,i){Ya||(Ya="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Ya,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Qa(e){let{name:t,uid:n,country:i,msg:o,ts:r,openCm:s}=e;const a=(0,Ie.v9)(Ga.s),l=(0,xe.useRef)(),c="info"===t,u="event"===t;let d="msg";c?d+=" info":u?d+=" event":">"===o.charAt(0)?d+=" greentext":"<"===o.charAt(0)&&(d+=" redtext");const h=function(e,t){const n=function(e){const t={};return t.parseLinks=e&&e.parseLinks||!1,t.tabWidth=e&&e.tabWidth||4,t.newlineBreaksArticles=e&&e.newlineBreaksArticles||!0,t}(void 0);return Ka(new Fa(e),n)}(o);return xe.createElement("li",{className:"chatmsg",ref:l},Xa("div",{className:"msgcont"},void 0,Xa("span",{className:d},void 0,!c&&!u&&Xa(xe.Fragment,{},"name",Xa("img",{className:"chatflag",alt:"",title:i,src:`/cf/${i}.gif`}),Xa("span",{className:"chatname",style:{color:(0,y.TP)((0,y.Z)(t),a),cursor:"pointer"},role:"button",title:t,tabIndex:-1,onClick:e=>{s(e.clientX,e.clientY,t,n)}},void 0,t),": "),Xa(Ua,{refEmbed:l,pArray:h})),Xa("span",{className:"chatts"},void 0,(0,y.tF)(r))))}Va=(e,t,n)=>{let i=[];for(;!e.done();){const o=qa(e,t,n,0);if(i=i.concat(o),"#"!==e.getChar())break;{let o=e.countRepeatingCharacters();if(o<=n||6===n)break;{e.move(o);const n=e.getLine();o=Math.min(o,6);const r=Va(e,t,o);i.push(["a",o,n,r])}}}return i};const Ja=xe.memo(Qa);var el,tl,nl,il,ol;function rl(e,t,n,i){ol||(ol="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:ol,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const sl=e=>{let{setChatChannel:t,chatChannel:n}=e;const[i,o]=(0,xe.useState)(!1),[r,s]=(0,xe.useState)([]),[a,l]=(0,xe.useState)(0),[c,u]=(0,xe.useState)(0),[d,h]=(0,xe.useState)(!1),[f,v]=(0,xe.useState)("..."),[p,m]=(0,xe.useState)(!1),g=(0,xe.useRef)(null),w=(0,xe.useRef)(null),y=(0,Ie.v9)((e=>e.chatRead.unread)),b=(0,Ie.v9)((e=>e.chatRead.mute)),S=(0,Ie.v9)((e=>e.chat.channels)),k=(0,Ie.v9)((e=>e.gui.chatNotify));return(0,xe.useEffect)((()=>{u(w.current.clientHeight)}),[w]),function(e,t,n){const i=(0,xe.useCallback)((t=>{e.every((e=>!e.current||!e.current.contains(t.target)))&&n()}),[n]),o=(0,xe.useCallback)((()=>{n()}),[n]);(0,xe.useLayoutEffect)((()=>{t?(document.addEventListener("mousedown",i,{capture:!0}),window.addEventListener("resize",o)):(document.removeEventListener("mousedown",i,{capture:!0}),window.removeEventListener("resize",o))}),[t,n])}([g],i,(0,xe.useCallback)((()=>o(!1)),[])),(0,xe.useEffect)((()=>{if(i&&S[n]){const e=1===S[n][1]?1:0;l(e)}}),[i]),(0,xe.useEffect)((()=>{const e=Object.keys(S),t=[];let n=0;for(;n<e.length;){const i=e[n],o=y[i]&&!b.includes(i);t.push([i,o,...S[i]]),!d&&0!==S[i][1]&&o&&h(!0),n+=1}t.sort(((e,t)=>0===e[3]||0===t[3]?0:e[4]>t[4]?-1:t[4]>e[4]?1:0)),t.sort(((e,t)=>0===e[3]||0===t[3]?0:e[1]&&!t[1]?-1:t[1]&&!e[1]?1:0)),s(t),n===e.length&&h(!1)}),[S,y]),(0,xe.useEffect)((()=>{const e=Object.keys(S);for(let t=0;t<e.length;t+=1)if(1===S[e[t]][1])return void m(!0);m(!1)}),[S]),(0,xe.useEffect)((()=>{S[n]&&v(S[n][0])}),[n,S]),rl("div",{style:{position:"relative"}},void 0,xe.createElement("div",{ref:w,key:"expbtn",role:"button",tabIndex:-1,onClick:()=>o(!0),className:"channelbtn"+(i?" selected":"")},d&&k&&!i&&rl("div",{style:{top:-4},className:"chnunread"},void 0,"⦿"),f),i&&xe.createElement("div",{ref:g,key:"dropdown",style:{position:"absolute",bottom:c,right:9},className:"channeldd"},rl("div",{className:"chntop"},void 0,rl("span",{style:{borderLeft:"none"},className:"chntype"+(0===a?" selected":""),onClick:()=>l(0),role:"button",tabIndex:-1},void 0,el||(el=rl(ct.Fmx,{}))),p&&rl("span",{className:"chntype"+(1===a?" selected":""),onClick:()=>l(1),role:"button",tabIndex:-1},void 0,d&&k&&1!==a&&(tl||(tl=rl("div",{className:"chnunread"},void 0,"⦿"))),nl||(nl=rl(Me.wN,{})))),rl("div",{className:"channeldds"},void 0,r.filter((e=>{const t=e[3];return 1===a&&1===t||0===a&&1!==t})).map((e=>{const[i,o,r]=e;return rl("div",{onClick:()=>t(i),className:"chn"+(i===n?" selected":""),role:"button",tabIndex:-1},i,o&&k?il||(il=rl("div",{className:"chnunread"},void 0,"⦿")):null,r)})))))},al=xe.memo(sl);var ll;function cl(e,t,n,i){ll||(ll="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:ll,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var ul,dl,hl;function fl(e,t,n,i){hl||(hl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:hl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vl={display:"inline-block",width:"100%",maxWidth:"35em"},pl=()=>{const[e,t]=(0,xe.useState)(""),[n,i]=(0,xe.useState)(!1),[o,r]=(0,xe.useState)(!1),[s,a]=(0,xe.useState)([]),l=Be();return o?fl("div",{},void 0,fl("p",{className:"modalmessage"},void 0,"Sendete eine E-Mail mit Instruktionen um das Passwort zurückzusetzen."),fl("button",{type:"button",onClick:()=>l("USERAREA")},void 0,"Back")):fl("div",{className:"content"},void 0,fl("p",{},void 0,"Gib deine Mail Adresse an und wir senden dir ein neues Passwort:"),ul||(ul=fl("br",{})),fl("form",{onSubmit:async t=>{if(t.preventDefault(),n)return;const o=function(e){const t=[],n=Po(e);return n&&t.push(n),t}(e);if(o.length>0)return void a(o);i(!0);const{errors:s}=await(0,U.hH)(e);i(!1),s?a(s):r(!0)}},void 0,s.map((e=>fl("p",{},e,fl("span",{},void 0,"Fehler"),": ",e))),fl("input",{style:vl,value:e,onChange:e=>t(e.target.value),type:"text",placeholder:"Email"}),dl||(dl=fl("br",{})),fl("button",{type:"submit"},void 0,n?"...":"Absenden"),fl("button",{type:"button",onClick:()=>l("USERAREA")},void 0,"Abbrechen")))},ml={HELP:[()=>{const e=vo("kbd",{},void 0,"G"),t=vo("kbd",{},void 0,"X"),n=vo("kbd",{},void 0,"H"),i=vo("kbd",{},void 0,"R"),o=vo("kbd",{},void 0,"Q"),r=vo("kbd",{},void 0,"E"),s=vo("kbd",{},void 0,"W"),a=vo("kbd",{},void 0,"A"),l=vo("kbd",{},void 0,"S"),c=vo("kbd",{},void 0,"D"),u=Ei||(Ei=vo("kbd",{},void 0,"↑")),d=Ti||(Ti=vo("kbd",{},void 0,"←")),h=xi||(xi=vo("kbd",{},void 0,"↓")),f=Ii||(Ii=vo("kbd",{},void 0,"→")),v=Ni||(Ni=vo("kbd",{},void 0,vo(bi.nI7,{}))),p=_i||(_i=vo("kbd",{},void 0,vo(ct.EGB,{}))),m=vo("kbd",{},void 0,"⇧ ","Shift"),g=vo("kbd",{},void 0,"C"),w=Ai||(Ai=vo("a",{href:"https://twitter.com/starhousedev"},void 0,"starhouse ")),y=Pi||(Pi=vo("a",{href:"https://twitter.com/Vinikdev"},void 0,"Vinikdev")),b=Oi||(Oi=vo("a",{href:"https://pixelplanet.fun/guilded"},void 0,"guilded")),S=Li||(Li=vo("a",{href:"mailto:admin@pixelplanet.fun"},void 0,"admin@pixelplanet.fun"));return vo("div",{className:"content"},void 0,vo("p",{},void 0,"Zeichne gemeinsam mit anderen Spielern auf einer großen Leinwand online!",Ri||(Ri=vo("br",{})),"Unsere Standardleinwand ist eine große Weltkarte. Pixel können überall gesetzen werden, aber es kann nur eine begrenzte Anzahl and Pixels per Zeit platziert werden. Die Vorraussetzungen und die Wartezeit sind im Auswahlmenu zu sehen (Globus Taste am oberen Bildschirmrand). Manche Leinwände haben eine niedrigere Wartezeit für ungesetzte Pixel im Vergleich zu von anderen Spielern gesetzte Pixel. z.B. 4s/7s heißt dass man 4s für jedes neue Pixel warten muss, allerdings 7s wenn man über ein Pixel eines anderen Spielers setzt.",Di||(Di=vo("br",{})),"Die höheren Zoomlevel brauchen etwas Zeit um aktualisiert zu werden, der 3D Globus wird mindestens einmal pro tag neu geladen.",$i||($i=vo("br",{})),"Viel Spaß!"),vo("p",{className:"modalinfo"},void 0,"Guilded (","empfohlen","): ",Mi||(Mi=vo("a",{href:"./guilded",target:"_blank",rel:"noopener noreferrer"},void 0,"pixelplanet.fun/guilded"))),vo("p",{className:"modalinfo"},void 0,"Quelltext auf ",zi||(zi=vo("a",{href:"https://git.pixelplanet.fun",target:"_blank",rel:"noopener noreferrer"},void 0,"git.pixelplanet.fun"))),vo("h3",{},void 0,"Karten Dateien"),vo("p",{},void 0,"Die Kartendaten welche wir benutzen, zusammen mit konvertierten OpenStreetMap  Kacheln zur orientierung können auf mega.nz heruntergeladen werden: ",Hi||(Hi=vo("a",{href:"https://mega.nz/#!JpkBwAbJ!EnSLlZmKv3kEBE0HDhakTgAZZycD3ELjduajJxPGaXo"},void 0,"pixelplanetmap.zip"))," (422MB)"),vo("h3",{},void 0,"Verbannt? Als Proxy erkannt?"),vo("div",{},void 0,vo("p",{},void 0,["Solltest do als Proxy erkannt sein, aber du benutzt keines, oder du glaubst zu Unrecht verbannt worden zu sein, bitte kontaktiere uns auf ",b," oder sende uns eine Mail  ",S," und gib diese IID an: "]),Wi||(Wi=vo(Ci,{}))),vo("h3",{},void 0,"2D ","Steuerung"),vo("div",{style:{lineHeight:1.5}},void 0,"Klicke auf eine Farbe in der Palette um sie auszuwählen",Ui||(Ui=vo("br",{})),["Drücke ",e," um das Raster ein- und auszuschalten"],Gi||(Gi=vo("br",{})),["Drücke ",t," um Pixel Aktivität anzuzeigen"],Fi||(Fi=vo("br",{})),["Drücke ",n," um zur historischen Ansicht zu wechseln"],Vi||(Vi=vo("br",{})),["Drücke ",i," um aktuelle Koordinaten zu kopieren"],Zi||(Zi=vo("br",{})),["Drücke ",o," oder ",r," um zu zoomen"],Ki||(Ki=vo("br",{})),["Drücke ",s,", ",a,", ",l,", ",c," zum navigieren"],Bi||(Bi=vo("br",{})),["Drücke ",u,", ",d,", ",h,", ",f," zum navigieren"],ji||(ji=vo("br",{})),["Ziehe mit der ",v," Maus oder ",p," wische zum navigieren"],qi||(qi=vo("br",{})),["Scrolle ",v," mit them Mausrad oder ",p," benutze Zwei-Finger-Zoom um zu zoomen"],Yi||(Yi=vo("br",{})),["Halte die linke ",m," Taste gedrückt um Pixel unter der Maus zu setzen"],Xi||(Xi=vo("br",{})),["Halte die rechte ",m," Taste gedrückt um Pixel unter der Maus nach der aktuellen historischen Ansicht zu setzen"],Qi||(Qi=vo("br",{})),[v," Linksklick oder ",p," tippe um ein Pixel zu platzieren"],Ji||(Ji=vo("br",{})),["Klicke ",v," die mittlere Maustaste oder ",p," tippe lange um eine Farbe von der Leinwand auszuwählen"],eo||(eo=vo("br",{}))),vo("h3",{},void 0,"3D ","Steuerung"),vo("div",{style:{lineHeight:1.5}},void 0,["Drücke ",s,", ",a,", ",l,", ",c," zum navigieren"],to||(to=vo("br",{})),["Drücke ",u,", ",d,", ",h,", ",f," zum navigieren"],no||(no=vo("br",{})),["Drücke ",r," oder ",g," um hoch und runter zu fliegen"],io||(io=vo("br",{})),[v," Halte die linke Maustaste gedrückt und ziehe um zu rotieren"],oo||(oo=vo("br",{})),[v," Scrolle mit dem Mausrad oder halte ",v," die mittlere Maustaste gedrückt und ziehe um zu zoomen"],ro||(ro=vo("br",{})),[v," Halte die rechte Maustaste gedrückt und ziehe um dich zu bewegen"],so||(so=vo("br",{})),[v," Linksklick oder ",p," tippe um ein Pixel zu platzieren"],ao||(ao=vo("br",{})),[v," Rechtsklick oder ",p," tippe zweimal um ein Voxel zu entfernen"],lo||(lo=vo("br",{})),["Klicke ",v," die mittlere Maustaste oder ",p," tippe lange um eine Farbe von der Leinwand auszuwählen"],co||(co=vo("br",{}))),uo||(uo=vo("h3",{},void 0,"Palette Credits")),vo("div",{},void 0,["Wir bedanken uns bei diesen Künstlern für ihre Paletten, welche sie der Öffentlichkeit zugänglich machten auf"]," ",ho||(ho=vo("a",{href:"https://lospec.com/"},void 0,"lospec.com")),vo("p",{},void 0,["Vielen Dank an ",w," für die Palette der Mond Leinwand."]),vo("p",{},void 0,["Vielen Dank an ",y," für die Palette der Top10 Leinwand."])))},"Hilfe"],SETTINGS:[_o,"Einstellungen"],USERAREA:[rs,"Spielerbereich"],REGISTER:[cs,"Registrieren"],FORGOT_PASSWORD:[xe.memo(pl),"Passwort vergessen"],CHAT:[()=>{const e=(0,xe.useRef)(),t=(0,xe.useRef)(),n=(0,xe.useRef)(),[i,o]=(0,xe.useState)([]),[a,l]=(0,xe.useState)(20),[c,u]=(0,xe.useState)({}),d=(0,Ie.I0)(),h=(0,Ie.v9)((e=>e.user.name)),f=(0,Ie.v9)((e=>e.fetching.fetchingChat)),{channels:v,messages:p,blocked:m}=(0,Ie.v9)((e=>e.chat)),{args:g,setArgs:w,setTitle:y}=(0,xe.useContext)(Ze),{chatChannel:b=1}=g,S=Be(),k=(0,xe.useCallback)((e=>{d((0,r.Eo)(e)),w({chatChannel:Number(e)})}),[d]),C=(0,xe.useCallback)((e=>{const t=n.current;if(!t)return;let i=t.value;" "!==i.slice(-1)&&(i+=" "),i+=`${e} `,t.value=i,n.current.focus()}),[]),E=(0,xe.useCallback)((()=>{u({})}),[]),T=(0,xe.useCallback)(((e,t,n,i)=>{u({type:"USER",x:e,y:t,args:{name:n,uid:i,setChannel:k,addToInput:C}})}),[k,C]),{stayScrolled:x}=(0,Ds.Z)(e,{initialScroll:1/0,inaccuracy:10}),I=p[b]||[];return(0,xe.useEffect)((()=>{!v[b]||p[b]||f||d((0,s.TL)(b))}),[v,p,b]),(0,xe.useEffect)((()=>{if(v[b]){const e=v[b][0];y(`Chan: ${e}`)}}),[b]),(0,xe.useLayoutEffect)((()=>{x()}),[I.length]),(0,xe.useEffect)((()=>{setTimeout((()=>{const e=Math.round(t.current.offsetHeight/10);l(Math.min(28,e))}),330)}),[t]),(0,xe.useEffect)((()=>{const e=[];for(let t=0;t<m.length;t+=1)e.push(m[t][0]);o(e)}),[m.length]),(0,xe.useEffect)((()=>{if(!b||!v[b]){const e=Object.keys(v);e.length&&k(e[0])}}),[v]),xe.createElement("div",{ref:t,className:"chat-container"},cl(Ks,{type:c.type,x:c.x,y:c.y,args:c.args,close:E,align:c.align}),xe.createElement("ul",{className:"chatarea",ref:e,style:{flexGrow:1},role:"presentation"},!I.length&&cl(Ja,{uid:0,name:"info",country:"xx",msg:"Beginne hier zu unterhalten"}),I.map((e=>i.includes(e[3])?null:cl(Ja,{name:e[0],msg:e[1],country:e[2],uid:e[3],ts:e[4],openCm:T},e[5])))),cl("form",{className:"chatinput",onSubmit:e=>function(e){e.preventDefault();const t=n.current.value.trim();t&&(d((0,r.bE)(t,b)),n.current.value="")}(e),style:{display:"flex"}},void 0,h?cl(xe.Fragment,{},"chtipt",xe.createElement("input",{style:{flexGrow:1,minWidth:40},ref:n,autoComplete:"off",maxLength:"200",type:"text",placeholder:"Chatte hier"}),cl("button",{id:"sendbtn",style:{flexGrow:0},type:"submit"},void 0,"‣")):cl("div",{className:"modallink",onClick:e=>{e.stopPropagation(),S("USERAREA",{target:"fullscreen"})},style:{textAlign:"center",fontSize:13,flexGrow:1},role:"button",tabIndex:0},"nlipt","Melde dich an um dich zu unterhalten"),cl(al,{setChatChannel:k,chatChannel:b},"cdd")),cl("div",{className:"chatlink",style:{fontSize:a}},void 0,cl("span",{onClick:e=>{const{clientX:t,clientY:n}=e;u({type:"CHANNEL",x:t,y:n,args:{cid:b},align:"tr"})},role:"button",title:"Kanal Einstellungen",tabIndex:-1},void 0,"⚙")))},"Unterhaltung"],CANVAS_SELECTION:[xs,"Leinwand auswahl"],ARCHIVE:[()=>Os("div",{className:"content"},void 0,Os("p",{},void 0,"Wir versuchen so wenig wie möglich Leinwände zu entfernen. Manche werden allerding aus Spaß gestarted oder von Spielern angefragt oder sind nur Memes. Diese Leinwände können nach einiger Zeit langweilig werden und nach Wochen ohne erwähnenswerte Aktivität und falls sie es wirklich nicht wert sind, behalten zu werden, entscheiden wir uns side zu entfernen.",Is||(Is=Os("br",{})),"Hier sammeln wir vergangene Leinwände um sie ordentlich zu archivieren (zur Zeit nur eine)."),Os("h3",{},void 0,"Politischer Kompass Leinwand"),Ns||(Ns=Os("img",{style:Ls,alt:"political-compass",src:"https://storage.pixelplanet.fun/compass-preview.png"})),Os("p",{},void 0,"Diese Leinwand wurde zu Zeiten politscher Konlikte auf der Erd-Leinwand gestarted. Es war eine 1024x1024 Abbildung des politischen Kompass mit 5s Abklingzeit und 60s gesamter Wartezeit. Es wurde am 11. Mai 2020 gestartet und war für Monate aktiv bis es am 30. November geschlossen wurde.",_s||(_s=Os("br",{})),"Wir haben uns entschieden sie in der Form eines Zeitraffers in verlustfrei kodiertes webm zu archivieren. Eine Bildschirmaufnahme aus dem Video ergibt eine perfekte 1:1 Abbildung der Leinwand zu dieser Zeit."),As||(As=Os("p",{className:"modalinfo"},void 0,"Timelapse:",Os("a",{href:"https://storage.pixelplanet.fun/compass-timelapse.webm"},void 0,"Download"))),Os("img",{style:{padding:2,maxWidth:"80%",verticalAlign:"middle"},alt:"political-compass",src:"https://storage.pixelplanet.fun/compass-final.png"})),"Leinwand Archiv"]};var gl,wl,yl;function bl(e,t,n,i){yl||(yl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:yl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Sl=e=>{let{id:t}=e;const[n,i]=(0,xe.useState)(!1),o=(0,xe.useRef)(),r=(0,xe.useRef)(),s=(0,xe.useMemo)((()=>{return e=t,(0,fi.P1)(vi,(t=>t.find((t=>t.windowId===e))));var e}),[]),a=(0,xe.useMemo)((()=>{return e=t,t=>t.windows.positions[e];var e}),[]),l=(0,xe.useMemo)((()=>{return e=t,t=>t.windows.args[e]||{};var e}),[]),c=(0,Ie.v9)(s),u=(0,Ie.v9)(a),d=(0,Ie.v9)(pi),h=(0,Ie.v9)(l),f=(0,Ie.I0)(),v=(0,xe.useMemo)((()=>({args:h,setArgs:e=>f(function(e,t){return{type:"SET_WIN_ARGS",windowId:e,args:t}}(t,e)),setTitle:e=>f(function(e,t){return{type:"SET_WIN_TITLE",windowId:e,title:t}}(t,e)),changeType:(e,n,i)=>f(function(e,t){return{type:"CHANGE_WIN_TYPE",windowId:e,windowType:t,title:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",args:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null}}(t,e,n,i))})),[t,h]),{open:p,hidden:m,fullscreen:g}=c,w=(0,xe.useCallback)((()=>{f({type:"FOCUS_WIN",windowId:t})}),[f]),y=(0,xe.useCallback)((e=>{e.stopPropagation(),f({type:"CLONE_WIN",windowId:t})}),[f]),b=(0,xe.useCallback)((()=>{i(!1)}),[f]),S=(0,xe.useCallback)((e=>{e.stopPropagation(),f({type:"CLOSE_WIN",windowId:t})}),[f]),{xPos:k,yPos:C,width:E,height:T}=u;wi(o,w,(0,xe.useCallback)(((e,n)=>f(function(e,t,n){return{type:"MOVE_WIN",windowId:e,xDiff:t,yDiff:n}}(t,e,n))),[g,!n&&m])),wi(r,w,(0,xe.useCallback)(((e,n)=>f(function(e,t,n){return{type:"RESIZE_WIN",windowId:e,xDiff:t,yDiff:n}}(t,e,n))),[g,!n&&m]));const x=(0,xe.useCallback)((()=>{m&&i(!1),p?n||m||(f({type:"TGL_MAXIMIZE_WIN",windowId:t}),setTimeout((()=>i(!0)),10)):f({type:"REMOVE_WIN",windowId:t})}),[f,m,p,n]);if((0,xe.useEffect)((()=>{p&&!m&&window.setTimeout((()=>{i(!0)}),10)}),[p,m]),!n&&(m||!p))return null;const{title:I,windowType:N}=c,{z:_}=u,[A,P]=ml[N],O=I?`${P} - ${I}`:P,L=`${N}${p&&!m&&n?" show":""}`;return g?bl("div",{className:`modal ${L}`,onTransitionEnd:x,onClick:w,style:{zIndex:_}},void 0,bl("h2",{},void 0,O),bl("div",{onClick:S,className:"modal-topbtn close",role:"button",label:"close",title:"Schließen",tabIndex:-1},"closebtn","✕"),Ge.includes(N)&&bl("div",{onClick:e=>{Ke(N,h,k,C,E,T),S(e)},className:"modal-topbtn pop",role:"button",label:"close",title:"PopUp",tabIndex:-1},"popbtn",gl||(gl=bl(hi.srV,{}))),d&&bl("div",{onClick:b,className:"modal-topbtn restore",role:"button",label:"restore",title:"Wiederherstellen",tabIndex:-1},"resbtn","↓"),bl("div",{className:"modal-content"},"content",bl(Ze.Provider,{value:v},void 0,bl(A,{})))):bl("div",{className:`window ${L}`,onTransitionEnd:x,onClick:w,style:{left:k,top:C,width:E,height:T,zIndex:_}},void 0,bl("div",{className:"win-topbar"},"topbar",bl("span",{className:"win-topbtn",onClick:y,title:"Klonen"},"clonebtn","+"),xe.createElement("span",{className:"win-title",key:"title",ref:o,title:"Verschieben"},O),Ge.includes(N)&&bl("span",{className:"win-topbtn",onClick:e=>{Ke(N,h,k,C,E,T),S(e)}},"pobtnm",wl||(wl=bl(hi.srV,{}))),bl("span",{className:"win-topbtn",onClick:b,title:"Maximieren"},"maxbtn","↑"),bl("span",{className:"win-topbtn close",onClick:S,title:"Schließen"},"closebtn","X")),xe.createElement("div",{className:"win-resize",key:"winres",title:"Größe ändern",ref:r},"▨"),bl("div",{className:"win-content"},"content",bl(Ze.Provider,{value:v},void 0,bl(A,{}))))},kl=xe.memo(Sl);var Cl;function El(e,t,n,i){Cl||(Cl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:Cl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tl=()=>{const e=(0,Ie.v9)(gi,Ie.wU),[t,n]=(0,Ie.v9)(mi,Ie.wU),i=(0,Ie.I0)();return t&&e.length?El("div",{id:"wm"},void 0,El(On,{show:n,onClick:()=>i({type:"CLOSE_FULLSCREEN_WINS"})}),e.map((e=>El(kl,{id:e},e)))):null};var xl,Il,Nl,_l;function Al(e,t,n,i){_l||(_l="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),1===r)t.children=i;else if(r>1){for(var s=new Array(r),a=0;a<r;a++)s[a]=arguments[a+3];t.children=s}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:_l,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pl={style:{verticalAlign:"middle"}},Ol=()=>xe.createElement(xe.Fragment,null,xl||(xl=Al(Oe,{})),Il||(Il=Al(_e.Pd.Provider,{value:Pl},void 0,Al(Qe,{}),Al(Ft,{}),Al(ft,{}),Al(st,{}),Al($e,{}),Al(di,{}),Al(ri,{}),Al(Tl,{}))));(0,i.p5)(Ee,{},(()=>{function e(){Ee.dispatch((0,r.Qr)())}window.addEventListener("message",Ee.dispatch),Ee.dispatch({type:"HYDRATED"}),ve(Ee,!1),l.Z.initialize(Ee,F,pe),window.addEventListener("hashchange",(()=>{Ee.dispatch((0,r.fL)())})),document.addEventListener("touchstart",(function(){Ee.dispatch((0,r.bv)(!0))}),{once:!0}),window.addEventListener("resize",e),e(),Ee.dispatch((0,r.vb)()),Ee.dispatch((0,s.aM)()),F.initialize(Ee,l.Z,pe)})),function(){const e=()=>{window.name="main",function(e,t){(0,Ne.s)(e).render(Al(Ie.zt,{store:t},void 0,Nl||(Nl=Al(Ol,{}))))}(document.getElementById("app"),Ee);const t=function(e){return t=>{if("INPUT"===t.target.nodeName||"TEXTAREA"===t.target.nodeName)return;let{key:n}=t;const i=Number(n);if(!Number.isNaN(i)&&i>0){const{canvases:t,canvasId:n}=e.getState().canvas,o=Object.keys(t).filter((e=>!t[e].hid));if(i<=o.length){const a=o[i-1];if(a!==n){e.dispatch((0,r.SC)(a));const n=t[a].title;e.dispatch((0,s.h4)(`Gewechselt zu ${n}`))}}}else{if(!a.includes(n)){if(n=t.code,!n.startsWith("Key"))return;n=n.slice(-1).toLowerCase()}switch(n){case"g":return e.dispatch((0,r.xK)()),void e.dispatch((0,s.h4)(e.getState().gui.showGrid?"Raster Ein":"Raster Aus"));case"h":return void(window.ssv&&window.ssv.backupurl&&e.dispatch((0,r.FI)()));case"x":return e.dispatch((0,r.Xb)()),void e.dispatch((0,s.h4)(e.getState().gui.showPixelNotify?"Pixelaktivität Ein":"Pixelaktivität Aus"));case"m":return e.dispatch((0,r.$t)()),void e.dispatch((0,s.h4)(e.getState().gui.mute?"Ton stummgeschaltet":"Ton eingeschaltet"));case"r":{const{hover:t}=e.getState().canvas,n=t.join("_");return(0,o.Z)(n),void e.dispatch((0,s.h4)("Kopiert!"))}case"p":e.dispatch((0,r.Bn)()),e.dispatch((0,s.h4)(e.getState().canvas.showHiddenCanvases?"Zeige versteckte Leinwände":"Verstecke geheime Leinwände"))}}}}(Ee);document.addEventListener("keydown",t,!1),setInterval((()=>{pe().gc()}),b.PR),document.removeEventListener("DOMContentLoaded",e)};document.addEventListener("DOMContentLoaded",e,!1)}()},2354:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(7294);const o=function(e,t){const n=(0,i.useRef)();(0,i.useEffect)((()=>{n.current=e}),[e]),(0,i.useEffect)((()=>{function e(){n.current()}if(null!==t){e();const n=setInterval(e,t);return()=>clearInterval(n)}}),[t])}},6539:(e,t,n)=>{n.d(t,{A$:()=>o,Fv:()=>i,I_:()=>c,Kb:()=>h,PR:()=>p,Tj:()=>a,U4:()=>f,V4:()=>r,WF:()=>v,fS:()=>l,n$:()=>s,p7:()=>u,vc:()=>d});const i=40,o=3,r="0",s={0:{ident:"d",colors:[[202,227,255],[255,255,255],[255,255,255],[228,228,228],[196,196,196],[136,136,136],[78,78,78],[0,0,0],[244,179,174],[255,167,209],[255,84,178],[255,101,101],[229,0,0],[154,0,0],[254,164,96],[229,149,0],[160,106,66],[96,64,40],[245,223,176],[255,248,137],[229,217,0],[148,224,68],[2,190,1],[104,131,56],[0,101,19],[202,227,255],[0,211,221],[0,131,199],[0,0,234],[25,25,115],[207,110,228],[130,0,128]],cli:2,size:65536,bcd:4e3,pcd:7e3,cds:6e4,ranked:!0,req:-1,sd:"2020-01-08"}},a=128,l=32,c=256,u=2,d=2592e6,h=100,f=2e3,v=3e5,p=3e5},9665:(e,t,n)=>{n.d(t,{Cr:()=>g,D$:()=>S,D0:()=>p,HD:()=>c,IU:()=>x,NK:()=>h,Ss:()=>d,TP:()=>C,UW:()=>s,VL:()=>w,W4:()=>u,Z:()=>k,_N:()=>N,_O:()=>v,b3:()=>T,bG:()=>A,gx:()=>y,lg:()=>E,nK:()=>m,r6:()=>I,s3:()=>f,sG:()=>l,tF:()=>_,uZ:()=>r,x2:()=>a});var i=n(6539);function o(e,t){return(e%t+t)%t}function r(e,t,n){return Math.max(t,Math.min(e,n))}function s(e){return e.substring(0,4)+e.substring(5,7)+e.substring(8)}function a(){const e=new Date;let t=e.getDate(),n=e.getMonth()+1;return n<10&&(n=`0${n}`),t<10&&(t=`0${t}`),`${e.getFullYear()}-${n}-${t}`}function l(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=null===o?i.I_:i.fS,s=null==o?n:o,a=Math.floor((t+e/2)/r),l=Math.floor((s+e/2)/r);return[a,l]}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.map((t=>Math.floor((t+n/2)/i.I_*e)))}function u(e){return e?Math.log2(e/i.I_)/i.p7*2:0}function d(e,t,n){if(e&&n){let t=n.length;for(;t>0;){t-=1;const[i,o]=n[t];if(e<=i)return o}}return t}function h(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const s=null===r?i.I_:i.fS,a=null==r?n:r;let l=null===r?0:n*s*s;const c=o(e/2,s),u=o(t+c,s),d=o(a+c,s);return l+=d*s+u,l}function f(e,t){const n=Object.keys(e);for(let i=0;i<n.length;i+=1){const o=n[i];if(e[o].ident===t)return o}return null}function v(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=r?i.fS:i.I_,a=n%s,l=n-a;let c=l%(s*s);const u=r?(l-c)/s/s:null;c/=s;const d=o/2/s,h=(e-d)*s+a,f=(t-d)*s+c;return[h,f,u]}function p(e,t){return t.map((t=>o(t+e/2,i.I_)))}function m(e,t,n){let[i,o]=n;const{view:r,viewscale:s}=e.canvas,[a,l]=r,{width:c,height:u}=t;return[Math.floor((i-c/2)/s+a),Math.floor((o-u/2)/s+l)]}function g(e,t,n){let[i,o]=n;const{view:r,viewscale:s}=e.canvas,[a,l]=r,{width:c,height:u}=t;return[(i-a)*s+c/2,(o-l)*s+u/2]}function w(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Math.ceil(e/1e3);let i;return i=n<60&&t?n:`${Math.floor(n/60)}:${("0"+n%60).slice(-2)}`,i}function y(e){const t=e%60;let n=(e-t)/60;const i=n%60;n=(n-i)/60;const o=n%24;n=(n-o)/24;let r="";return n&&(r+=` ${n}d`),o&&(r+=` ${o}h`),i&&(r+=` ${i}min`),t&&(r+=` ${t}s`),r}const b=["k","M","B"];function S(e){if(!e)return"N/A";if(e<1e3)return e;let t=0;for(;t<b.length;){if(e<1e4)return`${Math.floor(e/1e3)}.${`0${Math.floor(e%1e3/10)}`.slice(-2)}${b[t]}`;if(e<1e5)return`${Math.floor(e/1e3)}.${Math.floor(e%1e3/100)}${b[t]}`;if(e<1e6)return Math.floor(e/1e3)+b[t];t+=1,e=Math.round(e/1e3)}return""}function k(e){if(!e)return"#000000";let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return`#${`00000${(16777215&t).toString(16).toUpperCase()}`.slice(-6)}`}function C(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];3===(e=e.replace(/^\s*#|\s*$/g,"")).length&&(e=e.replace(/(.)/g,"$1$1"));let n=Math.floor(parseInt(e.substring(0,2),16)/2),i=Math.floor(parseInt(e.substring(2,4),16)/2),o=Math.floor(parseInt(e.substring(4,6),16)/2);return t&&(n+=128,i+=128,o+=128),n=`0${n.toString(16)}`.slice(-2),i=`0${i.toString(16)}`.slice(-2),o=`0${o.toString(16)}`.slice(-2),`#${n}${i}${o}`}function E(e){const t=["\\","[","]","(",")","*","~","+","_","\n"];let n="",i=0;for(let o=0;o<e.length;o+=1){const r=e[o];t.includes(r)&&(n+=`${e.slice(i,o)}\\`,i=o)}return 0===i?e:(n+=e.slice(i),n)}function T(){try{const e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch{return!1}}function x(e){let t=e.indexOf("://")+3;t<3&&(t=0),e.startsWith("www.",t)&&(t+=4);let n=e.indexOf("/",t);return-1===n&&(n=e.length),e.endsWith(".com",n)&&(n-=4),n<=t?e:e.slice(t,n)}function I(e){let t=e.indexOf("&");-1===t&&(t=e.length);let n=t-1;for(;n>=0&&"."!==e[n];n-=1)if("/"===e[n])return null;return n+=1,t-n>4?null:e.slice(n,t)}function N(e){let t=e.indexOf("?");return-1===t&&(t=e.indexOf("#")),-1===t?e:e.substring(0,t)}function _(e){const t=new Date,n=new Date(1e3*e);return n.getDate()!==t.getDate()?n.toLocaleString():n.toLocaleTimeString()}function A(e){if(!e)return 0;const t=e.slice(-1).toLowerCase(),n=parseInt(e.slice(0,-1),10);if(Number.isNaN(n)||n<=0||n>600||!["s","m","h","d"].includes(t))return 0;let i=1e3;return"m"===t?i*=60:"h"===t?i*=3600:"d"===t&&(i*=86400),n*i}},980:(e,t,n)=>{n.d(t,{A:()=>N,AP:()=>v,E1:()=>f,Es:()=>I,Fx:()=>r,I6:()=>h,JL:()=>_,K$:()=>x,No:()=>p,Oh:()=>g,PS:()=>u,Pw:()=>k,Wt:()=>b,e9:()=>y,fF:()=>S,ft:()=>w,hH:()=>E,jK:()=>A,ko:()=>d,s$:()=>T,uY:()=>o,uw:()=>m,yx:()=>C});var i=n(9665);const o=function(){if(!window.ssv||!window.ssv.shard||"fuckyouarkeros.fun"===window.location.host)return"";const e=window.location.host.split(".");return e.length>2&&e.shift(),`${window.ssv.shard}.${e.join(".")}`}(),r=o&&`${window.location.protocol}//${o}`;async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{timeout:n=3e4}=t,i=new AbortController,o=setTimeout((()=>i.abort()),n),r=await fetch(e,{...t,signal:i.signal});return clearTimeout(o),r}async function a(e){const{status:t}=e;if(429===t){let t="Zu viele Anfragen gesendet";const n=e.headers.get("Retry-After");return Number.isNaN(Number(n))||(t+=`, versuche es nach ${Math.floor(n/60)}min nochmal`),{errors:[t]}}try{return await e.json()}catch(e){return{errors:[`Verbindungsfehler ${t} :(`]}}}async function l(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&(e=`${r}${e}`);try{return a(await s(e,{method:"POST",credentials:n?"include":"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}))}catch(e){return{errors:["Kann nich zum Server verbinden, bitte versuche es später noch einmal :("]}}}async function c(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&(e=`${r}${e}`);try{return a(await s(e,{credentials:t?"include":"omit"}))}catch(e){return{errors:["Kann nich zum Server verbinden, bitte versuche es später noch einmal :("]}}}async function u(e,t){const n=await l("/api/block",{userId:e,block:t});return n.errors?n.errors[0]:"ok"===n.status?null:"Unbekannter Fehler"}async function d(e){const t=await l("/api/privatize",{priv:e});return t.errors?t.errors[0]:"ok"===t.status?null:"Unbekannter Fehler"}async function h(e){const t=await l("/api/startdm",e);return t.errors?t.errors[0]:t.channel?t.channel:"Unbekannter Fehler"}async function f(e){const t=await l("/api/blockdm",{block:e});return t.errors?t.errors[0]:"ok"===t.status?null:"Unbekannter Fehler"}async function v(e){const t=await l("/api/leavechan",{channelId:e});return t.errors?t.errors[0]:"ok"===t.status?null:"Unbekannter Fehler"}async function p(e,t){try{const n=`/history?day=${(0,i.UW)(e)}&id=${t}`,o=await s(n,{credentials:"omit",timeout:45e3});if(200!==o.status)return[];return["00:00",...(await o.json()).map((e=>`${e.substring(0,2)}:${e.substring(2)}`))]}catch{return[]}}async function m(e){const t=await fetch(`${r}/api/chathistory?cid=${e}&limit=50`,{credentials:"include"});if(t.ok){const{history:e}=await t.json();return e}return null}function g(e,t){return l("/api/auth/change_passwd",{password:t,newPassword:e})}async function w(){return c("/api/auth/resend_verify")}async function y(){return!c("/api/auth/logout").errors}function b(e){return l("/api/auth/change_name",{name:e})}function S(e,t){return l("/api/auth/change_mail",{email:e,password:t})}function k(e,t){return l("/api/auth/local",{nameoremail:e,password:t})}function C(e,t,n,i,o){return l("/api/auth/register",{name:e,email:t,password:n,captcha:i,captchaid:o})}function E(e){return l("/api/auth/restore_password",{email:e})}function T(e){return l("/api/auth/delete_account",{password:e})}function x(){return c("/ranking",!1)}function I(){return c("/api/baninfo")}function N(){return c("/api/me")}function _(){return c("/api/getiid")}function A(e){return l("/api/banme",{code:e})}},3861:(e,t,n)=>{function i(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"OK";return{type:"ALERT",title:e,message:t,alertType:n,btn:i}}function o(){return{type:"CLOSE_ALERT"}}function r(){return{type:"s/TGL_HISTORICAL_VIEW"}}function s(){return{type:"s/TGL_HIDDEN_CANVASES"}}function a(){return{type:"s/TGL_GRID"}}function l(){return{type:"s/TGL_PXL_NOTIFY"}}function c(){return{type:"s/TGL_AUTO_ZOOM_IN"}}function u(){return{type:"s/TGL_ONLINE_CANVAS"}}function d(){return{type:"s/TGL_MUTE"}}function h(){return{type:"s/TGL_COMPACT_PALETTE"}}function f(){return{type:"s/TGL_CHAT_NOTIFY"}}function v(){return{type:"s/TGL_POTATO_MODE"}}function p(){return{type:"s/TGL_LIGHT_GRID"}}function m(){return{type:"s/TGL_OPEN_PALETTE"}}function g(e){return{type:"s/SELECT_STYLE",style:e}}function w(){return{type:"s/TGL_OPEN_MENU"}}function y(e){return{type:"SET_HOVER",hover:e}}function b(){return{type:"UNSET_HOVER"}}function S(e){return{type:"SET_MOBILE",mobile:e}}function k(){return{type:"WIN_RESIZE"}}function C(e){return{type:"SELECT_COLOR",color:e}}function E(e){return{type:"s/SELECT_CANVAS",canvasId:String(e)}}function T(e){return{type:"SET_VIEW_COORDINATES",view:e}}function x(e){let[t,n]=e;return(e,i)=>{const{viewscale:o}=i().canvas,r=100/o;e(function(e){let[t,n]=e;return(e,i)=>{const{view:o}=i().canvas,[r,s]=o;e(T([r+t,s+n]))}}([r*t,r*n]))}}function I(){return x([0,-1])}function N(){return x([-1,0])}function _(){return x([0,1])}function A(){return x([1,0])}function P(e,t){return{type:"SET_SCALE",scale:e,zoompoint:t}}function O(e){return(t,n)=>{const{scale:i}=n().canvas;t(P(i>=1?1.1*i:1.04*i,e))}}function L(e){return(t,n)=>{const{scale:i}=n().canvas;t(P(i>=1?i/1.1:i/1.04,e))}}function R(e){return{type:"REQ_BIG_CHUNK",center:e}}function D(e){return{type:"REMOVE_CHUNKS",chunks:e}}function $(e){return{type:"REC_BIG_CHUNK",chunk:e}}function M(e,t){return{type:"REC_BIG_CHUNK_FAILURE",chunk:e,error:t}}function z(e){return{type:"s/REC_ME",...e}}function H(e){const{ranking:t,dailyRanking:n,dailyCRanking:i,prevTop:o,onlineStats:r,cHistStats:s,histStats:a,pDailyStats:l,pHourlyStats:c}=e;return{type:"REC_STATS",totalRanking:t,totalDailyRanking:n,dailyCRanking:i,prevTop:o,onlineStats:r,cHistStats:s,histStats:a,pDailyStats:l,pHourlyStats:c}}function W(e,t){return{type:"s/REQ_CHAT_MESSAGE",text:e,channel:t}}function U(){return{type:"s/LOGOUT"}}function G(e){return{type:"s/LOGIN",...e}}function F(e){return{type:"s/SET_NAME",name:e}}function V(e){return{type:"s/SET_MAILREG",mailreg:e}}function Z(e){return{type:"MARK_CHANNEL_AS_READ",cid:e}}function K(){return(e,t)=>{setInterval((function(){const n=function(e){const t=[],n=Date.now(),{wait:i}=e.user,o=i-n;return null!=i&&(o>0?t.push(function(e){return{type:"COOLDOWN_SET",coolDown:e}}(o)):t.push({type:"COOLDOWN_END"})),t}(t());e(n)}),333)}}function B(e,t){return{type:"s/BLOCK_USER",userId:e,userName:t}}function j(e,t){return{type:"s/UNBLOCK_USER",userId:e,userName:t}}function q(e){return{type:"s/SET_BLOCKING_DM",blockDm:e}}function Y(e){return{type:"s/SET_PRIVATE",priv:e}}function X(e){return{type:"s/MUTE_CHAT_CHANNEL",cid:e}}function Q(e){return{type:"s/UNMUTE_CHAT_CHANNEL",cid:e}}function J(){return{type:"ON_VIEW_FINISH_CHANGE"}}function ee(e,t){return{type:"SET_HISTORICAL_TIME",date:e,time:t}}function te(){return{type:"RELOAD_URL"}}function ne(){return{type:"t/UNLOAD"}}function ie(e){const{id:t,name:n,mailreg:i,blockDm:o,userlvl:r}=e.user,{canvases:s}=e.canvas,{blocked:a,channels:l}=e.chat,{ranking:c,dailyRanking:u,totalPixels:d,dailyTotalPixels:h}=e.ranks;return{type:"s/REC_ME",blockDm:o,blocked:a,canvases:s,channels:l,dailyRanking:u,dailyTotalPixels:h,id:t,mailreg:i,name:n,ranking:c,totalPixels:d,userlvl:r}}n.d(t,{$t:()=>d,Ai:()=>q,BH:()=>b,Bn:()=>s,Cd:()=>h,Eo:()=>Z,FI:()=>r,GY:()=>ie,GZ:()=>y,Hw:()=>z,IN:()=>Y,KB:()=>m,L4:()=>A,M6:()=>o,MM:()=>g,Oh:()=>C,Qr:()=>k,RL:()=>v,Rz:()=>ne,SC:()=>E,TG:()=>R,TX:()=>U,Tl:()=>H,UI:()=>i,Xb:()=>l,Y2:()=>V,ZP:()=>P,_:()=>u,_P:()=>$,a6:()=>J,bE:()=>W,bv:()=>S,c7:()=>f,dv:()=>_,fL:()=>te,ge:()=>D,hg:()=>I,kr:()=>O,nb:()=>X,o7:()=>c,on:()=>ee,pH:()=>G,qC:()=>F,rf:()=>B,sW:()=>M,ts:()=>p,vG:()=>L,vN:()=>w,vb:()=>K,w5:()=>T,wC:()=>Q,wh:()=>N,xK:()=>a,zv:()=>j})},8953:(e,t,n)=>{function i(){return{type:"w/CLOSE"}}function o(){return{type:"w/OPEN"}}function r(e,t,n,i,o){return(r,s)=>{i=Number(i);const a=s();let l;l=a.windows?a.windows.windows.some((e=>"CHAT"===e.windowType&&!e.hidden))&&Object.values(a.windows.args).some((e=>e.chatChannel===i)):"CHAT"===a.popup.windowType||a.popup.args.chatChannel===i,r({type:"s/REC_CHAT_MESSAGE",name:e,text:t,country:n,channel:i,user:o,isPing:!1,isRead:l})}}function s(e){return{type:"REC_COOLDOWN",wait:e}}function a(e){return{type:"REC_ONLINE",online:e}}function l(e){return{type:"s/ADD_CHAT_CHANNEL",channel:e}}function c(e){return{type:"s/REMOVE_CHAT_CHANNEL",cid:e}}function u(e){return{type:"SET_PXLS_FETCHING",fetching:e}}function d(e){return e.type="REC_SET_PXLS",e}n.d(t,{$s:()=>o,At:()=>s,W1:()=>d,WV:()=>i,Wm:()=>a,cC:()=>u,dm:()=>l,jg:()=>c,pl:()=>r})},4321:(e,t,n)=>{n.d(t,{K6:()=>p,Ox:()=>h,R0:()=>f,TL:()=>d,YB:()=>l,aM:()=>u,eg:()=>v,h4:()=>g,mP:()=>c});var i=n(980),o=n(3861),r=n(8953);function s(e){return{type:"SET_API_FETCHING",fetching:e}}function a(e){return{type:"s/SET_CHAT_FETCHING",fetching:e}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return async n=>{n(s(!0));const a=await(0,i.I6)(e);if("string"==typeof a)n((0,o.UI)("Direct Message Error",a,"error","OK"));else{const e=Number(Object.keys(a)[0]);n((0,r.dm)(a)),t&&t(e)}n(s(!1))}}function c(){return async e=>{const t=await(0,i.K$)();t.errors||e((0,o.Tl)(t))}}function u(){return async e=>{const t=await(0,i.A)();t.errors||e((0,o.Hw)(t))}}function d(e){return async t=>{t(a(!0));const n=await(0,i.uw)(e);n?(setTimeout((()=>{t(a(!1))}),500),t(function(e,t){return{type:"s/REC_CHAT_HISTORY",cid:e,history:t}}(e,n))):setTimeout((()=>{t(a(!1))}),5e3)}}function h(e,t,n){return async r=>{r(s(!0));const a=await(0,i.PS)(e,n);r(a?(0,o.UI)("User Block Error",a,"error","OK"):n?(0,o.rf)(e,t):(0,o.zv)(e,t)),r(s(!1))}}function f(e){return async t=>{t(s(!0));const n=await(0,i.E1)(e);t(n?(0,o.UI)("Blocking DMs Error",n,"error","OK"):(0,o.Ai)(e)),t(s(!1))}}function v(e){return async t=>{t(s(!0));const n=await(0,i.ko)(e);t(n?(0,o.UI)("Setting User Private Error",n,"error","OK"):(0,o.IN)(e)),t(s(!1))}}function p(e){return async t=>{t(s(!0));const n=await(0,i.AP)(e);t(n?(0,o.UI)("Leaving Channel Error",n,"error","OK"):(0,r.jg)(e)),t(s(!1))}}let m=null;function g(e){return t=>{t(function(e){return{type:"SET_NOTIFICATION",notification:e}}(e)),m&&(clearTimeout(m),m=null),m=setTimeout((()=>{t({type:"UNSET_NOTIFICATION"})}),1500)}}},8634:(e,t,n)=>{n.d(t,{s:()=>i});const i=e=>-1!==e.gui.style.indexOf("dark")},9483:(e,t,n)=>{function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:()=>o});const o=class{constructor(e,t,n){i(this,"recUpdates",!1),i(this,"timestamp",void 0),i(this,"z",void 0),i(this,"i",void 0),i(this,"j",void 0),this.timestamp=Date.now(),this.z=e,this.i=t,this.j=n}get id(){return this.i<<8|this.j}touch(){this.timestamp=Date.now()}destructor(){}}},3968:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(3861),o=n(6539);function r(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function s(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,l(e,t,"get"))}function a(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,l(e,t,"set"),n),n}function l(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var c=new WeakMap,u=new WeakMap,d=new WeakMap;const h=class{constructor(e,t){r(this,c,{writable:!0,value:void 0}),r(this,u,{writable:!0,value:void 0}),r(this,d,{writable:!0,value:void 0}),a(this,c,e),a(this,u,new Map),a(this,d,t)}get canvasId(){return s(this,d)}get recChunkIds(){const e=[];return s(this,u).forEach((t=>{t.recUpdates&&e.push(t.id)})),e}destructor(){s(this,u).forEach((e=>{e.destructor()})),a(this,u,new Map)}cget(e){return s(this,u).get(e)}cset(e,t){s(this,u).set(e,t)}bcReqChunk(e){const{z:t,i:n,j:o}=e;s(this,c).dispatch((0,i.TG)([t,n,o]))}bcRecChunk(e){s(this,c).dispatch((0,i._P)(e));const{size:t}=s(this,u);if(t>o.U4){const e=t-Math.floor(.9*o.U4),n=Array.from(s(this,u).entries()).sort(((e,t)=>e[1].timestamp-t[1].timestamp)).slice(0,e);n.forEach((e=>{let[t]=e;s(this,u).delete(t)}));const i=n.map((e=>e[1]));this.bcRemoveChunks(i),console.log(`Cleared ${i.length} to cut amount of chunks to ${s(this,u).size}`)}}bcReqChunkFail(e,t){s(this,c).dispatch((0,i.sW)(e,t.message))}bcRemoveChunks(e){s(this,c).dispatch((0,i.ge)(e))}gc(e){const t=Date.now()-o.WF,n=s(this,u),i=[];n.forEach(((o,r)=>{if(t>o.timestamp){const{z:t,i:s,j:a}=o;e.isChunkInView(t,s,a)||(i.push(o),n.delete(r),o.destructor())}})),i.length&&this.bcRemoveChunks(i),console.log(`GC cleaned ${i.length} / ${n.size+i.length} chunks`)}}},8821:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(3861),o=n(8953),r=n(4321);const s=new class{constructor(){this.requestFromQueue=this.requestFromQueue.bind(this),this.pixelQueue=[],this.clientPredictions=[],this.extension=null,window.registerPixelUpdates=e=>{this.extension=e}}initialize(e,t,n){this.store=e,this.socketClient=t,this.getRenderer=n}async requestFromQueue(){const{store:e}=this;if(!this.pixelQueue.length)return void e.dispatch((0,o.cC)(!1));e.dispatch((0,o.cC)(!0));const{i:t,j:n,pixels:s}=this.pixelQueue.shift();let a;try{a=await this.socketClient.sendPixelUpdate(t,n,s)}catch{a={retCode:16,coolDownSeconds:0,pxlCnt:0},e.dispatch((0,i.UI)("Fehler :(","Keine Antwort von pixelplanet erhalten. Vielleicht versuche die Seite neu zu laden?","error"))}const{retCode:l,coolDownSeconds:c,pxlCnt:u}=a;if(c&&e.dispatch((0,r.h4)(c)),u<s.length){const[e]=s[u];this.revertPredictionsAt(t,n,e),this.pixelQueue=[]}let d=null,h=null,f="error";switch(l){case 0:case 9:break;case 1:d="Ungültige Leinwand",h="Diese Leinwand existiert nicht";break;case 2:d="Ungültige Koordinaten",h="x außerhalb  des Spielfelds";break;case 3:d="Ungültige Koordinaten",h="y außerhalb  des Spielfelds";break;case 4:d="Ungültige Koordinaten",h="z außerhalb  des Spielfelds";break;case 5:d="Falsche Farbe",h="Ungültige Farbe ausgewählt";break;case 6:d="Nur ür registrierte Spieler",h="Melde dich an um auf dieser Leinwand zu spielen";break;case 7:d="Spiel mehr :)",h="Mehr Pixel sind benötigt um auf dieser Leinwand zu spielen";break;case 8:e.dispatch((0,r.h4)("Pixel beschützt!"));break;case 10:d="Captcha",h="Bitte beweiße dass du ein Mench bist",f="captcha";break;case 11:d="Kein Proxy erlaubt :(",h="Du benutzt ein Proxy.";break;case 12:d="Nicht erlaubt",h="Nur die Top10 Spieler von gestern dürfen hier spielen";break;case 13:d="Du bist seltsam",h="Server wurde von deinen Pixeln verwirrt. Spielst du auf mehreren Geräten?";break;case 14:d="Gebannt",f="ban";break;case 15:d="IP Bereich Gebannt",h="Dein Internet Anbieter ist von diesem Spiel verbannt";break;case 16:d="Timeout",h="Didn't get an answer from pixelplanet. Maybe try to refresh if problem persists?";break;default:d="Komisch",h="Konnte ein Pixel setzen"}(h||d)&&e.dispatch((0,i.UI)(d||`Fehler ${l}`,h,f)),e.dispatch((0,o.W1)(a)),setTimeout(this.requestFromQueue,100)}revertPredictionsAt(e,t,n){const i=this.getRenderer(),{clientPredictions:o}=this;let r=0;for(;r<o.length;){const i=o[r];if(i[0]===e&&i[1]===t&&i[2]===n)break;r+=1}const s=r;for(;r<o.length;){const[e,t,n,s]=o[r];i.renderPixel(e,t,n,s,!1),r+=1}this.clientPredictions.splice(s)}receivePixelUpdate(e){let{i:t,j:n,pixels:i}=e;this.extension&&this.extension(t,n,i),i.forEach((e=>{const[i,o]=e,{clientPredictions:r}=this;for(let e=0;e<r.length;e+=1){const s=r[e];if(s[0]===t&&s[1]===n&&s[2]===i)return void(s[4]===o?r.splice(e,1):s[3]=o)}this.getRenderer().renderPixel(t,n,i,o,!0)}))}tryPlacePixel(e,t,n,i,o){this.getRenderer().renderPixel(e,t,n,i,!1),this.clientPredictions.push([e,t,n,o,i]);const{pixelQueue:r}=this;if(r.length){const o=r[r.length-1],{i:s,j:a}=o;if(e===s&&t===a)return void o.pixels.push([n,i])}r.push({i:e,j:t,pixels:[[n,i]]}),this.store.getState().fetching.fetchingPixel||this.requestFromQueue()}}},1430:(e,t,n)=>{function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:()=>o});const o=class{constructor(e){i(this,"store",void 0),i(this,"is3D",null),i(this,"chunkLoader",null),this.store=e}get chunks(){return this.chunkLoader.chunks}get recChunkIds(){return this.chunkLoader?this.chunkLoader.recChunkIds:[]}destructor(){this.chunkLoader&&this.chunkLoader.destructor()}render(){}renderPixel(){}updateCanvasData(){}isChunkInView(){return!0}gc(){this.chunkLoader&&this.chunkLoader.gc(this)}}},1740:(e,t,n)=>{async function i(e){e.toBlob((e=>{try{if(!navigator.clipboard)throw new Error("Clipboard API not implemented");navigator.clipboard.write([new ClipboardItem({"image/png":e})])}catch(e){console.log("Couldn't copy canvas to clipboard",e)}}),"image/png")}n.d(t,{Z:()=>o,w:()=>i});const o=async function(e){if(!navigator.clipboard)return function(e){const t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{const e=document.execCommand("copy");return document.body.removeChild(t),e}catch{return document.body.removeChild(t),!1}}(e);try{return await navigator.clipboard.writeText(e),!0}catch{return!1}}}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return i[e](n,n.exports,r),n.exports}r.m=i,e=[],r.O=(t,n,i,o)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,i,o]=e[u],a=!0,l=0;l<n.length;l++)(!1&o||s>=o)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(a=!1,o<s&&(s=o));if(a){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,i,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>841===e?"three.34552532.js":{189:"modtools",545:"converter",784:"stats",882:"voxel"}[e]+"-de."+{189:"d9f50608",545:"5c5c5274",784:"27f7f093",882:"19c536c8"}[e]+".js",r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="PixelPlanet:",r.l=(e,i,o,s)=>{if(t[e])t[e].push(i);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==n+o){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",n+o),a.src=e),t[e]=[i];var h=(n,i)=>{a.onerror=a.onload=null,clearTimeout(f);var o=t[e];if(delete t[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(i))),n)return n(i)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=880,r.p="/assets/",(()=>{var e={880:0};r.f.j=(t,n)=>{var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise(((n,o)=>i=e[t]=[n,o]));n.push(i[2]=o);var s=r.p+r.u(t),a=new Error;r.l(s,(n=>{if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}}),"chunk-"+t,t)}},r.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[s,a,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);if(l)var u=l(r)}for(t&&t(n);c<s.length;c++)o=s[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(u)},n=self.webpackChunkPixelPlanet=self.webpackChunkPixelPlanet||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=r.O(void 0,[736],(()=>r(981)));s=r.O(s)})();